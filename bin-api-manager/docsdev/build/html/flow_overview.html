<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Overview &mdash; voipbin  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="voipbin  documentation" href="#" />
    </head>
<body>
    <script type="text/javascript" src="_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="intro.html"
                        title="voipbin"
                        class="logo navbar-brand"
                    >
                        <img src="_static/images/voipbin-high-resolution-logo-white-transparent.png" width="45" height="80" alt="voipbin"
                            class="logo-img"
                        />
                        VoIPBin Documentation
                    </a>
                
                
                    <div class="collapse navbar-collapse justify-content-end">
                        <ul class="navbar-nav">
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="http://voipbin.net">Project</a></li>
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="https://admin.voipbin.net">Admin</a></li>
                            
                        </ul>
                    </div>
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="accesskey.html">Accesskey</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk.html">SDK(Software Development Kit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="restful_api.html">RESTful API(Application Programming Interface)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="flow.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow.html#activeflow">Activeflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l1"><a class="reference internal" href="webhook.html">Webhook</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Voice &amp; Real-Time</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="call.html">Call</a></li>
<li class="toctree-l1"><a class="reference internal" href="conference.html">Conference</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue.html">Queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="recording.html">Recording</a></li>
<li class="toctree-l1"><a class="reference internal" href="transcribe.html">Transcribe</a></li>
<li class="toctree-l1"><a class="reference internal" href="mediastream.html">Mediastream</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Messaging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="message.html">Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="talk.html">Talk</a></li>
<li class="toctree-l1"><a class="reference internal" href="conversation.html">Conversation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI &amp; Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ai.html">AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="campaign.html">Campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdial.html">Outdial</a></li>
<li class="toctree-l1"><a class="reference internal" href="outplan.html">Outplan</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources &amp; Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="customer.html">Customer</a></li>
<li class="toctree-l1"><a class="reference internal" href="billing_account.html">Billing Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="tag.html">Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="provider.html">Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="route.html">Route</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension.html">Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="trunk.html">Trunk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture (Deep Dive)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="websocket.html">Websocket</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Overview</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="_sources/flow_overview.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="overview">
<span id="flow-overview"></span><h1>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h1>
<p>The Flow in VoIPBIN is a powerful set of instructions that guides the platform on how to handle incoming calls. When someone calls one of your VoIPBIN numbers or destinations, the platform looks up the associated URL and sends a request. The Flow instructions are then read to determine the appropriate actions to be taken, such as recording the call, playing a message, or prompting the caller to press digits on their keypad.</p>
<p>At its core, the Flow is an array of JSON objects with special tags defined by VoIPBIN, enabling users to build their own Programmable Voice applications.</p>
<section id="how-the-flow-works">
<span id="flow-overview-how-the-flow-works"></span><h2>How the flow works<a class="headerlink" href="#how-the-flow-works" title="Link to this heading"></a></h2>
<p>When an incoming call is received on one of your VoIPBIN numbers or destinations, the platform identifies the associated URL and sends a request.</p>
<p>The Flow instructions are then processed, providing a step-by-step guide on how to handle the call. This might involve greeting the caller, presenting options, gathering input, or executing various actions based on the caller’s response.</p>
</section>
<section id="understanding-flow-execution">
<h2>Understanding Flow Execution<a class="headerlink" href="#understanding-flow-execution" title="Link to this heading"></a></h2>
<p>Think of a Flow like a recipe. Each action is a step, and VoIPBIN follows the steps one by one until the recipe is complete.</p>
<p><strong>The Execution Cursor</strong></p>
<p>VoIPBIN uses a “cursor” to track where it is in the flow - like a finger pointing at the current step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span> <span class="n">Actions</span> <span class="n">Array</span><span class="p">:</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
<span class="o">|</span> <span class="n">answer</span>  <span class="o">|--&gt;|</span>  <span class="n">talk</span>   <span class="o">|--&gt;|</span> <span class="n">digits</span>  <span class="o">|--&gt;|</span> <span class="n">branch</span>  <span class="o">|--&gt;|</span> <span class="n">hangup</span>  <span class="o">|</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
                   <span class="o">^</span>
                   <span class="o">|</span>
                <span class="n">cursor</span>
              <span class="p">(</span><span class="n">current</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
<p>As each action completes, the cursor moves to the next one. When the cursor reaches the end, the flow is complete.</p>
<p><strong>What Happens During Execution</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+---------------------------------------------------------------------+
|                    Flow Execution Engine                            |
+---------------------------------------------------------------------+
                                |
                                v
                       +---------------+
                       |  Get next     |
                       |  action       |
                       +-------+-------+
                               |
                               v
                       +---------------+
                  +----|  End of flow? |----+
                  |yes +---------------+ no |
                  |                         |
                  v                         v
           +------------+          +----------------+
           |   Stop     |          | Execute action |
           |  (done)    |          +-------+--------+
           +------------+                  |
                                           v
                                +---------------------+
                                | What kind of result?|
                                +----------+----------+
                                           |
                    +----------------------+----------------------+
                    |                      |                      |
                    v                      v                      v
             +------------+         +------------+         +------------+
             |   Next     |         |   Wait     |         |   Block    |
             | (continue) |         | (external) |         |  (pause)   |
             +-----+------+         +------------+         +------------+
                   |
                   | loop back
                   +----------------------------------------------&gt;
</pre></div>
</div>
</section>
<section id="action-execution-patterns">
<h2>Action Execution Patterns<a class="headerlink" href="#action-execution-patterns" title="Link to this heading"></a></h2>
<p>Actions behave differently depending on their type. Understanding these patterns helps you predict flow behavior.</p>
<p><strong>Immediate Actions (Execute and Continue)</strong></p>
<p>These actions complete instantly and the cursor moves to the next action:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+----------+</span>     <span class="o">+----------+</span>
<span class="o">|</span>  <span class="n">goto</span>    <span class="o">|----&gt;|</span>  <span class="n">branch</span>  <span class="o">|----&gt;|</span> <span class="n">variable</span> <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">+----------+</span>     <span class="o">+----------+</span>
     <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
     <span class="o">+----------------+----------------+</span>
                      <span class="o">|</span>
               <span class="n">Cursor</span> <span class="n">moves</span> <span class="n">immediately</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">goto</span></code>, <code class="docutils literal notranslate"><span class="pre">branch</span></code>, <code class="docutils literal notranslate"><span class="pre">variable_set</span></code>, <code class="docutils literal notranslate"><span class="pre">condition_variable</span></code></p>
<p><strong>Media Actions (Wait for Completion)</strong></p>
<p>These actions take time and the flow waits for them to finish:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+------------------------------+</span>     <span class="o">+----------+</span>
<span class="o">|</span>  <span class="n">talk</span>    <span class="o">|----&gt;|</span>  <span class="n">Playing</span> <span class="s2">&quot;Welcome to...&quot;</span>     <span class="o">|----&gt;|</span>  <span class="nb">next</span>    <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">|</span>  <span class="p">(</span><span class="n">audio</span> <span class="n">playing</span><span class="p">,</span> <span class="n">please</span> <span class="n">wait</span><span class="p">)</span><span class="o">|</span>     <span class="o">|</span>  <span class="n">action</span>  <span class="o">|</span>
                 <span class="o">+------------------------------+</span>     <span class="o">+----------+</span>
                              <span class="o">|</span>
                    <span class="n">Cursor</span> <span class="n">waits</span> <span class="n">here</span> <span class="n">until</span>
                    <span class="n">audio</span> <span class="n">finishes</span> <span class="n">playing</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">talk</span></code>, <code class="docutils literal notranslate"><span class="pre">play</span></code>, <code class="docutils literal notranslate"><span class="pre">digits_receive</span></code>, <code class="docutils literal notranslate"><span class="pre">recording_start</span></code></p>
<p><strong>Fire-and-Forget Actions (Dispatch and Continue)</strong></p>
<p>These actions send something out but don’t wait for a response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+------------+     +--------------------+
| email_send |----&gt;| Email dispatched!  |----&gt; Continue immediately
+------------+     | (delivery is async)|
                   +--------------------+
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">message_send</span></code>, <code class="docutils literal notranslate"><span class="pre">email_send</span></code>, <code class="docutils literal notranslate"><span class="pre">webhook_send</span></code></p>
<p><strong>Blocking Actions (Pause Until Triggered)</strong></p>
<p>These actions pause the flow until something external happens:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+------------------------------+</span>
<span class="o">|</span>  <span class="n">block</span>   <span class="o">|----&gt;|</span>  <span class="n">Flow</span> <span class="ow">is</span> <span class="n">paused</span><span class="o">...</span>           <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">|</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">API</span> <span class="n">call</span> <span class="n">to</span>     <span class="o">|</span>
                 <span class="o">|</span>  <span class="n">resume</span> <span class="n">execution</span>            <span class="o">|</span>
                 <span class="o">+------------------------------+</span>
                              <span class="o">|</span>
                 <span class="n">Call</span> <span class="n">POST</span> <span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">execute</span>
                              <span class="o">|</span>
                              <span class="n">v</span>
                 <span class="o">+------------------------------+</span>
                 <span class="o">|</span>  <span class="n">Flow</span> <span class="n">resumes</span><span class="p">,</span> <span class="n">cursor</span> <span class="n">moves</span>  <span class="o">|</span>
                 <span class="o">+------------------------------+</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">block</span></code></p>
<p><strong>Nested Actions (Push a Stack)</strong></p>
<p>Some actions start a sub-flow that runs inside the main flow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span> <span class="n">Flow</span><span class="p">:</span>                                <span class="n">Nested</span> <span class="n">Stack</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">queue_join</span><span class="p">):</span>
<span class="o">+--------+</span>  <span class="o">+------------+</span>               <span class="o">+-----------------------------+</span>
<span class="o">|</span> <span class="n">answer</span> <span class="o">|-&gt;|</span> <span class="n">queue_join</span> <span class="o">|--------------&gt;|</span> <span class="n">wait_flow</span> <span class="n">actions</span><span class="o">...</span>        <span class="o">|</span>
<span class="o">+--------+</span>  <span class="o">+------------+</span>               <span class="o">|</span> <span class="p">(</span><span class="n">talk</span><span class="p">,</span> <span class="n">play</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span>          <span class="o">|</span>
                  <span class="o">^</span>                      <span class="o">+-------------+---------------+</span>
                  <span class="o">|</span>                                    <span class="o">|</span>
                  <span class="o">|</span>      <span class="n">When</span> <span class="n">agent</span> <span class="n">answers</span> <span class="ow">or</span>         <span class="o">|</span>
                  <span class="o">|</span>      <span class="n">caller</span> <span class="n">hangs</span> <span class="n">up</span>               <span class="o">|</span>
                  <span class="o">+------------------------------------+</span>
                          <span class="n">Return</span> <span class="n">to</span> <span class="n">main</span> <span class="n">flow</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">queue_join</span></code>, <code class="docutils literal notranslate"><span class="pre">ai_talk</span></code>, <code class="docutils literal notranslate"><span class="pre">conference_join</span></code>, <code class="docutils literal notranslate"><span class="pre">fetch_flow</span></code></p>
</section>
<section id="branching-and-decision-making">
<h2>Branching and Decision Making<a class="headerlink" href="#branching-and-decision-making" title="Link to this heading"></a></h2>
<p>Flows can make decisions and take different paths based on conditions.</p>
<p><strong>The Branch Action</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">branch</span></code> action reads a variable and jumps to different actions based on its value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------------------+
|                         Branch Decision                              |
+----------------------------------------------------------------------+

                          Variable value?
                                |
                +---------------+---------------+
                |               |               |
                v               v               v
              &quot;1&quot;             &quot;2&quot;           (default)
                |               |               |
                v               v               v
        +------------+  +------------+  +------------+
        |  Sales     |  |  Support   |  |  Operator  |
        |  menu      |  |  menu      |  |  (fallback)|
        +------------+  +------------+  +------------+
</pre></div>
</div>
<p><strong>How Variables Get Set</strong></p>
<p>Variables are set by previous actions and then read by branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Step</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Collect</span> <span class="nb">input</span>
<span class="o">+-----------------+</span>
<span class="o">|</span> <span class="n">digits_receive</span>  <span class="o">|</span>  <span class="o">--&gt;</span>  <span class="n">User</span> <span class="n">presses</span> <span class="s2">&quot;2&quot;</span>
<span class="o">+-----------------+</span>       <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>

<span class="n">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Branch</span> <span class="n">based</span> <span class="n">on</span> <span class="nb">input</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>     <span class="n">branch</span>      <span class="o">|</span>  <span class="o">--&gt;</span>  <span class="n">Read</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span>
<span class="o">|</span>                 <span class="o">|</span>       <span class="n">Value</span> <span class="ow">is</span> <span class="s2">&quot;2&quot;</span>
<span class="o">|</span> <span class="n">variable</span><span class="p">:</span>       <span class="o">|</span>       <span class="n">Jump</span> <span class="n">to</span> <span class="n">Support</span> <span class="n">menu</span>
<span class="o">|</span>  <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="n">digits</span>         <span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
<p><strong>Condition Actions</strong></p>
<p>For more complex logic, use condition actions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>condition_variable:
+-------------------------------------------------------------------+
|  IF ${customer.tier} equals &quot;premium&quot;                             |
|     → Continue to next action (VIP treatment)                     |
|  ELSE                                                             |
|     → Jump to false_target_id (standard treatment)                |
+-------------------------------------------------------------------+
</pre></div>
</div>
<p>Available conditions:
- <code class="docutils literal notranslate"><span class="pre">equal</span></code>, <code class="docutils literal notranslate"><span class="pre">not_equal</span></code>
- <code class="docutils literal notranslate"><span class="pre">greater</span></code>, <code class="docutils literal notranslate"><span class="pre">less</span></code>
- <code class="docutils literal notranslate"><span class="pre">greater_equal</span></code>, <code class="docutils literal notranslate"><span class="pre">less_equal</span></code></p>
</section>
<section id="the-variable-system">
<h2>The Variable System<a class="headerlink" href="#the-variable-system" title="Link to this heading"></a></h2>
<p>Variables store information during flow execution. They’re like sticky notes that actions can write and read.</p>
<p><strong>Built-in Variables</strong></p>
<p>VoIPBIN automatically creates these variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">Built</span><span class="o">-</span><span class="ow">in</span> <span class="n">Variables</span>                           <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">id</span>           <span class="o">|</span> <span class="n">Current</span> <span class="n">activeflow</span> <span class="n">ID</span>         <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">reference_id</span> <span class="o">|</span> <span class="n">The</span> <span class="n">call</span><span class="o">/</span><span class="n">conversation</span> <span class="n">ID</span>      <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span>             <span class="o">|</span> <span class="n">DTMF</span> <span class="n">digits</span> <span class="n">received</span>          <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">caller_id</span>          <span class="o">|</span> <span class="n">Caller</span><span class="s1">&#39;s phone number         |</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">text</span>            <span class="o">|</span> <span class="n">Received</span> <span class="n">message</span> <span class="n">content</span>      <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">recording</span><span class="o">.</span><span class="n">id</span>            <span class="o">|</span> <span class="n">Current</span> <span class="n">recording</span> <span class="n">ID</span>          <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
</pre></div>
</div>
<p><strong>Custom Variables</strong></p>
<p>You can set your own variables with the <code class="docutils literal notranslate"><span class="pre">variable_set</span></code> action:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;variable_set&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;customer.language&quot;</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Using Variables in Actions</strong></p>
<p>Variables are substituted using <code class="docutils literal notranslate"><span class="pre">${variable.name}</span></code> syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello $</span><span class="si">{customer.name}</span><span class="s2">, welcome back!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;$</span><span class="si">{customer.language}</span><span class="s2">&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Before this action executes, VoIPBIN replaces the placeholders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span> <span class="s2">&quot;Hello $</span><span class="si">{customer.name}</span><span class="s2">, welcome back!&quot;</span>
<span class="n">After</span><span class="p">:</span>  <span class="s2">&quot;Hello John Smith, welcome back!&quot;</span>
</pre></div>
</div>
</section>
<section id="unified-flow">
<span id="flow-overview-unified-flow"></span><h2>Unified flow<a class="headerlink" href="#unified-flow" title="Link to this heading"></a></h2>
<p>VoIPBIN’s Unified Flow feature is a game-changer, allowing users to create a single flow that can be attached to multiple communication channels, including voice and video calls, SMS, and RESTful API triggers.</p>
<p>With Unified Flow, users can design a custom flow that defines the actions to be taken when a specific channel request is received. VoIPBIN then automatically executes this flow, ensuring a consistent experience for customers across various channels.</p>
</section>
<section id="non-linear-action-execution">
<span id="flow-overview-non-linear-action-execution"></span><h2>Non-linear action execution<a class="headerlink" href="#non-linear-action-execution" title="Link to this heading"></a></h2>
<p>VoIPBIN’s Flow provides the flexibility of Non-Linear action execution.</p>
<p>Users can customize their actions in both linear and non-linear ways, allowing them to define complex logic and decision trees to handle various call scenarios.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Linear Execution:
+---+   +---+   +---+   +---+
| 1 |--&gt;| 2 |--&gt;| 3 |--&gt;| 4 |
+---+   +---+   +---+   +---+

Non-Linear Execution (with goto and branch):
+---+   +---+   +---+   +---+
| 1 |--&gt;| 2 |--&gt;| 3 |--&gt;| 4 |
+---+   +-+-+   +---+   +-+-+
          |               |
          |   +-----------+
          |   | (goto back to 2)
          v   v
        +-------+
        | Loop! |
        +-------+
</pre></div>
</div>
<img alt="_images/flow_overview_non_linear.png" src="_images/flow_overview_non_linear.png" />
</section>
<section id="flow-fork">
<span id="flow-overview-flow-fork"></span><h2>Flow fork<a class="headerlink" href="#flow-fork" title="Link to this heading"></a></h2>
<p>Certain flow actions, such as fetch, fetch_flow, queue_join, and more, enable flow forking.</p>
<p>When the flow is forked, the execution cursor moves to the forked flow and starts executing the actions within it. Once the forked flow reaches its end, the execution cursor moves back to the following action of the forking action, continuing the flow execution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span> <span class="n">Flow</span>                         <span class="n">Forked</span> <span class="n">Flow</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">queue_join</span><span class="p">)</span>
<span class="o">+---------+</span>                      <span class="o">+---------------------------------+</span>
<span class="o">|</span> <span class="n">answer</span>  <span class="o">|</span>                      <span class="o">|</span>                                 <span class="o">|</span>
<span class="o">+----+----+</span>                      <span class="o">|</span>  <span class="o">+------+</span>   <span class="o">+------+</span>   <span class="o">+------+</span> <span class="o">|</span>
     <span class="o">|</span>                           <span class="o">|</span>  <span class="o">|</span> <span class="n">talk</span> <span class="o">|--&gt;|</span> <span class="n">play</span> <span class="o">|--&gt;|</span> <span class="n">talk</span> <span class="o">|</span> <span class="o">|</span>
     <span class="n">v</span>                           <span class="o">|</span>  <span class="o">+------+</span>   <span class="o">+------+</span>   <span class="o">+------+</span> <span class="o">|</span>
<span class="o">+------------+</span>                   <span class="o">|</span>         <span class="n">Wait</span> <span class="n">Flow</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">queue_join</span> <span class="o">|==================&gt;+---------------------------------+</span>
<span class="o">+----+-------+</span>                            <span class="o">|</span>
     <span class="o">|</span>                                    <span class="o">|</span> <span class="p">(</span><span class="n">returns</span> <span class="n">when</span> <span class="n">done</span><span class="p">)</span>
     <span class="o">|&lt;===================================+</span>
     <span class="o">|</span>
     <span class="n">v</span>
<span class="o">+----------+</span>
<span class="o">|</span> <span class="k">continue</span> <span class="o">|</span>
<span class="o">+----------+</span>
</pre></div>
</div>
<img alt="_images/flow_overview_fork.png" src="_images/flow_overview_fork.png" />
</section>
<section id="actions">
<span id="flow-overview-actions"></span><h2>Actions<a class="headerlink" href="#actions" title="Link to this heading"></a></h2>
<p>Within VoIPBIN, actions dictate the course of the platform’s response in a given flow, encompassing tasks such as initiating calls, playing sounds or prompts, activating text-to-speech, sending SMS or DTMFs, and dispatching SNS messages. These diverse actions serve as indispensable building blocks for crafting customized voice applications, ensuring the creation of uniquely tailored call experiences for users.</p>
<p>VoIPBIN’s Flow provides developers with a versatile and robust toolkit, empowering them to forge dynamic voice applications, efficiently manage incoming calls, and curate personalized call encounters. Through its non-linear execution, cohesive flow capabilities, and an array of actions including SMS, DTMFs, SNS messages, and more, VoIPBIN’s Flow unveils limitless possibilities for the development of sophisticated and interactive voice applications, precisely tailored to meet specific business needs.</p>
<p><strong>Action Categories</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Actions</p></th>
<th class="head"><p>Behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Media</p></td>
<td><p>talk, play, recording_start, recording_stop</p></td>
<td><p>Wait for completion</p></td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><p>digits_receive, transcribe_start</p></td>
<td><p>Wait for input</p></td>
</tr>
<tr class="row-even"><td><p>Control</p></td>
<td><p>goto, branch, condition_*, stop, empty</p></td>
<td><p>Immediate</p></td>
</tr>
<tr class="row-odd"><td><p>Communication</p></td>
<td><p>message_send, email_send, webhook_send</p></td>
<td><p>Fire and forget</p></td>
</tr>
<tr class="row-even"><td><p>Nested</p></td>
<td><p>queue_join, ai_talk, conference_join, fetch</p></td>
<td><p>Push stack, return</p></td>
</tr>
<tr class="row-odd"><td><p>Call Control</p></td>
<td><p>answer, hangup, hold, mute, connect, transfer</p></td>
<td><p>Immediate or wait</p></td>
</tr>
</tbody>
</table>
</section>
<section id="flow-execution">
<span id="flow-overview-flow-execution"></span><h2>Flow execution<a class="headerlink" href="#flow-execution" title="Link to this heading"></a></h2>
<p>In VoIPBIN, the execution of flows is versatile and can be initiated through various methods:</p>
<section id="incoming-outgoing-calls">
<h3>Incoming/Outgoing Calls<a class="headerlink" href="#incoming-outgoing-calls" title="Link to this heading"></a></h3>
<p>VoIPBIN facilitates flow execution with both incoming and outgoing calls. Users have the option to register a flow to a specific number. Upon an incoming call to the registered number, VoIPBIN will seamlessly execute the associated flow.
Users can also initiate a call with a predefined flow. Once the outgoing call is answered, the attached flow will be triggered.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Incoming</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">:</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
<span class="o">|</span>  <span class="n">Caller</span> <span class="n">dials</span><span class="o">|-----&gt;|</span>  <span class="n">VoIPBIN</span> <span class="n">looks</span>  <span class="o">|-----&gt;|</span>  <span class="n">Flow</span> <span class="n">starts</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="n">your</span> <span class="n">number</span> <span class="o">|</span>      <span class="o">|</span>  <span class="n">up</span> <span class="n">the</span> <span class="n">number</span>  <span class="o">|</span>      <span class="o">|</span>  <span class="n">executing</span>    <span class="o">|</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>

<span class="n">Outgoing</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">:</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
<span class="o">|</span>  <span class="n">POST</span> <span class="o">/</span><span class="n">calls</span> <span class="o">|-----&gt;|</span>  <span class="n">Call</span> <span class="n">connects</span>  <span class="o">|-----&gt;|</span>  <span class="n">Flow</span> <span class="n">starts</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="k">with</span> <span class="n">actions</span><span class="o">|</span>      <span class="o">|</span>  <span class="p">(</span><span class="n">answered</span><span class="p">)</span>     <span class="o">|</span>      <span class="o">|</span>  <span class="n">executing</span>    <span class="o">|</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
</pre></div>
</div>
</section>
<section id="received-messages">
<h3>Received Messages<a class="headerlink" href="#received-messages" title="Link to this heading"></a></h3>
<p>VoIPBIN allows users to register flows to received messages. When a message is received, the registered flow will be executed.
For example, you can register the flow like the below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin.message.text&quot;</span><span class="p">,</span>
    <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;call me&quot;</span><span class="p">:</span> <span class="s2">&quot;7a1e8c4c-aaea-11ed-9f0f-bffcc31ca3c3&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text me&quot;</span><span class="p">:</span> <span class="s2">&quot;79fd8c9a-aaea-11ed-a238-0b094a49c637&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text developer&quot;</span><span class="p">:</span> <span class="s2">&quot;73107b70-d56b-4b47-b331-dc4f2ac43a5b&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In the provided example, the system examines the content of the received message using <strong>voipbin.message.text</strong> and proceeds to compare the message text.
Should the message text match the specified criterion, such as “call me,” the flow execution cursor will be directed to the designated action ID (7a1e8c4c-aaea-11ed-9f0f-bffcc31ca3c3) for subsequent execution.
See the <a class="reference internal" href="variable_variable.html#variable-variable"><span class="std std-ref">Variable Reference</span></a> for all available variables.</p>
</section>
<section id="outbound-campaigns">
<h3>Outbound Campaigns<a class="headerlink" href="#outbound-campaigns" title="Link to this heading"></a></h3>
<p>The VoIPBIN platform integrates flows into outbound campaigns, providing a structured and automated approach to execution.</p>
</section>
<section id="api">
<h3>API<a class="headerlink" href="#api" title="Link to this heading"></a></h3>
<p>Users have the flexibility to trigger flows through API calls. This API integration empowers developers to seamlessly incorporate and activate flows within their applications.
These diverse methods offer users and developers flexibility in integrating and executing flows based on their specific needs and scenarios.
See the <a class="reference external" href="https://api.voipbin.net/redoc/#tag/Activeflow">Activeflow API Reference</a> for API details.
And due to the absence of any media-based incoming or outgoing elements in the API, certain actions within the flow—such as answer, talk, transcribe, and others—will be ignored. Instead, the execution cursor will proceed to the next action in the sequence.</p>
</section>
</section>
<section id="flow-lifecycle">
<h2>Flow Lifecycle<a class="headerlink" href="#flow-lifecycle" title="Link to this heading"></a></h2>
<p>Understanding when flows start, run, and end helps you design reliable applications.</p>
<p><strong>Flow States</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------------+</span>         <span class="o">+------------+</span>         <span class="o">+------------+</span>
<span class="o">|</span>  <span class="n">Created</span>   <span class="o">|--------&gt;|</span>  <span class="n">Running</span>   <span class="o">|--------&gt;|</span>   <span class="n">Ended</span>    <span class="o">|</span>
<span class="o">+------------+</span>         <span class="o">+------------+</span>         <span class="o">+------------+</span>
      <span class="o">|</span>                      <span class="o">|</span>                      <span class="o">|</span>
      <span class="o">|</span>                      <span class="o">|</span>                      <span class="o">|</span>
<span class="n">Activeflow</span>          <span class="n">Cursor</span> <span class="n">executing</span>         <span class="n">Final</span> <span class="n">state</span>
<span class="n">instance</span> <span class="n">created</span>    <span class="n">actions</span>                  <span class="p">(</span><span class="n">no</span> <span class="n">more</span> <span class="n">changes</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>What Ends a Flow</strong></p>
<p>A flow ends when any of these happen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+-----------------------------------------------------------------+
|                    Flow Termination Triggers                    |
+-----------------------------------------------------------------+

1. End of actions reached
   +---+   +---+   +---+   +---------+
   | 1 |--&gt;| 2 |--&gt;| 3 |--&gt;|  END    |  ← Cursor reaches end
   +---+   +---+   +---+   +---------+

2. Stop action executed
   +---+   +------+
   | 1 |--&gt;| stop |  ← Explicit stop command
   +---+   +------+

3. Call hangs up (for call-based flows)
   +---+   +---+   +---+
   | 1 |--&gt;| 2 |--&gt;| X |  ← Caller or callee hung up
   +---+   +---+   +---+

4. API stop request
   POST /activeflows/{id}/stop  ← External stop command
</pre></div>
</div>
<p><strong>After Flow Ends</strong></p>
<p>When a flow ends, if <code class="docutils literal notranslate"><span class="pre">on_complete_flow_id</span></code> is set, the next flow starts automatically (see below).</p>
</section>
<section id="flow-actions-and-interrupt-actions">
<h2>Flow Actions and Interrupt Actions<a class="headerlink" href="#flow-actions-and-interrupt-actions" title="Link to this heading"></a></h2>
<p>VoIPBIN’s Flow is built on an action-based engine. Each flow is defined as a JSON array of actions, where a “cursor” tracks the current execution point. Under normal circumstances, the cursor advances sequentially from one action to the next based on the flow’s logic. This modular design lets you compose a variety of call-handling scenarios—from answering calls and playing prompts to branching based on caller input.</p>
<section id="standard-flow-actions">
<h3>Standard Flow Actions<a class="headerlink" href="#standard-flow-actions" title="Link to this heading"></a></h3>
<p>Standard flow actions are the building blocks of your call handling logic. Examples include:</p>
<ul class="simple">
<li><p>Answer: Picks up the incoming call.</p></li>
<li><p>Talk: Plays a TTS message or pre-recorded audio.</p></li>
<li><p>Digits Receive: Gathers DTMF input from the caller.</p></li>
<li><p>Branch: Directs the flow based on collected input.</p></li>
</ul>
<p>Each action is executed in sequence, and upon completion, the flow cursor moves to the next action defined in the JSON array. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9bc851be-f05e-11ef-a1e0-77ec628521e0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;flow&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample Call Flow&quot;</span><span class="p">,</span>
  <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c8ebac0-f05e-11ef-b9ae-4b8aecc935fe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;answer&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c30642a-f05e-11ef-8674-ebba44c5cb0f2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Welcome to VoIPBIN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c659370-f05e-11ef-b141-63708262508b&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9cb2962a-f05e-11ef-ae35-2374e1ae16df&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin.call.digits&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;9c30642a-f05e-11ef-8674-ebba44c5cb0f2&quot;</span><span class="p">,</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, the flow proceeds step-by-step—from answering the call to playing a welcome message, receiving DTMF input, and branching accordingly.</p>
</section>
<section id="interrupt-actions">
<h3>Interrupt Actions<a class="headerlink" href="#interrupt-actions" title="Link to this heading"></a></h3>
<p>Interrupt actions are specialized commands that can be triggered asynchronously—at any point during the flow—to handle unexpected events or to initiate high-priority tasks. Unlike standard actions, interrupt actions are designed to override or temporarily suspend the normal flow progression.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Normal Flow Execution              Interrupt Arrives!
+---+   +---+   +---+             +-----------------+
| 1 |--&gt;| 2 |--&gt;| 3 |&lt;------------| Transfer Request|
+---+   +---+   +---+             +-----------------+
             ^                            |
             |                            v
             |                    +-----------------+
             |                    | Interrupt takes |
             +--------------------| over, then      |
               (resume later)     | returns         |
                                  +-----------------+
</pre></div>
</div>
<p>Common interrupt actions include:</p>
<ul class="simple">
<li><p>Attended Transfer: Initiates a transfer even if the call is mid-flow. This allows an operator to consult with a transferee before completing the transfer.</p></li>
<li><p>Transcribe: Starts real-time transcription of the call. This can be triggered on demand without waiting for the current flow action to complete.</p></li>
<li><p>Recording: Begins or stops call recording independently of the flow’s sequential actions.</p></li>
<li><p>Text-to-Speech (TTS): Plays a TTS message at any moment, regardless of the flow’s current state.</p></li>
</ul>
</section>
<section id="how-interrupt-actions-work">
<h3>How Interrupt Actions Work<a class="headerlink" href="#how-interrupt-actions-work" title="Link to this heading"></a></h3>
<p>Interrupt actions are implemented through dedicated API endpoints. When an interrupt is invoked, the platform either temporarily pauses the current flow or dynamically inserts the interrupt action into the execution sequence. Once the interrupt is handled, the flow resumes from the appropriate point.</p>
<p>For example, while the call is waiting for DTMF input in the standard flow, an attended transfer interrupt may be triggered via a separate API call. This immediate action takes precedence over the flow’s waiting state, ensuring that time-sensitive operations are executed without delay.</p>
</section>
<section id="integration-and-best-practices">
<h3>Integration and Best Practices<a class="headerlink" href="#integration-and-best-practices" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Flexibility: Use standard flow actions to define your routine call-handling steps, and rely on interrupt actions for events that require immediate attention.</p></li>
<li><p>API Integration: Interrupt actions can be initiated via dedicated API calls, enabling your application to react in real time to dynamic call events.</p></li>
<li><p>Flow Resumption: After an interrupt action completes, VoIPBIN resumes the flow from the designated point, ensuring a seamless call experience.</p></li>
</ul>
<p>By combining sequential flow actions with the ability to trigger interrupt actions at any time, VoIPBIN provides a robust, programmable environment that can handle both predictable call scenarios and unexpected events with equal ease.</p>
</section>
</section>
<section id="the-on-complete-flow-id">
<h2>The on complete flow id<a class="headerlink" href="#the-on-complete-flow-id" title="Link to this heading"></a></h2>
<p>The on_complete_flow_id allows a flow to automatically trigger another flow in a new session once the current flow completes. This feature addresses a key limitation of call-based flows: when a call ends, the flow execution ends immediately, preventing any post-call actions (After Call Work) from running.</p>
<p>With on_complete_flow_id, developers can define a follow-up flow that executes after the call or flow ends, enabling tasks such as call-summary generation, sending emails, processing recordings, or running analytics.</p>
<section id="how-it-works">
<h3>How it works<a class="headerlink" href="#how-it-works" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">On</span> <span class="n">Complete</span> <span class="n">Flow</span> <span class="n">Chain</span>                             <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Flow</span> <span class="n">A</span> <span class="p">(</span><span class="n">Main</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">)</span>                  <span class="n">Flow</span> <span class="n">B</span> <span class="p">(</span><span class="n">After</span> <span class="n">Call</span> <span class="n">Work</span><span class="p">)</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
<span class="o">|</span> <span class="n">answer</span>                  <span class="o">|</span>             <span class="o">|</span> <span class="n">fetch</span> <span class="n">recording</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">talk</span> <span class="s2">&quot;Hello&quot;</span>            <span class="o">|</span>             <span class="o">|</span> <span class="n">ai_summarize</span>            <span class="o">|</span>
<span class="o">|</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">agent</span>        <span class="o">|</span>             <span class="o">|</span> <span class="n">email_send</span> <span class="n">summary</span>      <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">call</span> <span class="n">happens</span><span class="o">...</span><span class="p">)</span>       <span class="o">|</span>             <span class="o">|</span> <span class="n">webhook_send</span> <span class="n">analytics</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">hangup</span>                  <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span>                         <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span> <span class="n">on_complete_flow_id</span><span class="p">:</span> <span class="n">B</span>  <span class="o">|------------&gt;|</span> <span class="p">(</span><span class="n">inherits</span> <span class="n">variables</span><span class="p">)</span>    <span class="o">|</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
          <span class="o">|</span>                                        <span class="o">|</span>
          <span class="o">|</span> <span class="n">Call</span> <span class="n">ends</span>                              <span class="o">|</span> <span class="n">Flow</span> <span class="n">B</span> <span class="n">starts</span>
          <span class="o">|</span> <span class="n">Flow</span> <span class="n">A</span> <span class="n">stops</span>                           <span class="o">|</span> <span class="n">automatically</span>
          <span class="n">v</span>                                        <span class="n">v</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Caller</span>             <span class="n">VoIPBIN</span> <span class="n">Engine</span>              <span class="n">Flow</span> <span class="n">A</span>                <span class="n">Flow</span> <span class="n">B</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="o">---</span> <span class="n">Incoming</span> <span class="n">Call</span> <span class="o">--&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|--</span> <span class="n">Start</span> <span class="n">Flow</span> <span class="n">A</span> <span class="o">-------&gt;|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span> <span class="n">Execute</span> <span class="n">actions</span>     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span> <span class="n">answer</span><span class="o">/</span><span class="n">talk</span><span class="o">/...</span>     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="o">&lt;--</span> <span class="n">Call</span> <span class="n">Progress</span> <span class="o">--&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="n">X</span> <span class="o">---</span> <span class="n">Hangup</span> <span class="o">---------&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Stop</span> <span class="n">Flow</span> <span class="n">A</span> <span class="o">--------&gt;|</span>                     <span class="o">|</span>
                       <span class="o">|</span>                        <span class="n">X</span> <span class="p">(</span><span class="n">Flow</span> <span class="n">A</span> <span class="n">stops</span><span class="p">)</span>      <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
            <span class="n">Check</span> <span class="n">on_complete_flow_id</span>                                 <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Start</span> <span class="n">NEW</span> <span class="n">session</span> <span class="o">------------------------&gt;|</span>
                       <span class="o">|</span>                                           <span class="p">(</span><span class="n">inherit</span> <span class="n">variables</span><span class="p">)</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Start</span> <span class="n">Flow</span> <span class="n">B</span> <span class="o">-----------------------------&gt;|</span>
                                                                      <span class="o">|</span> <span class="n">Execute</span> <span class="n">ACW</span> <span class="n">actions</span>
                                                                      <span class="o">|</span> <span class="n">summarize</span><span class="o">/</span><span class="n">email</span><span class="o">/...</span>
                                                                      <span class="o">|</span>
                                                                      <span class="n">X</span> <span class="p">(</span><span class="n">Flow</span> <span class="n">B</span> <span class="n">ends</span><span class="p">)</span>
                                                                        <span class="n">If</span> <span class="n">Flow</span> <span class="n">B</span> <span class="n">has</span> <span class="n">on_complete_flow_id</span>
                                                                        <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="n">then</span> <span class="n">start</span> <span class="n">another</span> <span class="n">chain</span>
</pre></div>
</div>
<p>When a flow ends—either by reaching the end of its action list, encountering a stop action, or due to call termination—VoIPBIN checks whether on_complete_flow_id is defined.</p>
<p>If so, VoIPBIN starts the referenced flow as a new independent session.</p>
<p>Most runtime variables from the original flow (e.g., ${voipbin.recording.id}, ${voipbin.call.id}) are inherited automatically, allowing seamless post-call workflows without requiring manual variable passing.</p>
<p><strong>Variable Inheritance</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Flow A ends with these variables:
+-----------------------------------------+
| voipbin.call.id = &quot;abc-123&quot;             |
| voipbin.recording.id = &quot;rec-456&quot;        |
| customer.name = &quot;John&quot;                  |
| voipbin.activeflow.complete_count = 0   |
+-----------------------------------------+
                     |
                     | copied to
                     v
Flow B starts with these variables:
+-----------------------------------------+
| voipbin.call.id = &quot;abc-123&quot;             |  ← inherited
| voipbin.recording.id = &quot;rec-456&quot;        |  ← inherited
| customer.name = &quot;John&quot;                  |  ← inherited
| voipbin.activeflow.complete_count = 1   |  ← incremented
+-----------------------------------------+
</pre></div>
</div>
</section>
</section>
<section id="execution-limits">
<h2>Execution limits<a class="headerlink" href="#execution-limits" title="Link to this heading"></a></h2>
<p>To prevent infinite recursion, VoIPBIN enforces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span> <span class="n">A</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">B</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">C</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">D</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">E</span> <span class="o">--&gt;</span> <span class="n">STOP</span>
  <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>
<span class="n">count</span><span class="o">=</span><span class="mi">0</span>    <span class="n">count</span><span class="o">=</span><span class="mi">1</span>    <span class="n">count</span><span class="o">=</span><span class="mi">2</span>    <span class="n">count</span><span class="o">=</span><span class="mi">3</span>    <span class="n">count</span><span class="o">=</span><span class="mi">4</span>
                                              <span class="o">|</span>
                                              <span class="o">|</span> <span class="n">count</span><span class="o">=</span><span class="mi">5</span> <span class="n">would</span> <span class="n">be</span> <span class="n">blocked</span>
                                              <span class="n">v</span>
                                        <span class="n">Maximum</span> <span class="n">depth</span> <span class="n">reached</span>
</pre></div>
</div>
<ul class="simple">
<li><p>A maximum of 5 chained on-complete executions. Beyond this limit, no further follow-up flows are triggered.</p></li>
<li><p>Circular references should be avoided, even though safeguards exist.</p></li>
</ul>
</section>
<section id="behavior-on-termination">
<h2>Behavior on termination<a class="headerlink" href="#behavior-on-termination" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>If the flow fails, on_complete_flow_id is not triggered.</p></li>
<li><p>If the flow is forcefully terminated (e.g., due to call hangup), the on-complete flow still runs.</p></li>
</ul>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow_initial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;on_complete_flow_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow_after_call_work&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This configuration ensures that when <em>flow_initial</em> completes—regardless of how the call ended—the <em>flow_after_call_work</em> flow starts immediately in a new session, while preserving key session variables from the original flow.</p>
</section>
<section id="error-handling-in-flows">
<h2>Error Handling in Flows<a class="headerlink" href="#error-handling-in-flows" title="Link to this heading"></a></h2>
<p>When something goes wrong during flow execution, VoIPBIN handles it gracefully.</p>
<p><strong>Error Scenarios</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Scenario</p></th>
<th class="head"><p>What happens</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Invalid action</p></td>
<td><p>Action is skipped, flow continues to next action</p></td>
</tr>
<tr class="row-odd"><td><p>Media action fails</p></td>
<td><p>Error logged, flow continues or stops based on severity</p></td>
</tr>
<tr class="row-even"><td><p>External service down</p></td>
<td><p>Fire-and-forget actions continue, blocking ones may fail</p></td>
</tr>
<tr class="row-odd"><td><p>Infinite loop detected</p></td>
<td><p>Flow stops after max iterations (safety limit)</p></td>
</tr>
<tr class="row-even"><td><p>Call hangs up</p></td>
<td><p>Flow ends immediately, on_complete_flow runs if set</p></td>
</tr>
</tbody>
</table>
<p><strong>Safety Limits</strong></p>
<p>VoIPBIN prevents runaway flows with built-in limits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Maximum</span> <span class="n">iterations</span> <span class="n">per</span> <span class="n">execution</span> <span class="n">cycle</span><span class="p">:</span> <span class="mi">1000</span>
<span class="n">Maximum</span> <span class="n">total</span> <span class="n">executions</span> <span class="n">per</span> <span class="n">activeflow</span><span class="p">:</span> <span class="mi">100</span>
<span class="n">Maximum</span> <span class="n">on_complete_flow</span> <span class="n">chain</span> <span class="n">depth</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>If these limits are exceeded, the flow stops automatically to protect system resources.</p>
<p><strong>Best Practices for Error Handling</strong></p>
<ol class="arabic simple">
<li><p><strong>Set default branches</strong>: Always include a <code class="docutils literal notranslate"><span class="pre">default_target_id</span></code> in branch actions</p></li>
<li><p><strong>Use timeouts</strong>: Configure appropriate durations for input actions</p></li>
<li><p><strong>Log with webhooks</strong>: Send important events to your webhook for monitoring</p></li>
<li><p><strong>Plan for hangup</strong>: Remember that call-based flows end when the call ends</p></li>
</ol>
</section>
</section>

</main>
                        
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Overview</a><ul>
<li><a class="reference internal" href="#how-the-flow-works">How the flow works</a></li>
<li><a class="reference internal" href="#understanding-flow-execution">Understanding Flow Execution</a></li>
<li><a class="reference internal" href="#action-execution-patterns">Action Execution Patterns</a></li>
<li><a class="reference internal" href="#branching-and-decision-making">Branching and Decision Making</a></li>
<li><a class="reference internal" href="#the-variable-system">The Variable System</a></li>
<li><a class="reference internal" href="#unified-flow">Unified flow</a></li>
<li><a class="reference internal" href="#non-linear-action-execution">Non-linear action execution</a></li>
<li><a class="reference internal" href="#flow-fork">Flow fork</a></li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#flow-execution">Flow execution</a><ul>
<li><a class="reference internal" href="#incoming-outgoing-calls">Incoming/Outgoing Calls</a></li>
<li><a class="reference internal" href="#received-messages">Received Messages</a></li>
<li><a class="reference internal" href="#outbound-campaigns">Outbound Campaigns</a></li>
<li><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-lifecycle">Flow Lifecycle</a></li>
<li><a class="reference internal" href="#flow-actions-and-interrupt-actions">Flow Actions and Interrupt Actions</a><ul>
<li><a class="reference internal" href="#standard-flow-actions">Standard Flow Actions</a></li>
<li><a class="reference internal" href="#interrupt-actions">Interrupt Actions</a></li>
<li><a class="reference internal" href="#how-interrupt-actions-work">How Interrupt Actions Work</a></li>
<li><a class="reference internal" href="#integration-and-best-practices">Integration and Best Practices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-on-complete-flow-id">The on complete flow id</a><ul>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
</ul>
</li>
<li><a class="reference internal" href="#execution-limits">Execution limits</a></li>
<li><a class="reference internal" href="#behavior-on-termination">Behavior on termination</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#error-handling-in-flows">Error Handling in Flows</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">About Us</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">Contact</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2026, VoIPBIN
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a class="text-white" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.5.0
                    </a>
                    and
                    <a class="text-white" href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 7.2.6
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="_static/jquery.js?v=8dae8fb0"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script type="text/javascript" src="_static/dist/theme.js"></script>
        <script type="text/javascript" src="_static/dist/vendor.js"></script>
        <script type="text/javascript" src="_static/searchtools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>