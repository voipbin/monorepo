<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Tool Functions &mdash; voipbin  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8e8a900e" />
      <link rel="stylesheet" type="text/css" href="_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="voipbin  documentation" href="#" />
    </head>
<body>
    <script type="text/javascript" src="_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="intro.html"
                        title="voipbin"
                        class="logo navbar-brand"
                    >
                        <img src="_static/images/voipbin-high-resolution-logo-white-transparent.png" width="45" height="80" alt="voipbin"
                            class="logo-img"
                        />
                        VoIPBin Documentation
                    </a>
                
                
                    <div class="collapse navbar-collapse justify-content-end">
                        <ul class="navbar-nav">
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="http://voipbin.net">Project</a></li>
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="https://admin.voipbin.net">Admin</a></li>
                            
                        </ul>
                    </div>
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="accesskey.html">Accesskey</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk.html">SDK(Software Development Kit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="restful_api.html">RESTful API(Application Programming Interface)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="flow.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow.html#activeflow">Activeflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l1"><a class="reference internal" href="webhook.html">Webhook</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Voice &amp; Real-Time</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="call.html">Call</a></li>
<li class="toctree-l1"><a class="reference internal" href="conference.html">Conference</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue.html">Queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="recording.html">Recording</a></li>
<li class="toctree-l1"><a class="reference internal" href="transcribe.html">Transcribe</a></li>
<li class="toctree-l1"><a class="reference internal" href="mediastream.html">Mediastream</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Messaging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="message.html">Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="talk.html">Talk</a></li>
<li class="toctree-l1"><a class="reference internal" href="conversation.html">Conversation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI &amp; Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ai.html">AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="campaign.html">Campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdial.html">Outdial</a></li>
<li class="toctree-l1"><a class="reference internal" href="outplan.html">Outplan</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources &amp; Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="customer.html">Customer</a></li>
<li class="toctree-l1"><a class="reference internal" href="billing_account.html">Billing Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="tag.html">Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="provider.html">Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="route.html">Route</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension.html">Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="trunk.html">Trunk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture (Deep Dive)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="websocket.html">Websocket</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Help &amp; Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Tool Functions</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="_sources/ai_struct_tool.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="tool-functions">
<span id="ai-struct-tool"></span><h1>Tool Functions<a class="headerlink" href="#tool-functions" title="Link to this heading"></a></h1>
<p>Tool functions enable the AI to perform actions during voice conversations. When the AI determines that an action is needed based on the conversation context, it can invoke the appropriate tool function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>AI Implementation Hint</strong></p>
<p>Tool functions are invoked by the LLM, not by your application code. You configure which tools are available via the <code class="docutils literal notranslate"><span class="pre">tool_names</span></code> field in the AI configuration (<code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/ais</span></code> or inline flow action). The LLM decides when to call a tool based on conversation context and the tool’s parameter schema. Your prompt should describe when each tool should be used.</p>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Caller</span>                      <span class="n">AI</span> <span class="n">Engine</span>                    <span class="n">VoIPBIN</span> <span class="n">Platform</span>
  <span class="o">|</span>                            <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">|</span>  <span class="s2">&quot;Transfer me to sales&quot;</span>    <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">+---------------------------&gt;|</span>                              <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|</span>  <span class="n">Detects</span> <span class="n">intent</span>              <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|</span>  <span class="n">Invokes</span> <span class="n">connect_call</span>        <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">+-----------------------------&gt;|</span>
  <span class="o">|</span>                            <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|</span>                   <span class="n">Tool</span> <span class="n">result</span><span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|&lt;-----------------------------+</span>
  <span class="o">|</span>                            <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">|</span>   <span class="s2">&quot;Connecting you now...&quot;</span>  <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">|&lt;---------------------------+</span>                              <span class="o">|</span>
  <span class="o">|</span>                            <span class="o">|</span>                              <span class="o">|</span>
  <span class="o">+--------------</span> <span class="n">Call</span> <span class="n">transferred</span> <span class="n">to</span> <span class="n">sales</span> <span class="o">-----------------&gt;|</span>
</pre></div>
</div>
</section>
<section id="available-tools">
<h2>Available Tools<a class="headerlink" href="#available-tools" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tool Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>connect_call</p></td>
<td><p>Transfer or connect to another endpoint</p></td>
</tr>
<tr class="row-odd"><td><p>send_email</p></td>
<td><p>Send an email message</p></td>
</tr>
<tr class="row-even"><td><p>send_message</p></td>
<td><p>Send an SMS text message</p></td>
</tr>
<tr class="row-odd"><td><p>stop_media</p></td>
<td><p>Stop currently playing media</p></td>
</tr>
<tr class="row-even"><td><p>stop_service</p></td>
<td><p>End the AI conversation (soft stop)</p></td>
</tr>
<tr class="row-odd"><td><p>stop_flow</p></td>
<td><p>Terminate the entire flow (hard stop)</p></td>
</tr>
<tr class="row-even"><td><p>set_variables</p></td>
<td><p>Save data to flow context</p></td>
</tr>
<tr class="row-odd"><td><p>get_variables</p></td>
<td><p>Retrieve data from flow context</p></td>
</tr>
<tr class="row-even"><td><p>get_aicall_messages</p></td>
<td><p>Get message history from an AI call</p></td>
</tr>
</tbody>
</table>
</section>
<section id="connect-call">
<span id="ai-struct-tool-connect-call"></span><h2>connect_call<a class="headerlink" href="#connect-call" title="Link to this heading"></a></h2>
<p>Connects or transfers the user to another endpoint (person, department, or phone number).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>AI Implementation Hint</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">connect_call</span></code> tool creates a new outgoing call and bridges it with the current call. The <code class="docutils literal notranslate"><span class="pre">source.type</span></code> determines the caller ID shown to the destination. For PSTN transfers, use <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">&quot;tel&quot;</span></code> with an E.164 phone number (e.g., <code class="docutils literal notranslate"><span class="pre">+15551234567</span></code>). For internal transfers, use <code class="docutils literal notranslate"><span class="pre">type:</span> <span class="pre">&quot;extension&quot;</span></code> with the extension name.</p>
</div>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Caller requests a transfer: “transfer me to…”, “connect me to…”</p></li>
<li><p>Caller wants to speak to a person: “let me talk to a human”, “I need an agent”</p></li>
<li><p>Caller requests a specific department: “sales”, “support”, “billing”</p></li>
<li><p>Caller provides a phone number: “call +1234567890”</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to speak after connecting. Set false for silent transfer.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;agent, conference, extension, sip, or tel&quot;</span> <span class="p">},</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Source address/identifier&quot;</span> <span class="p">},</span>
                <span class="s2">&quot;target_name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Display name (optional)&quot;</span> <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;agent, conference, extension, line, sip, tel&quot;</span> <span class="p">},</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Destination address&quot;</span> <span class="p">},</span>
                    <span class="s2">&quot;target_name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Display name (optional)&quot;</span> <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;destinations&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Transfer me to sales&quot;</span>      <span class="o">-&gt;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;extension&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span>
<span class="s2">&quot;Call my wife at 555-1234&quot;</span>  <span class="o">-&gt;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;tel&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;+15551234&quot;</span>
<span class="s2">&quot;I need a human agent&quot;</span>      <span class="o">-&gt;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;agent&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">appropriate</span> <span class="n">agent</span>
</pre></div>
</div>
</section>
<section id="send-email">
<span id="ai-struct-tool-send-email"></span><h2>send_email<a class="headerlink" href="#send-email" title="Link to this heading"></a></h2>
<p>Sends an email to one or more email addresses.</p>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Caller explicitly requests email: “email me”, “send me an email”</p></li>
<li><p>Caller asks for documents to be emailed</p></li>
<li><p>Caller provides an email address for receiving information</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to confirm verbally after sending.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">]</span> <span class="p">},</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Email address&quot;</span> <span class="p">},</span>
                    <span class="s2">&quot;target_name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Recipient name (optional)&quot;</span> <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;subject&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Email subject line&quot;</span> <span class="p">},</span>
        <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Email body content&quot;</span> <span class="p">},</span>
        <span class="s2">&quot;attachments&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;reference_type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;recording&quot;</span><span class="p">]</span> <span class="p">},</span>
                    <span class="s2">&quot;reference_id&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;UUID of the attachment&quot;</span> <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;destinations&quot;</span><span class="p">,</span> <span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="send-message">
<span id="ai-struct-tool-send-message"></span><h2>send_message<a class="headerlink" href="#send-message" title="Link to this heading"></a></h2>
<p>Sends an SMS text message to a phone number.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>AI Implementation Hint</strong></p>
<p>Phone numbers in <code class="docutils literal notranslate"><span class="pre">source.target</span></code> and <code class="docutils literal notranslate"><span class="pre">destinations[].target</span></code> must be in E.164 format (e.g., <code class="docutils literal notranslate"><span class="pre">+15551234567</span></code>). If the user provides a local number like <code class="docutils literal notranslate"><span class="pre">555-1234</span></code>, the LLM must normalize it to E.164 before invoking this tool. The <code class="docutils literal notranslate"><span class="pre">source</span></code> phone number must be a number owned by your VoIPBIN account (obtainable via <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/numbers</span></code>).</p>
</div>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Caller explicitly requests a text: “text me”, “send me a text”, “SMS me”</p></li>
<li><p>Caller asks for information sent to their phone</p></li>
<li><p>Caller provides a phone number for messaging</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to confirm verbally after sending.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tel&quot;</span><span class="p">]</span> <span class="p">},</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Source phone number (+E.164)&quot;</span> <span class="p">},</span>
                <span class="s2">&quot;target_name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Display name (optional)&quot;</span> <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
            <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tel&quot;</span><span class="p">]</span> <span class="p">},</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Destination phone number (+E.164)&quot;</span> <span class="p">},</span>
                    <span class="s2">&quot;target_name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Recipient name (optional)&quot;</span> <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;SMS message content&quot;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;destinations&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="stop-media">
<span id="ai-struct-tool-stop-media"></span><h2>stop_media<a class="headerlink" href="#stop-media" title="Link to this heading"></a></h2>
<p>Stops media from a previous action that is currently playing on the call.</p>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>AI has finished loading and needs to stop hold music or greeting</p></li>
<li><p>Previous flow action’s media playback should stop before AI speaks</p></li>
<li><p>Transitioning from pre-recorded media to live AI conversation</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to speak after stopping media.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Comparison with other stop tools:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------------+------------------------------------------+</span>
<span class="o">|</span> <span class="n">Tool</span>        <span class="o">|</span> <span class="n">Effect</span>                                   <span class="o">|</span>
<span class="o">+=============+==========================================+</span>
<span class="o">|</span> <span class="n">stop_media</span>  <span class="o">|</span> <span class="n">Stop</span> <span class="n">previous</span> <span class="n">action</span><span class="s1">&#39;s media playback    |</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">AI</span> <span class="n">conversation</span> <span class="n">continues</span>                <span class="o">|</span>
<span class="o">+-------------+------------------------------------------+</span>
<span class="o">|</span> <span class="n">stop_service</span><span class="o">|</span> <span class="n">End</span> <span class="n">AI</span> <span class="n">conversation</span>                      <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">Flow</span> <span class="n">continues</span> <span class="n">to</span> <span class="nb">next</span> <span class="n">action</span>            <span class="o">|</span>
<span class="o">+-------------+------------------------------------------+</span>
<span class="o">|</span> <span class="n">stop_flow</span>   <span class="o">|</span> <span class="n">Terminate</span> <span class="n">everything</span>                     <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">Call</span> <span class="n">ends</span><span class="p">,</span> <span class="n">no</span> <span class="n">further</span> <span class="n">actions</span>            <span class="o">|</span>
<span class="o">+-------------+------------------------------------------+</span>
</pre></div>
</div>
</section>
<section id="stop-service">
<span id="ai-struct-tool-stop-service"></span><h2>stop_service<a class="headerlink" href="#stop-service" title="Link to this heading"></a></h2>
<p>Ends the AI conversation and proceeds to the next action in the flow.</p>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Caller says goodbye: “bye”, “goodbye”, “thanks, that’s all”</p></li>
<li><p>Caller indicates they’re done: “I’m all set”, “that’s everything”</p></li>
<li><p>AI has successfully completed its purpose (appointment booked, issue resolved)</p></li>
<li><p>Natural conversation conclusion</p></li>
</ul>
<p><strong>When NOT to use:</strong></p>
<ul class="simple">
<li><p>Caller is frustrated but still needs help (de-escalate instead)</p></li>
<li><p>Conversation has unresolved issues</p></li>
<li><p>Caller wants to end the entire call (use stop_flow instead)</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Thanks, bye!&quot;</span>                 <span class="o">-&gt;</span> <span class="n">stop_service</span> <span class="p">(</span><span class="n">natural</span> <span class="n">end</span><span class="p">)</span>
<span class="s2">&quot;I&#39;m done here&quot;</span>                <span class="o">-&gt;</span> <span class="n">stop_service</span> <span class="p">(</span><span class="n">completion</span> <span class="n">signal</span><span class="p">)</span>
<span class="n">After</span> <span class="n">booking</span> <span class="n">appointment</span>      <span class="o">-&gt;</span> <span class="n">stop_service</span> <span class="p">(</span><span class="n">task</span> <span class="n">complete</span><span class="p">)</span>
<span class="s2">&quot;Great, that&#39;s all I needed&quot;</span>   <span class="o">-&gt;</span> <span class="n">stop_service</span>
</pre></div>
</div>
</section>
<section id="stop-flow">
<span id="ai-struct-tool-stop-flow"></span><h2>stop_flow<a class="headerlink" href="#stop-flow" title="Link to this heading"></a></h2>
<p>Immediately terminates the entire flow and call. Nothing executes after this.</p>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Caller explicitly wants to end everything: “hang up”, “end the call”, “disconnect”</p></li>
<li><p>Critical error requiring full termination</p></li>
<li><p>Emergency stop needed</p></li>
</ul>
<p><strong>When NOT to use:</strong></p>
<ul class="simple">
<li><p>Caller just wants to end AI conversation (use stop_service instead)</p></li>
<li><p>Caller says casual goodbye (use stop_service instead)</p></li>
<li><p>There are more flow actions that should execute after AI</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Hang up now&quot;</span>                  <span class="o">-&gt;</span> <span class="n">stop_flow</span>
<span class="s2">&quot;End this call immediately&quot;</span>    <span class="o">-&gt;</span> <span class="n">stop_flow</span>
<span class="s2">&quot;Terminate the call&quot;</span>           <span class="o">-&gt;</span> <span class="n">stop_flow</span>
</pre></div>
</div>
</section>
<section id="set-variables">
<span id="ai-struct-tool-set-variables"></span><h2>set_variables<a class="headerlink" href="#set-variables" title="Link to this heading"></a></h2>
<p>Saves key-value data to the flow context for later use by downstream actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>AI Implementation Hint</strong></p>
<p>Variables set via <code class="docutils literal notranslate"><span class="pre">set_variables</span></code> are accessible in subsequent flow actions using the <code class="docutils literal notranslate"><span class="pre">${variable_name}</span></code> syntax. Variable names are case-sensitive strings. Values are always stored as strings. These variables persist for the duration of the flow execution and are included in webhook events.</p>
</div>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Save information collected during conversation (name, account number, preferences)</p></li>
<li><p>Record conclusions (appointment time, issue category, resolution)</p></li>
<li><p>Store data needed by subsequent flow actions</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to continue conversation after saving.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Key-value pairs to save&quot;</span><span class="p">,</span>
            <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;variables&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;My name is John Smith&quot;</span>        <span class="o">-&gt;</span> <span class="n">set_variables</span><span class="p">({</span><span class="s2">&quot;customer_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Smith&quot;</span><span class="p">})</span>
<span class="s2">&quot;3pm works for me&quot;</span>             <span class="o">-&gt;</span> <span class="n">set_variables</span><span class="p">({</span><span class="s2">&quot;appointment_time&quot;</span><span class="p">:</span> <span class="s2">&quot;15:00&quot;</span><span class="p">})</span>
<span class="n">Issue</span> <span class="n">categorized</span> <span class="k">as</span> <span class="n">billing</span>   <span class="o">-&gt;</span> <span class="n">set_variables</span><span class="p">({</span><span class="s2">&quot;issue_category&quot;</span><span class="p">:</span> <span class="s2">&quot;billing&quot;</span><span class="p">})</span>
<span class="n">Account</span> <span class="n">number</span> <span class="n">provided</span>        <span class="o">-&gt;</span> <span class="n">set_variables</span><span class="p">({</span><span class="s2">&quot;account_number&quot;</span><span class="p">:</span> <span class="s2">&quot;12345&quot;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="get-variables">
<span id="ai-struct-tool-get-variables"></span><h2>get_variables<a class="headerlink" href="#get-variables" title="Link to this heading"></a></h2>
<p>Retrieves previously saved variables from the flow context.</p>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Need context set earlier in the flow</p></li>
<li><p>Need information from previous actions (confirmation number, customer info)</p></li>
<li><p>Caller asks about something in saved context</p></li>
<li><p>Before performing an action requiring previously collected data</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to respond using retrieved data.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Need</span> <span class="n">customer</span> <span class="n">name</span> <span class="kn">from</span><span class="w"> </span><span class="nn">earlier</span> <span class="o">-&gt;</span> <span class="n">get_variables</span>
<span class="s2">&quot;What was my confirmation?&quot;</span>     <span class="o">-&gt;</span> <span class="n">get_variables</span>
<span class="n">Before</span> <span class="n">sending</span> <span class="n">SMS</span>              <span class="o">-&gt;</span> <span class="n">get_variables</span> <span class="p">(</span><span class="n">to</span> <span class="n">get</span> <span class="n">phone</span> <span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-aicall-messages">
<span id="ai-struct-tool-get-aicall-messages"></span><h2>get_aicall_messages<a class="headerlink" href="#get-aicall-messages" title="Link to this heading"></a></h2>
<p>Retrieves message history from a specific AI call session.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>AI Implementation Hint</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">aicall_id</span></code> (UUID) must reference a completed or active AI call session. You can obtain this ID from the <code class="docutils literal notranslate"><span class="pre">${voipbin.aicall.id}</span></code> flow variable during the current call, or from a previous call’s webhook event data. This tool is most useful for multi-call workflows where AI needs context from a prior conversation.</p>
</div>
<p><strong>When to use:</strong></p>
<ul class="simple">
<li><p>Need message history from a different AI call (not current conversation)</p></li>
<li><p>Building summaries of past conversations</p></li>
<li><p>Caller asks about previous interactions: “what did we discuss last time?”</p></li>
<li><p>Referencing a specific past call by ID</p></li>
</ul>
<p><strong>When NOT to use:</strong></p>
<ul class="simple">
<li><p>Current conversation history is sufficient (already in AI context)</p></li>
<li><p>Need saved variables, not messages (use get_variables instead)</p></li>
<li><p>No specific aicall_id to query</p></li>
</ul>
<p><strong>Parameters:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Set true to respond based on retrieved messages.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">},</span>
        <span class="s2">&quot;aicall_id&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;UUID of the AI call to retrieve messages from&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aicall_id&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="run-llm-parameter">
<h2>run_llm Parameter<a class="headerlink" href="#run-llm-parameter" title="Link to this heading"></a></h2>
<p>Most tools include a <code class="docutils literal notranslate"><span class="pre">run_llm</span></code> parameter that controls whether the AI should generate a response after the tool executes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------------------+--------------------------------------------------+</span>
<span class="o">|</span> <span class="n">run_llm</span> <span class="o">=</span> <span class="n">true</span>    <span class="o">|</span> <span class="n">AI</span> <span class="n">speaks</span> <span class="n">after</span> <span class="n">tool</span> <span class="n">execution</span>                   <span class="o">|</span>
<span class="o">|</span>                   <span class="o">|</span> <span class="n">Example</span><span class="p">:</span> <span class="s2">&quot;I&#39;ve sent that to your email&quot;</span>          <span class="o">|</span>
<span class="o">+-------------------+--------------------------------------------------+</span>
<span class="o">|</span> <span class="n">run_llm</span> <span class="o">=</span> <span class="n">false</span>   <span class="o">|</span> <span class="n">Tool</span> <span class="n">executes</span> <span class="n">silently</span>                           <span class="o">|</span>
<span class="o">|</span>                   <span class="o">|</span> <span class="n">Useful</span> <span class="k">for</span> <span class="n">chaining</span> <span class="n">multiple</span> <span class="n">tools</span>               <span class="o">|</span>
<span class="o">+-------------------+--------------------------------------------------+</span>
</pre></div>
</div>
<p><strong>Default:</strong> Most tools default to <code class="docutils literal notranslate"><span class="pre">run_llm</span> <span class="pre">=</span> <span class="pre">false</span></code> for silent execution.</p>
</section>
<section id="tool-execution-flow">
<h2>Tool Execution Flow<a class="headerlink" href="#tool-execution-flow" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">Tool</span> <span class="n">Execution</span> <span class="n">Architecture</span>                   <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------+</span>

<span class="n">Caller</span> <span class="n">speaks</span>          <span class="n">Python</span> <span class="n">Pipecat</span>              <span class="n">Go</span> <span class="n">AIcallHandler</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>  <span class="s2">&quot;Transfer me to     |                            |</span>
     <span class="o">|</span>   <span class="n">sales</span> <span class="n">please</span><span class="s2">&quot;      |                            |</span>
     <span class="o">+---------------------&gt;|</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>               <span class="n">STT</span> <span class="n">converts</span>                        <span class="o">|</span>
     <span class="o">|</span>               <span class="n">to</span> <span class="n">text</span>                             <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>               <span class="n">LLM</span> <span class="n">detects</span> <span class="n">intent</span>                  <span class="o">|</span>
     <span class="o">|</span>               <span class="n">function_call</span><span class="p">:</span> <span class="n">connect_call</span>         <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>  <span class="n">HTTP</span> <span class="n">POST</span>                 <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>  <span class="o">/</span><span class="n">tool</span><span class="o">/</span><span class="n">execute</span>             <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">+---------------------------&gt;|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>             <span class="n">Execute</span> <span class="n">tool</span>   <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>             <span class="p">(</span><span class="n">call</span><span class="o">-</span><span class="n">manager</span><span class="p">)</span> <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>  <span class="n">Tool</span> <span class="n">result</span>               <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|&lt;---------------------------+</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>               <span class="n">LLM</span> <span class="n">generates</span>                       <span class="o">|</span>
     <span class="o">|</span>               <span class="n">response</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
     <span class="o">|</span>  <span class="n">TTS</span><span class="p">:</span> <span class="s2">&quot;Connecting    |                            |</span>
     <span class="o">|</span>   <span class="n">you</span> <span class="n">to</span> <span class="n">sales</span> <span class="n">now</span><span class="s2">&quot;  |                            |</span>
     <span class="o">|&lt;---------------------+</span>                            <span class="o">|</span>
     <span class="o">|</span>                      <span class="o">|</span>                            <span class="o">|</span>
</pre></div>
</div>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<p><strong>1. Enable only needed tools</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Good</span><span class="p">:</span> <span class="n">Only</span> <span class="n">enable</span> <span class="n">tools</span> <span class="n">the</span> <span class="n">AI</span> <span class="n">actually</span> <span class="n">needs</span>
<span class="s2">&quot;tool_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;connect_call&quot;</span><span class="p">,</span> <span class="s2">&quot;stop_service&quot;</span><span class="p">]</span>

<span class="o">//</span> <span class="n">Avoid</span><span class="p">:</span> <span class="n">Enabling</span> <span class="nb">all</span> <span class="n">tools</span> <span class="n">when</span> <span class="n">only</span> <span class="n">some</span> <span class="n">are</span> <span class="n">needed</span>
<span class="s2">&quot;tool_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>2. Use stop_service vs stop_flow correctly</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stop_service</span> <span class="o">=</span> <span class="n">Soft</span> <span class="n">stop</span> <span class="p">(</span><span class="n">AI</span> <span class="n">ends</span><span class="p">,</span> <span class="n">flow</span> <span class="n">continues</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">User</span> <span class="n">says</span> <span class="s2">&quot;goodbye&quot;</span>
    <span class="o">-</span> <span class="n">Task</span> <span class="n">completed</span> <span class="n">successfully</span>

<span class="n">stop_flow</span> <span class="o">=</span> <span class="n">Hard</span> <span class="n">stop</span> <span class="p">(</span><span class="n">everything</span> <span class="n">ends</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">User</span> <span class="n">says</span> <span class="s2">&quot;hang up&quot;</span>
    <span class="o">-</span> <span class="n">Critical</span> <span class="n">error</span>
</pre></div>
</div>
<p><strong>3. Clarify ambiguous requests</strong></p>
<p>When a user says “send me that information,” the AI should ask:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Would you like that by email or text message?&quot;</span>
</pre></div>
</div>
<p>This ensures the correct tool (send_email vs send_message) is used.</p>
<p><strong>4. Use run_llm appropriately</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Silent</span> <span class="n">operations</span> <span class="p">(</span><span class="n">chaining</span> <span class="n">tools</span><span class="p">)</span>
<span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="n">false</span>

<span class="o">//</span> <span class="n">User</span><span class="o">-</span><span class="n">facing</span> <span class="n">confirmations</span>
<span class="s2">&quot;run_llm&quot;</span><span class="p">:</span> <span class="n">true</span>  <span class="o">-&gt;</span> <span class="s2">&quot;I&#39;ve connected you to the sales department&quot;</span>
</pre></div>
</div>
</section>
</section>

</main>
                        
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Tool Functions</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#available-tools">Available Tools</a></li>
<li><a class="reference internal" href="#connect-call">connect_call</a></li>
<li><a class="reference internal" href="#send-email">send_email</a></li>
<li><a class="reference internal" href="#send-message">send_message</a></li>
<li><a class="reference internal" href="#stop-media">stop_media</a></li>
<li><a class="reference internal" href="#stop-service">stop_service</a></li>
<li><a class="reference internal" href="#stop-flow">stop_flow</a></li>
<li><a class="reference internal" href="#set-variables">set_variables</a></li>
<li><a class="reference internal" href="#get-variables">get_variables</a></li>
<li><a class="reference internal" href="#get-aicall-messages">get_aicall_messages</a></li>
<li><a class="reference internal" href="#run-llm-parameter">run_llm Parameter</a></li>
<li><a class="reference internal" href="#tool-execution-flow">Tool Execution Flow</a></li>
<li><a class="reference internal" href="#best-practices">Best Practices</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">About Us</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">Contact</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2026, VoIPBIN
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a class="text-white" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.5.0
                    </a>
                    and
                    <a class="text-white" href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 9.1.0
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=fd6eb6e6"></script>
        <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script type="text/javascript" src="_static/dist/theme.js"></script>
        <script type="text/javascript" src="_static/dist/vendor.js"></script>
        <script type="text/javascript" src="_static/searchtools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>