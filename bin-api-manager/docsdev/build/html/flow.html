<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Flow &mdash; voipbin  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8e8a900e" />
      <link rel="stylesheet" type="text/css" href="_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="voipbin  documentation" href="#" />
            <link rel="next" title="Variable" href="variable.html" />
            <link rel="prev" title="RESTful API(Application Programming Interface)" href="restful_api.html" />
    </head>
<body>
    <script type="text/javascript" src="_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="intro.html"
                        title="voipbin"
                        class="logo navbar-brand"
                    >
                        <img src="_static/images/voipbin-high-resolution-logo-white-transparent.png" width="45" height="80" alt="voipbin"
                            class="logo-img"
                        />
                        VoIPBin Documentation
                    </a>
                
                
                    <div class="collapse navbar-collapse justify-content-end">
                        <ul class="navbar-nav">
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="http://voipbin.net">Project</a></li>
                            
                                
                                
                                <li class="nav-item"><a class="nav-link"  href="https://admin.voipbin.net">Admin</a></li>
                            
                        </ul>
                    </div>
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="accesskey.html">Accesskey</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk.html">SDK(Software Development Kit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="restful_api.html">RESTful API(Application Programming Interface)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="#activeflow">Activeflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variable</a></li>
<li class="toctree-l1"><a class="reference internal" href="webhook.html">Webhook</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Voice &amp; Real-Time</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="call.html">Call</a></li>
<li class="toctree-l1"><a class="reference internal" href="conference.html">Conference</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue.html">Queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="recording.html">Recording</a></li>
<li class="toctree-l1"><a class="reference internal" href="transcribe.html">Transcribe</a></li>
<li class="toctree-l1"><a class="reference internal" href="mediastream.html">Mediastream</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Messaging</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="message.html">Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.html">Email</a></li>
<li class="toctree-l1"><a class="reference internal" href="chat.html">Chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="conversation.html">Conversation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI &amp; Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ai.html">AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="campaign.html">Campaign</a></li>
<li class="toctree-l1"><a class="reference internal" href="outdial.html">Outdial</a></li>
<li class="toctree-l1"><a class="reference internal" href="outplan.html">Outplan</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources &amp; Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="number.html">Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html">Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="customer.html">Customer</a></li>
<li class="toctree-l1"><a class="reference internal" href="billing_account.html">Billing Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="tag.html">Tag</a></li>
<li class="toctree-l1"><a class="reference internal" href="provider.html">Provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="route.html">Route</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension.html">Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="trunk.html">Trunk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Architecture (Deep Dive)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="websocket.html">Websocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="talk.html">Talk</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Flow</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="_sources/flow.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="flow">
<span id="flow-main"></span><h1>Flow<a class="headerlink" href="#flow" title="Link to this heading"></a></h1>
<section id="overview">
<span id="flow-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The Flow in VoIPBIN is a powerful set of instructions that guides the platform on how to handle incoming calls. When someone calls one of your VoIPBIN numbers or destinations, the platform looks up the associated URL and sends a request. The Flow instructions are then read to determine the appropriate actions to be taken, such as recording the call, playing a message, or prompting the caller to press digits on their keypad.</p>
<p>At its core, the Flow is an array of JSON objects with special tags defined by VoIPBIN, enabling users to build their own Programmable Voice applications.</p>
<section id="how-the-flow-works">
<span id="flow-overview-how-the-flow-works"></span><h3>How the flow works<a class="headerlink" href="#how-the-flow-works" title="Link to this heading"></a></h3>
<p>When an incoming call is received on one of your VoIPBIN numbers or destinations, the platform identifies the associated URL and sends a request.</p>
<p>The Flow instructions are then processed, providing a step-by-step guide on how to handle the call. This might involve greeting the caller, presenting options, gathering input, or executing various actions based on the caller’s response.</p>
</section>
<section id="understanding-flow-execution">
<h3>Understanding Flow Execution<a class="headerlink" href="#understanding-flow-execution" title="Link to this heading"></a></h3>
<p>Think of a Flow like a recipe. Each action is a step, and VoIPBIN follows the steps one by one until the recipe is complete.</p>
<p><strong>The Execution Cursor</strong></p>
<p>VoIPBIN uses a “cursor” to track where it is in the flow - like a finger pointing at the current step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span> <span class="n">Actions</span> <span class="n">Array</span><span class="p">:</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
<span class="o">|</span> <span class="n">answer</span>  <span class="o">|--&gt;|</span>  <span class="n">talk</span>   <span class="o">|--&gt;|</span> <span class="n">digits</span>  <span class="o">|--&gt;|</span> <span class="n">branch</span>  <span class="o">|--&gt;|</span> <span class="n">hangup</span>  <span class="o">|</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
                   <span class="o">^</span>
                   <span class="o">|</span>
                <span class="n">cursor</span>
              <span class="p">(</span><span class="n">current</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
<p>As each action completes, the cursor moves to the next one. When the cursor reaches the end, the flow is complete.</p>
<p><strong>What Happens During Execution</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+---------------------------------------------------------------------+
|                    Flow Execution Engine                            |
+---------------------------------------------------------------------+
                                |
                                v
                       +---------------+
                       |  Get next     |
                       |  action       |
                       +-------+-------+
                               |
                               v
                       +---------------+
                  +----|  End of flow? |----+
                  |yes +---------------+ no |
                  |                         |
                  v                         v
           +------------+          +----------------+
           |   Stop     |          | Execute action |
           |  (done)    |          +-------+--------+
           +------------+                  |
                                           v
                                +---------------------+
                                | What kind of result?|
                                +----------+----------+
                                           |
                    +----------------------+----------------------+
                    |                      |                      |
                    v                      v                      v
             +------------+         +------------+         +------------+
             |   Next     |         |   Wait     |         |   Block    |
             | (continue) |         | (external) |         |  (pause)   |
             +-----+------+         +------------+         +------------+
                   |
                   | loop back
                   +----------------------------------------------&gt;
</pre></div>
</div>
</section>
<section id="action-execution-patterns">
<h3>Action Execution Patterns<a class="headerlink" href="#action-execution-patterns" title="Link to this heading"></a></h3>
<p>Actions behave differently depending on their type. Understanding these patterns helps you predict flow behavior.</p>
<p><strong>Immediate Actions (Execute and Continue)</strong></p>
<p>These actions complete instantly and the cursor moves to the next action:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+----------+</span>     <span class="o">+----------+</span>
<span class="o">|</span>  <span class="n">goto</span>    <span class="o">|----&gt;|</span>  <span class="n">branch</span>  <span class="o">|----&gt;|</span> <span class="n">variable</span> <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">+----------+</span>     <span class="o">+----------+</span>
     <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
     <span class="o">+----------------+----------------+</span>
                      <span class="o">|</span>
               <span class="n">Cursor</span> <span class="n">moves</span> <span class="n">immediately</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">goto</span></code>, <code class="docutils literal notranslate"><span class="pre">branch</span></code>, <code class="docutils literal notranslate"><span class="pre">variable_set</span></code>, <code class="docutils literal notranslate"><span class="pre">condition_variable</span></code></p>
<p><strong>Media Actions (Wait for Completion)</strong></p>
<p>These actions take time and the flow waits for them to finish:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+------------------------------+</span>     <span class="o">+----------+</span>
<span class="o">|</span>  <span class="n">talk</span>    <span class="o">|----&gt;|</span>  <span class="n">Playing</span> <span class="s2">&quot;Welcome to...&quot;</span>     <span class="o">|----&gt;|</span>  <span class="nb">next</span>    <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">|</span>  <span class="p">(</span><span class="n">audio</span> <span class="n">playing</span><span class="p">,</span> <span class="n">please</span> <span class="n">wait</span><span class="p">)</span><span class="o">|</span>     <span class="o">|</span>  <span class="n">action</span>  <span class="o">|</span>
                 <span class="o">+------------------------------+</span>     <span class="o">+----------+</span>
                              <span class="o">|</span>
                    <span class="n">Cursor</span> <span class="n">waits</span> <span class="n">here</span> <span class="n">until</span>
                    <span class="n">audio</span> <span class="n">finishes</span> <span class="n">playing</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">talk</span></code>, <code class="docutils literal notranslate"><span class="pre">play</span></code>, <code class="docutils literal notranslate"><span class="pre">digits_receive</span></code>, <code class="docutils literal notranslate"><span class="pre">recording_start</span></code></p>
<p><strong>Fire-and-Forget Actions (Dispatch and Continue)</strong></p>
<p>These actions send something out but don’t wait for a response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+------------+     +--------------------+
| email_send |----&gt;| Email dispatched!  |----&gt; Continue immediately
+------------+     | (delivery is async)|
                   +--------------------+
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">message_send</span></code>, <code class="docutils literal notranslate"><span class="pre">email_send</span></code>, <code class="docutils literal notranslate"><span class="pre">webhook_send</span></code></p>
<p><strong>Blocking Actions (Pause Until Triggered)</strong></p>
<p>These actions pause the flow until something external happens:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+</span>     <span class="o">+------------------------------+</span>
<span class="o">|</span>  <span class="n">block</span>   <span class="o">|----&gt;|</span>  <span class="n">Flow</span> <span class="ow">is</span> <span class="n">paused</span><span class="o">...</span>           <span class="o">|</span>
<span class="o">+----------+</span>     <span class="o">|</span>  <span class="n">Waiting</span> <span class="k">for</span> <span class="n">API</span> <span class="n">call</span> <span class="n">to</span>     <span class="o">|</span>
                 <span class="o">|</span>  <span class="n">resume</span> <span class="n">execution</span>            <span class="o">|</span>
                 <span class="o">+------------------------------+</span>
                              <span class="o">|</span>
                 <span class="n">Call</span> <span class="n">POST</span> <span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">execute</span>
                              <span class="o">|</span>
                              <span class="n">v</span>
                 <span class="o">+------------------------------+</span>
                 <span class="o">|</span>  <span class="n">Flow</span> <span class="n">resumes</span><span class="p">,</span> <span class="n">cursor</span> <span class="n">moves</span>  <span class="o">|</span>
                 <span class="o">+------------------------------+</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">block</span></code></p>
<p><strong>Nested Actions (Push a Stack)</strong></p>
<p>Some actions start a sub-flow that runs inside the main flow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span> <span class="n">Flow</span><span class="p">:</span>                                <span class="n">Nested</span> <span class="n">Stack</span> <span class="p">(</span><span class="kn">from</span><span class="w"> </span><span class="nn">queue_join</span><span class="p">):</span>
<span class="o">+--------+</span>  <span class="o">+------------+</span>               <span class="o">+-----------------------------+</span>
<span class="o">|</span> <span class="n">answer</span> <span class="o">|-&gt;|</span> <span class="n">queue_join</span> <span class="o">|--------------&gt;|</span> <span class="n">wait_flow</span> <span class="n">actions</span><span class="o">...</span>        <span class="o">|</span>
<span class="o">+--------+</span>  <span class="o">+------------+</span>               <span class="o">|</span> <span class="p">(</span><span class="n">talk</span><span class="p">,</span> <span class="n">play</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span>          <span class="o">|</span>
                  <span class="o">^</span>                      <span class="o">+-------------+---------------+</span>
                  <span class="o">|</span>                                    <span class="o">|</span>
                  <span class="o">|</span>      <span class="n">When</span> <span class="n">agent</span> <span class="n">answers</span> <span class="ow">or</span>         <span class="o">|</span>
                  <span class="o">|</span>      <span class="n">caller</span> <span class="n">hangs</span> <span class="n">up</span>               <span class="o">|</span>
                  <span class="o">+------------------------------------+</span>
                          <span class="n">Return</span> <span class="n">to</span> <span class="n">main</span> <span class="n">flow</span>
</pre></div>
</div>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">queue_join</span></code>, <code class="docutils literal notranslate"><span class="pre">ai_talk</span></code>, <code class="docutils literal notranslate"><span class="pre">conference_join</span></code>, <code class="docutils literal notranslate"><span class="pre">fetch_flow</span></code></p>
</section>
<section id="branching-and-decision-making">
<h3>Branching and Decision Making<a class="headerlink" href="#branching-and-decision-making" title="Link to this heading"></a></h3>
<p>Flows can make decisions and take different paths based on conditions.</p>
<p><strong>The Branch Action</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">branch</span></code> action reads a variable and jumps to different actions based on its value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------------------------+
|                         Branch Decision                              |
+----------------------------------------------------------------------+

                          Variable value?
                                |
                +---------------+---------------+
                |               |               |
                v               v               v
              &quot;1&quot;             &quot;2&quot;           (default)
                |               |               |
                v               v               v
        +------------+  +------------+  +------------+
        |  Sales     |  |  Support   |  |  Operator  |
        |  menu      |  |  menu      |  |  (fallback)|
        +------------+  +------------+  +------------+
</pre></div>
</div>
<p><strong>How Variables Get Set</strong></p>
<p>Variables are set by previous actions and then read by branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Step</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Collect</span> <span class="nb">input</span>
<span class="o">+-----------------+</span>
<span class="o">|</span> <span class="n">digits_receive</span>  <span class="o">|</span>  <span class="o">--&gt;</span>  <span class="n">User</span> <span class="n">presses</span> <span class="s2">&quot;2&quot;</span>
<span class="o">+-----------------+</span>       <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>

<span class="n">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Branch</span> <span class="n">based</span> <span class="n">on</span> <span class="nb">input</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>     <span class="n">branch</span>      <span class="o">|</span>  <span class="o">--&gt;</span>  <span class="n">Read</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span>
<span class="o">|</span>                 <span class="o">|</span>       <span class="n">Value</span> <span class="ow">is</span> <span class="s2">&quot;2&quot;</span>
<span class="o">|</span> <span class="n">variable</span><span class="p">:</span>       <span class="o">|</span>       <span class="n">Jump</span> <span class="n">to</span> <span class="n">Support</span> <span class="n">menu</span>
<span class="o">|</span>  <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="n">digits</span>         <span class="o">|</span>
<span class="o">+-----------------+</span>
</pre></div>
</div>
<p><strong>Condition Actions</strong></p>
<p>For more complex logic, use condition actions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>condition_variable:
+-------------------------------------------------------------------+
|  IF ${customer.tier} equals &quot;premium&quot;                             |
|     → Continue to next action (VIP treatment)                     |
|  ELSE                                                             |
|     → Jump to false_target_id (standard treatment)                |
+-------------------------------------------------------------------+
</pre></div>
</div>
<p>Available conditions:
- <code class="docutils literal notranslate"><span class="pre">equal</span></code>, <code class="docutils literal notranslate"><span class="pre">not_equal</span></code>
- <code class="docutils literal notranslate"><span class="pre">greater</span></code>, <code class="docutils literal notranslate"><span class="pre">less</span></code>
- <code class="docutils literal notranslate"><span class="pre">greater_equal</span></code>, <code class="docutils literal notranslate"><span class="pre">less_equal</span></code></p>
</section>
<section id="the-variable-system">
<h3>The Variable System<a class="headerlink" href="#the-variable-system" title="Link to this heading"></a></h3>
<p>Variables store information during flow execution. They’re like sticky notes that actions can write and read.</p>
<p><strong>Built-in Variables</strong></p>
<p>VoIPBIN automatically creates these variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">Built</span><span class="o">-</span><span class="ow">in</span> <span class="n">Variables</span>                           <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">id</span>           <span class="o">|</span> <span class="n">Current</span> <span class="n">activeflow</span> <span class="n">ID</span>         <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">reference_id</span> <span class="o">|</span> <span class="n">The</span> <span class="n">call</span><span class="o">/</span><span class="n">conversation</span> <span class="n">ID</span>      <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span>             <span class="o">|</span> <span class="n">DTMF</span> <span class="n">digits</span> <span class="n">received</span>          <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">caller_id</span>          <span class="o">|</span> <span class="n">Caller</span><span class="s1">&#39;s phone number         |</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">text</span>            <span class="o">|</span> <span class="n">Received</span> <span class="n">message</span> <span class="n">content</span>      <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">recording</span><span class="o">.</span><span class="n">id</span>            <span class="o">|</span> <span class="n">Current</span> <span class="n">recording</span> <span class="n">ID</span>          <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------+</span>
</pre></div>
</div>
<p><strong>Custom Variables</strong></p>
<p>You can set your own variables with the <code class="docutils literal notranslate"><span class="pre">variable_set</span></code> action:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;variable_set&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;customer.language&quot;</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Using Variables in Actions</strong></p>
<p>Variables are substituted using <code class="docutils literal notranslate"><span class="pre">${variable.name}</span></code> syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello $</span><span class="si">{customer.name}</span><span class="s2">, welcome back!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;$</span><span class="si">{customer.language}</span><span class="s2">&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Before this action executes, VoIPBIN replaces the placeholders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span><span class="p">:</span> <span class="s2">&quot;Hello $</span><span class="si">{customer.name}</span><span class="s2">, welcome back!&quot;</span>
<span class="n">After</span><span class="p">:</span>  <span class="s2">&quot;Hello John Smith, welcome back!&quot;</span>
</pre></div>
</div>
</section>
<section id="unified-flow">
<span id="flow-overview-unified-flow"></span><h3>Unified flow<a class="headerlink" href="#unified-flow" title="Link to this heading"></a></h3>
<p>VoIPBIN’s Unified Flow feature is a game-changer, allowing users to create a single flow that can be attached to multiple communication channels, including voice and video calls, SMS, and RESTful API triggers.</p>
<p>With Unified Flow, users can design a custom flow that defines the actions to be taken when a specific channel request is received. VoIPBIN then automatically executes this flow, ensuring a consistent experience for customers across various channels.</p>
</section>
<section id="non-linear-action-execution">
<span id="flow-overview-non-linear-action-execution"></span><h3>Non-linear action execution<a class="headerlink" href="#non-linear-action-execution" title="Link to this heading"></a></h3>
<p>VoIPBIN’s Flow provides the flexibility of Non-Linear action execution.</p>
<p>Users can customize their actions in both linear and non-linear ways, allowing them to define complex logic and decision trees to handle various call scenarios.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Linear Execution:
+---+   +---+   +---+   +---+
| 1 |--&gt;| 2 |--&gt;| 3 |--&gt;| 4 |
+---+   +---+   +---+   +---+

Non-Linear Execution (with goto and branch):
+---+   +---+   +---+   +---+
| 1 |--&gt;| 2 |--&gt;| 3 |--&gt;| 4 |
+---+   +-+-+   +---+   +-+-+
          |               |
          |   +-----------+
          |   | (goto back to 2)
          v   v
        +-------+
        | Loop! |
        +-------+
</pre></div>
</div>
<img alt="_images/flow_overview_non_linear.png" src="_images/flow_overview_non_linear.png" />
</section>
<section id="flow-fork">
<span id="flow-overview-flow-fork"></span><h3>Flow fork<a class="headerlink" href="#flow-fork" title="Link to this heading"></a></h3>
<p>Certain flow actions, such as fetch, fetch_flow, queue_join, and more, enable flow forking.</p>
<p>When the flow is forked, the execution cursor moves to the forked flow and starts executing the actions within it. Once the forked flow reaches its end, the execution cursor moves back to the following action of the forking action, continuing the flow execution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span> <span class="n">Flow</span>                         <span class="n">Forked</span> <span class="n">Flow</span> <span class="p">(</span><span class="kn">from</span><span class="w"> </span><span class="nn">queue_join</span><span class="p">)</span>
<span class="o">+---------+</span>                      <span class="o">+---------------------------------+</span>
<span class="o">|</span> <span class="n">answer</span>  <span class="o">|</span>                      <span class="o">|</span>                                 <span class="o">|</span>
<span class="o">+----+----+</span>                      <span class="o">|</span>  <span class="o">+------+</span>   <span class="o">+------+</span>   <span class="o">+------+</span> <span class="o">|</span>
     <span class="o">|</span>                           <span class="o">|</span>  <span class="o">|</span> <span class="n">talk</span> <span class="o">|--&gt;|</span> <span class="n">play</span> <span class="o">|--&gt;|</span> <span class="n">talk</span> <span class="o">|</span> <span class="o">|</span>
     <span class="n">v</span>                           <span class="o">|</span>  <span class="o">+------+</span>   <span class="o">+------+</span>   <span class="o">+------+</span> <span class="o">|</span>
<span class="o">+------------+</span>                   <span class="o">|</span>         <span class="n">Wait</span> <span class="n">Flow</span>               <span class="o">|</span>
<span class="o">|</span> <span class="n">queue_join</span> <span class="o">|==================&gt;+---------------------------------+</span>
<span class="o">+----+-------+</span>                            <span class="o">|</span>
     <span class="o">|</span>                                    <span class="o">|</span> <span class="p">(</span><span class="n">returns</span> <span class="n">when</span> <span class="n">done</span><span class="p">)</span>
     <span class="o">|&lt;===================================+</span>
     <span class="o">|</span>
     <span class="n">v</span>
<span class="o">+----------+</span>
<span class="o">|</span> <span class="k">continue</span> <span class="o">|</span>
<span class="o">+----------+</span>
</pre></div>
</div>
<img alt="_images/flow_overview_fork.png" src="_images/flow_overview_fork.png" />
</section>
<section id="actions">
<span id="flow-overview-actions"></span><h3>Actions<a class="headerlink" href="#actions" title="Link to this heading"></a></h3>
<p>Within VoIPBIN, actions dictate the course of the platform’s response in a given flow, encompassing tasks such as initiating calls, playing sounds or prompts, activating text-to-speech, sending SMS or DTMFs, and dispatching SNS messages. These diverse actions serve as indispensable building blocks for crafting customized voice applications, ensuring the creation of uniquely tailored call experiences for users.</p>
<p>VoIPBIN’s Flow provides developers with a versatile and robust toolkit, empowering them to forge dynamic voice applications, efficiently manage incoming calls, and curate personalized call encounters. Through its non-linear execution, cohesive flow capabilities, and an array of actions including SMS, DTMFs, SNS messages, and more, VoIPBIN’s Flow unveils limitless possibilities for the development of sophisticated and interactive voice applications, precisely tailored to meet specific business needs.</p>
<p><strong>Action Categories</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Actions</p></th>
<th class="head"><p>Behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Media</p></td>
<td><p>talk, play, recording_start, recording_stop</p></td>
<td><p>Wait for completion</p></td>
</tr>
<tr class="row-odd"><td><p>Input</p></td>
<td><p>digits_receive, transcribe_start</p></td>
<td><p>Wait for input</p></td>
</tr>
<tr class="row-even"><td><p>Control</p></td>
<td><p>goto, branch, condition_*, stop, empty</p></td>
<td><p>Immediate</p></td>
</tr>
<tr class="row-odd"><td><p>Communication</p></td>
<td><p>message_send, email_send, webhook_send</p></td>
<td><p>Fire and forget</p></td>
</tr>
<tr class="row-even"><td><p>Nested</p></td>
<td><p>queue_join, ai_talk, conference_join, fetch</p></td>
<td><p>Push stack, return</p></td>
</tr>
<tr class="row-odd"><td><p>Call Control</p></td>
<td><p>answer, hangup, hold, mute, connect, transfer</p></td>
<td><p>Immediate or wait</p></td>
</tr>
</tbody>
</table>
</section>
<section id="flow-execution">
<span id="flow-overview-flow-execution"></span><h3>Flow execution<a class="headerlink" href="#flow-execution" title="Link to this heading"></a></h3>
<p>In VoIPBIN, the execution of flows is versatile and can be initiated through various methods:</p>
<section id="incoming-outgoing-calls">
<h4>Incoming/Outgoing Calls<a class="headerlink" href="#incoming-outgoing-calls" title="Link to this heading"></a></h4>
<p>VoIPBIN facilitates flow execution with both incoming and outgoing calls. Users have the option to register a flow to a specific number. Upon an incoming call to the registered number, VoIPBIN will seamlessly execute the associated flow.
Users can also initiate a call with a predefined flow. Once the outgoing call is answered, the attached flow will be triggered.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Incoming</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">:</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
<span class="o">|</span>  <span class="n">Caller</span> <span class="n">dials</span><span class="o">|-----&gt;|</span>  <span class="n">VoIPBIN</span> <span class="n">looks</span>  <span class="o">|-----&gt;|</span>  <span class="n">Flow</span> <span class="n">starts</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="n">your</span> <span class="n">number</span> <span class="o">|</span>      <span class="o">|</span>  <span class="n">up</span> <span class="n">the</span> <span class="n">number</span>  <span class="o">|</span>      <span class="o">|</span>  <span class="n">executing</span>    <span class="o">|</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>

<span class="n">Outgoing</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">:</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
<span class="o">|</span>  <span class="n">POST</span> <span class="o">/</span><span class="n">calls</span> <span class="o">|-----&gt;|</span>  <span class="n">Call</span> <span class="n">connects</span>  <span class="o">|-----&gt;|</span>  <span class="n">Flow</span> <span class="n">starts</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="k">with</span> <span class="n">actions</span><span class="o">|</span>      <span class="o">|</span>  <span class="p">(</span><span class="n">answered</span><span class="p">)</span>     <span class="o">|</span>      <span class="o">|</span>  <span class="n">executing</span>    <span class="o">|</span>
<span class="o">+--------------+</span>      <span class="o">+-----------------+</span>      <span class="o">+---------------+</span>
</pre></div>
</div>
</section>
<section id="received-messages">
<h4>Received Messages<a class="headerlink" href="#received-messages" title="Link to this heading"></a></h4>
<p>VoIPBIN allows users to register flows to received messages. When a message is received, the registered flow will be executed.
For example, you can register the flow like the below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
  <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin.message.text&quot;</span><span class="p">,</span>
    <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;call me&quot;</span><span class="p">:</span> <span class="s2">&quot;7a1e8c4c-aaea-11ed-9f0f-bffcc31ca3c3&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text me&quot;</span><span class="p">:</span> <span class="s2">&quot;79fd8c9a-aaea-11ed-a238-0b094a49c637&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text developer&quot;</span><span class="p">:</span> <span class="s2">&quot;73107b70-d56b-4b47-b331-dc4f2ac43a5b&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In the provided example, the system examines the content of the received message using <strong>voipbin.message.text</strong> and proceeds to compare the message text.
Should the message text match the specified criterion, such as “call me,” the flow execution cursor will be directed to the designated action ID (7a1e8c4c-aaea-11ed-9f0f-bffcc31ca3c3) for subsequent execution.
See detail about available variables at <a class="reference internal" href="variable.html#variable-main"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="outbound-campaigns">
<h4>Outbound Campaigns<a class="headerlink" href="#outbound-campaigns" title="Link to this heading"></a></h4>
<p>The VoIPBIN platform integrates flows into outbound campaigns, providing a structured and automated approach to execution.</p>
</section>
<section id="api">
<h4>API<a class="headerlink" href="#api" title="Link to this heading"></a></h4>
<p>Users have the flexibility to trigger flows through API calls. This API integration empowers developers to seamlessly incorporate and activate flows within their applications.
These diverse methods offer users and developers flexibility in integrating and executing flows based on their specific needs and scenarios.
See detail about API calling at <a class="reference external" href="https://api.voipbin.net/redoc/#tag/Activeflow">here</a>.
And due to the absence of any media-based incoming or outgoing elements in the API, certain actions within the flow—such as answer, talk, transcribe, and others—will be ignored. Instead, the execution cursor will proceed to the next action in the sequence.</p>
</section>
</section>
<section id="flow-lifecycle">
<h3>Flow Lifecycle<a class="headerlink" href="#flow-lifecycle" title="Link to this heading"></a></h3>
<p>Understanding when flows start, run, and end helps you design reliable applications.</p>
<p><strong>Flow States</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------------+</span>         <span class="o">+------------+</span>         <span class="o">+------------+</span>
<span class="o">|</span>  <span class="n">Created</span>   <span class="o">|--------&gt;|</span>  <span class="n">Running</span>   <span class="o">|--------&gt;|</span>   <span class="n">Ended</span>    <span class="o">|</span>
<span class="o">+------------+</span>         <span class="o">+------------+</span>         <span class="o">+------------+</span>
      <span class="o">|</span>                      <span class="o">|</span>                      <span class="o">|</span>
      <span class="o">|</span>                      <span class="o">|</span>                      <span class="o">|</span>
<span class="n">Activeflow</span>          <span class="n">Cursor</span> <span class="n">executing</span>         <span class="n">Final</span> <span class="n">state</span>
<span class="n">instance</span> <span class="n">created</span>    <span class="n">actions</span>                  <span class="p">(</span><span class="n">no</span> <span class="n">more</span> <span class="n">changes</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>What Ends a Flow</strong></p>
<p>A flow ends when any of these happen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+-----------------------------------------------------------------+
|                    Flow Termination Triggers                    |
+-----------------------------------------------------------------+

1. End of actions reached
   +---+   +---+   +---+   +---------+
   | 1 |--&gt;| 2 |--&gt;| 3 |--&gt;|  END    |  ← Cursor reaches end
   +---+   +---+   +---+   +---------+

2. Stop action executed
   +---+   +------+
   | 1 |--&gt;| stop |  ← Explicit stop command
   +---+   +------+

3. Call hangs up (for call-based flows)
   +---+   +---+   +---+
   | 1 |--&gt;| 2 |--&gt;| X |  ← Caller or callee hung up
   +---+   +---+   +---+

4. API stop request
   POST /activeflows/{id}/stop  ← External stop command
</pre></div>
</div>
<p><strong>After Flow Ends</strong></p>
<p>When a flow ends, if <code class="docutils literal notranslate"><span class="pre">on_complete_flow_id</span></code> is set, the next flow starts automatically (see below).</p>
</section>
<section id="flow-actions-and-interrupt-actions">
<h3>Flow Actions and Interrupt Actions<a class="headerlink" href="#flow-actions-and-interrupt-actions" title="Link to this heading"></a></h3>
<p>VoIPBIN’s Flow is built on an action-based engine. Each flow is defined as a JSON array of actions, where a “cursor” tracks the current execution point. Under normal circumstances, the cursor advances sequentially from one action to the next based on the flow’s logic. This modular design lets you compose a variety of call-handling scenarios—from answering calls and playing prompts to branching based on caller input.</p>
<section id="standard-flow-actions">
<h4>Standard Flow Actions<a class="headerlink" href="#standard-flow-actions" title="Link to this heading"></a></h4>
<p>Standard flow actions are the building blocks of your call handling logic. Examples include:</p>
<ul class="simple">
<li><p>Answer: Picks up the incoming call.</p></li>
<li><p>Talk: Plays a TTS message or pre-recorded audio.</p></li>
<li><p>Digits Receive: Gathers DTMF input from the caller.</p></li>
<li><p>Branch: Directs the flow based on collected input.</p></li>
</ul>
<p>Each action is executed in sequence, and upon completion, the flow cursor moves to the next action defined in the JSON array. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9bc851be-f05e-11ef-a1e0-77ec628521e0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;flow&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sample Call Flow&quot;</span><span class="p">,</span>
  <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c8ebac0-f05e-11ef-b9ae-4b8aecc935fe&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;answer&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c30642a-f05e-11ef-8674-ebba44c5cb0f2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Welcome to VoIPBIN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c659370-f05e-11ef-b141-63708262508b&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9cb2962a-f05e-11ef-ae35-2374e1ae16df&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
      <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin.call.digits&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;9c30642a-f05e-11ef-8674-ebba44c5cb0f2&quot;</span><span class="p">,</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, the flow proceeds step-by-step—from answering the call to playing a welcome message, receiving DTMF input, and branching accordingly.</p>
</section>
<section id="interrupt-actions">
<h4>Interrupt Actions<a class="headerlink" href="#interrupt-actions" title="Link to this heading"></a></h4>
<p>Interrupt actions are specialized commands that can be triggered asynchronously—at any point during the flow—to handle unexpected events or to initiate high-priority tasks. Unlike standard actions, interrupt actions are designed to override or temporarily suspend the normal flow progression.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Normal Flow Execution              Interrupt Arrives!
+---+   +---+   +---+             +-----------------+
| 1 |--&gt;| 2 |--&gt;| 3 |&lt;------------| Transfer Request|
+---+   +---+   +---+             +-----------------+
             ^                            |
             |                            v
             |                    +-----------------+
             |                    | Interrupt takes |
             +--------------------| over, then      |
               (resume later)     | returns         |
                                  +-----------------+
</pre></div>
</div>
<p>Common interrupt actions include:</p>
<ul class="simple">
<li><p>Attended Transfer: Initiates a transfer even if the call is mid-flow. This allows an operator to consult with a transferee before completing the transfer.</p></li>
<li><p>Transcribe: Starts real-time transcription of the call. This can be triggered on demand without waiting for the current flow action to complete.</p></li>
<li><p>Recording: Begins or stops call recording independently of the flow’s sequential actions.</p></li>
<li><p>Text-to-Speech (TTS): Plays a TTS message at any moment, regardless of the flow’s current state.</p></li>
</ul>
</section>
<section id="how-interrupt-actions-work">
<h4>How Interrupt Actions Work<a class="headerlink" href="#how-interrupt-actions-work" title="Link to this heading"></a></h4>
<p>Interrupt actions are implemented through dedicated API endpoints. When an interrupt is invoked, the platform either temporarily pauses the current flow or dynamically inserts the interrupt action into the execution sequence. Once the interrupt is handled, the flow resumes from the appropriate point.</p>
<p>For example, while the call is waiting for DTMF input in the standard flow, an attended transfer interrupt may be triggered via a separate API call. This immediate action takes precedence over the flow’s waiting state, ensuring that time-sensitive operations are executed without delay.</p>
</section>
<section id="integration-and-best-practices">
<h4>Integration and Best Practices<a class="headerlink" href="#integration-and-best-practices" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Flexibility: Use standard flow actions to define your routine call-handling steps, and rely on interrupt actions for events that require immediate attention.</p></li>
<li><p>API Integration: Interrupt actions can be initiated via dedicated API calls, enabling your application to react in real time to dynamic call events.</p></li>
<li><p>Flow Resumption: After an interrupt action completes, VoIPBIN resumes the flow from the designated point, ensuring a seamless call experience.</p></li>
</ul>
<p>By combining sequential flow actions with the ability to trigger interrupt actions at any time, VoIPBIN provides a robust, programmable environment that can handle both predictable call scenarios and unexpected events with equal ease.</p>
</section>
</section>
<section id="the-on-complete-flow-id">
<h3>The on complete flow id<a class="headerlink" href="#the-on-complete-flow-id" title="Link to this heading"></a></h3>
<p>The on_complete_flow_id allows a flow to automatically trigger another flow in a new session once the current flow completes. This feature addresses a key limitation of call-based flows: when a call ends, the flow execution ends immediately, preventing any post-call actions (After Call Work) from running.</p>
<p>With on_complete_flow_id, developers can define a follow-up flow that executes after the call or flow ends, enabling tasks such as call-summary generation, sending emails, processing recordings, or running analytics.</p>
<section id="how-it-works">
<h4>How it works<a class="headerlink" href="#how-it-works" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">On</span> <span class="n">Complete</span> <span class="n">Flow</span> <span class="n">Chain</span>                             <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Flow</span> <span class="n">A</span> <span class="p">(</span><span class="n">Main</span> <span class="n">Call</span> <span class="n">Flow</span><span class="p">)</span>                  <span class="n">Flow</span> <span class="n">B</span> <span class="p">(</span><span class="n">After</span> <span class="n">Call</span> <span class="n">Work</span><span class="p">)</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
<span class="o">|</span> <span class="n">answer</span>                  <span class="o">|</span>             <span class="o">|</span> <span class="n">fetch</span> <span class="n">recording</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">talk</span> <span class="s2">&quot;Hello&quot;</span>            <span class="o">|</span>             <span class="o">|</span> <span class="n">ai_summarize</span>            <span class="o">|</span>
<span class="o">|</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">agent</span>        <span class="o">|</span>             <span class="o">|</span> <span class="n">email_send</span> <span class="n">summary</span>      <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">call</span> <span class="n">happens</span><span class="o">...</span><span class="p">)</span>       <span class="o">|</span>             <span class="o">|</span> <span class="n">webhook_send</span> <span class="n">analytics</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">hangup</span>                  <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span>                         <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span> <span class="n">on_complete_flow_id</span><span class="p">:</span> <span class="n">B</span>  <span class="o">|------------&gt;|</span> <span class="p">(</span><span class="n">inherits</span> <span class="n">variables</span><span class="p">)</span>    <span class="o">|</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
          <span class="o">|</span>                                        <span class="o">|</span>
          <span class="o">|</span> <span class="n">Call</span> <span class="n">ends</span>                              <span class="o">|</span> <span class="n">Flow</span> <span class="n">B</span> <span class="n">starts</span>
          <span class="o">|</span> <span class="n">Flow</span> <span class="n">A</span> <span class="n">stops</span>                           <span class="o">|</span> <span class="n">automatically</span>
          <span class="n">v</span>                                        <span class="n">v</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Caller</span>             <span class="n">VoIPBIN</span> <span class="n">Engine</span>              <span class="n">Flow</span> <span class="n">A</span>                <span class="n">Flow</span> <span class="n">B</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="o">---</span> <span class="n">Incoming</span> <span class="n">Call</span> <span class="o">--&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|--</span> <span class="n">Start</span> <span class="n">Flow</span> <span class="n">A</span> <span class="o">-------&gt;|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span> <span class="n">Execute</span> <span class="n">actions</span>     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span> <span class="n">answer</span><span class="o">/</span><span class="n">talk</span><span class="o">/...</span>     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="o">&lt;--</span> <span class="n">Call</span> <span class="n">Progress</span> <span class="o">--&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>                        <span class="o">|</span>                     <span class="o">|</span>
<span class="n">X</span> <span class="o">---</span> <span class="n">Hangup</span> <span class="o">---------&gt;|</span>                        <span class="o">|</span>                     <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Stop</span> <span class="n">Flow</span> <span class="n">A</span> <span class="o">--------&gt;|</span>                     <span class="o">|</span>
                       <span class="o">|</span>                        <span class="n">X</span> <span class="p">(</span><span class="n">Flow</span> <span class="n">A</span> <span class="n">stops</span><span class="p">)</span>      <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
            <span class="n">Check</span> <span class="n">on_complete_flow_id</span>                                 <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Start</span> <span class="n">NEW</span> <span class="n">session</span> <span class="o">------------------------&gt;|</span>
                       <span class="o">|</span>                                           <span class="p">(</span><span class="n">inherit</span> <span class="n">variables</span><span class="p">)</span>
                       <span class="o">|</span>                                              <span class="o">|</span>
                       <span class="o">|--</span> <span class="n">Start</span> <span class="n">Flow</span> <span class="n">B</span> <span class="o">-----------------------------&gt;|</span>
                                                                      <span class="o">|</span> <span class="n">Execute</span> <span class="n">ACW</span> <span class="n">actions</span>
                                                                      <span class="o">|</span> <span class="n">summarize</span><span class="o">/</span><span class="n">email</span><span class="o">/...</span>
                                                                      <span class="o">|</span>
                                                                      <span class="n">X</span> <span class="p">(</span><span class="n">Flow</span> <span class="n">B</span> <span class="n">ends</span><span class="p">)</span>
                                                                        <span class="n">If</span> <span class="n">Flow</span> <span class="n">B</span> <span class="n">has</span> <span class="n">on_complete_flow_id</span>
                                                                        <span class="ow">and</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="n">then</span> <span class="n">start</span> <span class="n">another</span> <span class="n">chain</span>
</pre></div>
</div>
<p>When a flow ends—either by reaching the end of its action list, encountering a stop action, or due to call termination—VoIPBIN checks whether on_complete_flow_id is defined.</p>
<p>If so, VoIPBIN starts the referenced flow as a new independent session.</p>
<p>Most runtime variables from the original flow (e.g., ${voipbin.recording.id}, ${voipbin.call.id}) are inherited automatically, allowing seamless post-call workflows without requiring manual variable passing.</p>
<p><strong>Variable Inheritance</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Flow A ends with these variables:
+-----------------------------------------+
| voipbin.call.id = &quot;abc-123&quot;             |
| voipbin.recording.id = &quot;rec-456&quot;        |
| customer.name = &quot;John&quot;                  |
| voipbin.activeflow.complete_count = 0   |
+-----------------------------------------+
                     |
                     | copied to
                     v
Flow B starts with these variables:
+-----------------------------------------+
| voipbin.call.id = &quot;abc-123&quot;             |  ← inherited
| voipbin.recording.id = &quot;rec-456&quot;        |  ← inherited
| customer.name = &quot;John&quot;                  |  ← inherited
| voipbin.activeflow.complete_count = 1   |  ← incremented
+-----------------------------------------+
</pre></div>
</div>
</section>
</section>
<section id="execution-limits">
<h3>Execution limits<a class="headerlink" href="#execution-limits" title="Link to this heading"></a></h3>
<p>To prevent infinite recursion, VoIPBIN enforces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span> <span class="n">A</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">B</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">C</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">D</span> <span class="o">--&gt;</span> <span class="n">Flow</span> <span class="n">E</span> <span class="o">--&gt;</span> <span class="n">STOP</span>
  <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>
<span class="n">count</span><span class="o">=</span><span class="mi">0</span>    <span class="n">count</span><span class="o">=</span><span class="mi">1</span>    <span class="n">count</span><span class="o">=</span><span class="mi">2</span>    <span class="n">count</span><span class="o">=</span><span class="mi">3</span>    <span class="n">count</span><span class="o">=</span><span class="mi">4</span>
                                              <span class="o">|</span>
                                              <span class="o">|</span> <span class="n">count</span><span class="o">=</span><span class="mi">5</span> <span class="n">would</span> <span class="n">be</span> <span class="n">blocked</span>
                                              <span class="n">v</span>
                                        <span class="n">Maximum</span> <span class="n">depth</span> <span class="n">reached</span>
</pre></div>
</div>
<ul class="simple">
<li><p>A maximum of 5 chained on-complete executions. Beyond this limit, no further follow-up flows are triggered.</p></li>
<li><p>Circular references should be avoided, even though safeguards exist.</p></li>
</ul>
</section>
<section id="behavior-on-termination">
<h3>Behavior on termination<a class="headerlink" href="#behavior-on-termination" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>If the flow fails, on_complete_flow_id is not triggered.</p></li>
<li><p>If the flow is forcefully terminated (e.g., due to call hangup), the on-complete flow still runs.</p></li>
</ul>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h3>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow_initial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;on_complete_flow_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow_after_call_work&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This configuration ensures that when <em>flow_initial</em> completes—regardless of how the call ended—the <em>flow_after_call_work</em> flow starts immediately in a new session, while preserving key session variables from the original flow.</p>
</section>
<section id="error-handling-in-flows">
<h3>Error Handling in Flows<a class="headerlink" href="#error-handling-in-flows" title="Link to this heading"></a></h3>
<p>When something goes wrong during flow execution, VoIPBIN handles it gracefully.</p>
<p><strong>Error Scenarios</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Scenario</p></th>
<th class="head"><p>What happens</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Invalid action</p></td>
<td><p>Action is skipped, flow continues to next action</p></td>
</tr>
<tr class="row-odd"><td><p>Media action fails</p></td>
<td><p>Error logged, flow continues or stops based on severity</p></td>
</tr>
<tr class="row-even"><td><p>External service down</p></td>
<td><p>Fire-and-forget actions continue, blocking ones may fail</p></td>
</tr>
<tr class="row-odd"><td><p>Infinite loop detected</p></td>
<td><p>Flow stops after max iterations (safety limit)</p></td>
</tr>
<tr class="row-even"><td><p>Call hangs up</p></td>
<td><p>Flow ends immediately, on_complete_flow runs if set</p></td>
</tr>
</tbody>
</table>
<p><strong>Safety Limits</strong></p>
<p>VoIPBIN prevents runaway flows with built-in limits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Maximum</span> <span class="n">iterations</span> <span class="n">per</span> <span class="n">execution</span> <span class="n">cycle</span><span class="p">:</span> <span class="mi">1000</span>
<span class="n">Maximum</span> <span class="n">total</span> <span class="n">executions</span> <span class="n">per</span> <span class="n">activeflow</span><span class="p">:</span> <span class="mi">100</span>
<span class="n">Maximum</span> <span class="n">on_complete_flow</span> <span class="n">chain</span> <span class="n">depth</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>If these limits are exceeded, the flow stops automatically to protect system resources.</p>
<p><strong>Best Practices for Error Handling</strong></p>
<ol class="arabic simple">
<li><p><strong>Set default branches</strong>: Always include a <code class="docutils literal notranslate"><span class="pre">default_target_id</span></code> in branch actions</p></li>
<li><p><strong>Use timeouts</strong>: Configure appropriate durations for input actions</p></li>
<li><p><strong>Log with webhooks</strong>: Send important events to your webhook for monitoring</p></li>
<li><p><strong>Plan for hangup</strong>: Remember that call-based flows end when the call ends</p></li>
</ol>
</section>
</section>
<section id="flow-struct-flow">
<span id="id1"></span><h2>Flow<a class="headerlink" href="#flow-struct-flow" title="Link to this heading"></a></h2>
<section id="flow-struct-flow-flow">
<span id="id2"></span><h3>Flow<a class="headerlink" href="#flow-struct-flow-flow" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;flow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test conference_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;detail&quot;</span><span class="p">:</span> <span class="s2">&quot;test flow for conference_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">...</span>
    <span class="p">],</span>
    <span class="s2">&quot;tm_create&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-02-03 05:37:48.545532&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_update&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-02-03 06:10:23.604222&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_delete&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-01-01 00:00:00.000000&quot;</span>
<span class="p">},</span>
</pre></div>
</div>
<ul class="simple">
<li><p>id: Flow’s ID.</p></li>
<li><p>type: Flow’s types. See detail <a class="reference internal" href="flow_struct_flow.html#flow-struct-flow-type"><span class="std std-ref">here</span></a>.</p></li>
<li><p>name: Flow’s name.</p></li>
<li><p>detail: Flow’s detail.</p></li>
<li><p>actions: List of actions. See detail <a class="reference internal" href="flow_struct_action.html#flow-struct-action"><span class="std std-ref">here</span></a>.</p></li>
</ul>
<p><strong>Example</strong>
.. code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ff8e4528-a743-4913-948c-81abaf563f80&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;flow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test flow for message sending&quot;</span><span class="p">,</span>
    <span class="s2">&quot;detail&quot;</span><span class="p">:</span> <span class="s2">&quot;test scenario for sending a test message.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;605f5650-ba92-4dcd-bdac-91fcf6260939&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message_send&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is test message.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15559876543&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+31616818985&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;tm_create&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-03-21 02:11:15.033396&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_update&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-01-01 00:00:00.000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_delete&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-01-01 00:00:00.000000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="type">
<span id="flow-struct-flow-type"></span><h3>Type<a class="headerlink" href="#type" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flow</p></td>
<td><p>Normal flow.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="action">
<span id="flow-struct-action"></span><h2>Action<a class="headerlink" href="#action" title="Link to this heading"></a></h2>
<section id="flow-struct-action-action">
<span id="id3"></span><h3>Action<a class="headerlink" href="#flow-struct-action-action" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span>
    <span class="p">},</span>
    <span class="s2">&quot;tm_execute&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>id</em>: Action’s id.</p></li>
<li><p><em>next_id</em>: Action’s next id. If it sets empty, just move on to the next action in the action array.</p></li>
<li><p><em>type</em>: Action’s type. See detail <a class="reference internal" href="flow_struct_action.html#flow-struct-action-type"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>option</em>: Action’s option.</p></li>
</ul>
</section>
<section id="flow-struct-action-type">
<span id="id4"></span><h3>Type<a class="headerlink" href="#flow-struct-action-type" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>agent_call</p></td>
<td><p><strong>Deprecated</strong>. Use the <em>connect</em> instead. Creates a call to the agent and connect.</p></td>
</tr>
<tr class="row-odd"><td><p>amd</p></td>
<td><p>Answering machine detection.</p></td>
</tr>
<tr class="row-even"><td><p>answer</p></td>
<td><p>Answer the call.</p></td>
</tr>
<tr class="row-odd"><td><p>beep</p></td>
<td><p>Play the beep sound.</p></td>
</tr>
<tr class="row-even"><td><p>branch</p></td>
<td><p>Branch gets the variable then execute the correspond action. For example. gets the dtmf input saved variable and jump to the action.</p></td>
</tr>
<tr class="row-odd"><td><p>call</p></td>
<td><p>Starts a new independent outgoing call with a given flow.</p></td>
</tr>
<tr class="row-even"><td><p>chatbot_talk</p></td>
<td><p>Starts a talk with chatbot.</p></td>
</tr>
<tr class="row-odd"><td><p>condition_call_digits</p></td>
<td><p><strong>Deprecated</strong>. Use the <cite>condition_variable</cite> instead. Condition check(call’s digits).</p></td>
</tr>
<tr class="row-even"><td><p>condition_call_status</p></td>
<td><p><strong>Deprecated</strong>. Use the <cite>condition_variable</cite> instead. Condition check(call’s status).</p></td>
</tr>
<tr class="row-odd"><td><p>condition_datetime</p></td>
<td><p>Condition check(time)</p></td>
</tr>
<tr class="row-even"><td><p>condition_variable</p></td>
<td><p>Condition check(variable).</p></td>
</tr>
<tr class="row-odd"><td><p>confbridge_join</p></td>
<td><p>Join to the confbridge.</p></td>
</tr>
<tr class="row-even"><td><p>conference_join</p></td>
<td><p>Join to the conference.</p></td>
</tr>
<tr class="row-odd"><td><p>connect</p></td>
<td><p>Creates a new call to the destinations and connects to them.</p></td>
</tr>
<tr class="row-even"><td><p>conversation_send</p></td>
<td><p>Send a message to the conversation.</p></td>
</tr>
<tr class="row-odd"><td><p>digits_receive</p></td>
<td><p>Receive the digits(dtmfs).</p></td>
</tr>
<tr class="row-even"><td><p>digits_send</p></td>
<td><p>Send the digits(dtmfs).</p></td>
</tr>
<tr class="row-odd"><td><p>echo</p></td>
<td><p>Echo to stream.</p></td>
</tr>
<tr class="row-even"><td><p>external_media_start</p></td>
<td><p>Start the external media.</p></td>
</tr>
<tr class="row-odd"><td><p>external_media_stop</p></td>
<td><p>Stop the external media.</p></td>
</tr>
<tr class="row-even"><td><p>fetch</p></td>
<td><p>Fetch the actions from endpoint.</p></td>
</tr>
<tr class="row-odd"><td><p>fetch_flow</p></td>
<td><p>Fetch the actions from the exist flow.</p></td>
</tr>
<tr class="row-even"><td><p>goto</p></td>
<td><p>Goto.</p></td>
</tr>
<tr class="row-odd"><td><p>hangup</p></td>
<td><p>Hangup the call.</p></td>
</tr>
<tr class="row-even"><td><p>hangup_relay</p></td>
<td><p>Hangs up the call with the same reason of the given reference id.</p></td>
</tr>
<tr class="row-odd"><td><p>message_send</p></td>
<td><p>Send a message.</p></td>
</tr>
<tr class="row-even"><td><p>play</p></td>
<td><p>Play the file of the given urls.</p></td>
</tr>
<tr class="row-odd"><td><p>queue_join</p></td>
<td><p>Join to the queue.</p></td>
</tr>
<tr class="row-even"><td><p>recording_start</p></td>
<td><p>Start the record of the given call.</p></td>
</tr>
<tr class="row-odd"><td><p>recording_stop</p></td>
<td><p>Stop the record of the given call.</p></td>
</tr>
<tr class="row-even"><td><p>sleep</p></td>
<td><p>Sleep.</p></td>
</tr>
<tr class="row-odd"><td><p>stop</p></td>
<td><p>Stop the flow.</p></td>
</tr>
<tr class="row-even"><td><p>stream_echo</p></td>
<td><p>Echo the steam.</p></td>
</tr>
<tr class="row-odd"><td><p>talk</p></td>
<td><p>Generate audio from the given text(ssml or plain text) and play it.</p></td>
</tr>
<tr class="row-even"><td><p>transcribe_start</p></td>
<td><p>Start transcribe the call</p></td>
</tr>
<tr class="row-odd"><td><p>transcribe_stop</p></td>
<td><p>Stop transcribe the call</p></td>
</tr>
<tr class="row-even"><td><p>transcribe_recording</p></td>
<td><p>Transcribe the recording and send it to webhook.</p></td>
</tr>
<tr class="row-odd"><td><p>variable_set</p></td>
<td><p>Sets the variable.</p></td>
</tr>
<tr class="row-even"><td><p>webhook_send</p></td>
<td><p>Send a webhook.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="agent-call">
<span id="flow-struct-action-agent-call"></span><h3>Agent Call<a class="headerlink" href="#agent-call" title="Link to this heading"></a></h3>
<p>Calling the agent.
The agent may have various types of addresses or phone numbers, such as a desk phone, mobile phone, or softphone application.</p>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;agent_call&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;agent_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>agent_id</em>: target agent id.</p></li>
</ul>
</section>
<section id="id5">
<h4>Example<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;agent_call&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;agent_id&quot;</span><span class="p">:</span> <span class="s2">&quot;eb1ac5c0-ff63-47e2-bcdb-5da9c336eb4b&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="amd">
<h3>AMD<a class="headerlink" href="#amd" title="Link to this heading"></a></h3>
<p>Answering machine detection.</p>
<section id="id6">
<h4>Parameters<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;amd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;machine_handle&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;async&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>machine_handle</em>: hangup,delay,continue if the machine answered a call. See detail <a class="reference internal" href="flow_struct_action.html#flow-struct-action-amd-machinehandle"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>async</em>: if it’s false, the call flow will be stop until amd done.</p></li>
</ul>
</section>
<section id="machine-handle">
<span id="flow-struct-action-amd-machinehandle"></span><h4>Machine handle<a class="headerlink" href="#machine-handle" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>hangup</p></td>
<td><p>Hangup the call.</p></td>
</tr>
<tr class="row-odd"><td><p>continue</p></td>
<td><p>Continue the call.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h4>Example<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;amd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;machine_handle&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="answer">
<span id="flow-struct-action-answer"></span><h3>Answer<a class="headerlink" href="#answer" title="Link to this heading"></a></h3>
<p>Answer the call</p>
<section id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;answer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id9">
<h4>Example<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;answer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="beep">
<span id="flow-struct-action-beep"></span><h3>Beep<a class="headerlink" href="#beep" title="Link to this heading"></a></h3>
<p>Make a beep sound.</p>
<section id="id10">
<h4>Parameters<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;beep&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id11">
<h4>Example<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;beep&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="branch">
<span id="flow-struct-action-branch"></span><h3>Branch<a class="headerlink" href="#branch" title="Link to this heading"></a></h3>
<p>Branch the flow.
It gets the variable from the activeflow and move the activeflow cursor to the selected target id.</p>
<section id="id12">
<h4>Parameters<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;default_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>variable</em>: Target variable. If this value is empty, default target variable will be selected. Available variables are listed <a class="reference internal" href="variable_variable.html#variable-variable"><span class="std std-ref">here</span></a>. default: voipbin.call.digits</p></li>
<li><p>default_target_id: action id for default selection. This will be generated automatically by the given default_index.</p></li>
<li><p>target_ids: set of input digit and target id fair. This will be generated automatically by the given target_indexes.</p></li>
</ul>
</section>
<section id="id13">
<h4>Example<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;default_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ed9705ca-c524-11ec-a3fb-8feb7731ad45&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;c3eb8e62-c524-11ec-94c5-abafec8af561&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;dc87123e-c524-11ec-89c6-5fb18da14034&quot;</span><span class="p">,</span>
            <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;e70fb030-c524-11ec-b657-ebec72f097ef&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="call">
<span id="flow-struct-action-call"></span><h3>Call<a class="headerlink" href="#call" title="Link to this heading"></a></h3>
<p>Make a new outbound call in a new context.</p>
<img alt="_images/flow_action_call.png" src="_images/flow_action_call.png" />
<section id="id14">
<h4>Parameters<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;call&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="o">...</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="o">...</span>
        <span class="p">],</span>
        <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
        <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="o">...</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;chained&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;early_execution&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>source</em>: Source address. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-type"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>destinations</em>: Array of destination addresses. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-type"><span class="std std-ref">here</span></a>.</p></li>
<li><p>flow_id: Call’s flow id. If this not set, will use the actions array.</p></li>
<li><p>actions: Array of actions. If the flow_id not set, the call flow will be created with this actions.</p></li>
<li><p>chained: If it sets to true, created calls will be hungup when the master call is hangup. Default false.</p></li>
<li><p>early_execution: It it sets to true, the voipbin will execute the flow when then call is ringing.</p></li>
</ul>
</section>
<section id="id15">
<h4>Example<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;e34ab97a-c53a-4eb4-aebf-36767a528f00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;call&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000001&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000002&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
                <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is test message.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;chained&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="chatbot-talk">
<span id="flow-struct-action-chatbot-talk"></span><h3>Chatbot Talk<a class="headerlink" href="#chatbot-talk" title="Link to this heading"></a></h3>
<p>Start the chatbot talk.</p>
<section id="id16">
<h4>Parameters<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;chatbot_talk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;chatbot_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>chatbot_id: Chatbot id.</p></li>
<li><p>gender: Voice gender. male/female/neutral</p></li>
<li><p>language: Specifies the language. BCP47 format.</p></li>
<li><p>duration: Duration. Seconds.</p></li>
</ul>
</section>
</section>
<section id="confbridge-join">
<span id="flow-struct-action-confbridge-join"></span><h3>Confbridge Join<a class="headerlink" href="#confbridge-join" title="Link to this heading"></a></h3>
<p>Join to the confbridge.</p>
<section id="id17">
<h4>Parameters<a class="headerlink" href="#id17" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;confbridge_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;confbridge_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>confbridge_id</em>: Target confbridge id.</p></li>
</ul>
</section>
</section>
<section id="condition-call-digits">
<span id="flow-struct-action-condition-call-digits"></span><h3>Condition Call Digits<a class="headerlink" href="#condition-call-digits" title="Link to this heading"></a></h3>
<p>Deprecated. Use the condition_variable instead.
Check the condition of received digits.
If the conditions are met, the system proceeds to the next action.
If the conditions are not met, the voipbin directs the call to a false_target_id for further processing.</p>
<section id="id18">
<h4>Parameters<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_call_digits&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>length: match digits length.</p></li>
<li><p>key: match digits contain.</p></li>
<li><p>false_target_id: action id for false condition.</p></li>
</ul>
</section>
<section id="id19">
<h4>Example<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_call_digits&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;e3e50e6c-9c8b-11ec-8031-0384a8fcd1e2&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="condition-call-status">
<span id="flow-struct-action-condition-call-status"></span><h3>Condition Call Status<a class="headerlink" href="#condition-call-status" title="Link to this heading"></a></h3>
<p>Deprecated. Use the condition_variable instead.
Check the condition of call’s status.
It checks the call’s status and if it matched with condition then move to the next action. If not, move to the false_target_id.</p>
<section id="id20">
<h4>Parameters<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_call_status&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>status</em>: match call’s status. See detail <a class="reference internal" href="call_struct_call.html#call-struct-call-status"><span class="std std-ref">here</span></a>.</p></li>
<li><p>false_target_id: action id for false condition.</p></li>
</ul>
</section>
<section id="id21">
<h4>Example<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_call_status&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;progressing,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;e3e50e6c-9c8b-11ec-8031-0384a8fcd1e2&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="condition-datetime">
<span id="flow-struct-action-condition-datetime"></span><h3>Condition Datetime<a class="headerlink" href="#condition-datetime" title="Link to this heading"></a></h3>
<p>Check the condition of the time.
It checks the current time(UTC) and if it matched with condition then move to the next action. If not, move to the false_target_id.</p>
<section id="id22">
<h4>Parameters<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>

        <span class="s2">&quot;minute&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;weekdays&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="o">...</span>
        <span class="p">],</span>


        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>condition</em>: Match condition. One of “==”, “!=”, “&gt;”, “&gt;=”, “&lt;”, “&lt;=”.</p></li>
<li><p>minute: Minutes. -1 for all minutes.</p></li>
<li><p>hour: Hour. -1 for all hours.</p></li>
<li><p>day: Day. -1 for all days.</p></li>
<li><p>month: Month. 0 for all months.</p></li>
<li><p>weekdays: List of weekdays. Sunday: 0, Monday: 1, Tuesday: 2, Wednesday: 3, Thursday: 4, Friday: 5, Saturday: 6</p></li>
<li><p>false_target_id: action id for false condition.</p></li>
</ul>
</section>
<section id="id23">
<h4>Example<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_datetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;=,</span>
        <span class="s2">&quot;minute&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;weekdays&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d08582ee-1b3d-11ed-a43e-9379f27c3f7f&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="condition-variable">
<span id="flow-struct-action-condition-variable"></span><h3>Condition Variable<a class="headerlink" href="#condition-variable" title="Link to this heading"></a></h3>
<p>Check the condition of the given variable.
It checks the call’s status and if it matched with condition then move to the next action. If not, move to the false_target_id.</p>
<section id="id24">
<h4>Parameters<a class="headerlink" href="#id24" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_variable&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value_string&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value_number&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;value_length&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>condition</em>: Match condition. One of “==”, “!=”, “&gt;”, “&gt;=”, “&lt;”, “&lt;=”.</p></li>
<li><p><em>variable</em>: Target variable. See detail <a class="reference internal" href="variable_variable.html#variable-variable"><span class="std std-ref">here</span></a>.</p></li>
<li><p>value_type: Type of value. string/number/length.</p></li>
<li><p>value_string: Value. Valid only if the value_type is string.</p></li>
<li><p>value_number: Value. Valid only if the value_type is number.</p></li>
<li><p>value_length: Value. Valid only if the value_type is length.</p></li>
<li><p>false_target_id: action id for false condition.</p></li>
</ul>
</section>
<section id="id25">
<h4>Example<a class="headerlink" href="#id25" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_variable&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="s2">&quot;==&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin.call.source.target&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value_type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value_string&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;fb2f4e2a-b030-11ed-bddb-976af892f5a3&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="conference-join">
<span id="flow-struct-action-conference-join"></span><h3>Conference Join<a class="headerlink" href="#conference-join" title="Link to this heading"></a></h3>
<p>Join to the conference</p>
<section id="id26">
<h4>Parameters<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;conference_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;conference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>conference_id: Conference’s id to join.</p></li>
</ul>
</section>
<section id="id27">
<h4>Example<a class="headerlink" href="#id27" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;conference_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;conference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;367e0e7a-3a8c-11eb-bb08-f3c3f059cfbe&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="connect">
<span id="flow-struct-action-connect"></span><h3>Connect<a class="headerlink" href="#connect" title="Link to this heading"></a></h3>
<p>Originate to the other destination(s) and connect to them each other.</p>
<section id="id28">
<h4>Parameters<a class="headerlink" href="#id28" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connect&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="o">...</span>
        <span class="p">],</span>
        <span class="s2">&quot;early_media&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;relay_reason&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>source</em>: Source address. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-address"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>destinations</em>: Array of destination addresses. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-address"><span class="std std-ref">here</span></a>.</p></li>
<li><p>early_media: Support early media.</p></li>
<li><p>relay_reason: relay the hangup reason to the master call.</p></li>
</ul>
</section>
<section id="id29">
<h4>Example<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connect&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+11111111111111&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+222222222222222&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="conversation-send">
<span id="flow-struct-action-conversation-send"></span><h3>Conversation send<a class="headerlink" href="#conversation-send" title="Link to this heading"></a></h3>
<p>Send the message to the conversation.</p>
<section id="id30">
<h4>Parameters<a class="headerlink" href="#id30" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;conversation_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>conversation_id: Target conversation id.</p></li>
<li><p>text: Send text message.</p></li>
<li><p>sync: If this set to true, waits until this action done.</p></li>
</ul>
</section>
<section id="id31">
<h4>Example<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;conversation_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b5ef5e64-f7ca-11ec-bbe9-9f74186a2a72&quot;</span><span class="p">,</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello world, this is test message.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="digits-receive">
<span id="flow-struct-action-digits-receive"></span><h3>Digits Receive<a class="headerlink" href="#digits-receive" title="Link to this heading"></a></h3>
<p>Receives the digits for given duration or numbers.</p>
<section id="id32">
<h4>Parameters<a class="headerlink" href="#id32" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>duration: The duration allows you to set the limit (in ms) that VoIPBIN will wait for the endpoint to press another digit or say another word before it continue to the next action.</p></li>
<li><p>length: You can set the number of DTMFs you expect. An optional limit to the number of DTMF events that should be gathered before continuing to the next action. By default, this is set to 1, so any key will trigger the next step. If EndKey is set and MaxNumKeys is unset, no limit for the number of keys that will be gathered will be imposed. It is possible for less keys to be gathered if the EndKey is pressed or the timeout being reached.</p></li>
<li><p>key: If set, determines which DTMF triggers the next step. The finish_on_key will be included in the resulting variable. If not set, no key will trigger the next action.</p></li>
</ul>
</section>
<section id="id33">
<h4>Example<a class="headerlink" href="#id33" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;#&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="digits-send">
<span id="flow-struct-action-digits-send"></span><h3>Digits Send<a class="headerlink" href="#digits-send" title="Link to this heading"></a></h3>
<p>Sends the digits with given duration and interval.</p>
<section id="id34">
<h4>Parameters<a class="headerlink" href="#id34" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;digits&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>digits: The digit string to send. Allowed set of characters: 0-9,A-D, #, ‘*’; with a maximum of 100 keys.</p></li>
<li><p>duration: The duration of DTMF tone per key in milliseconds. Allowed values: Between 100 and 1000.</p></li>
<li><p>interval: Interval between sending keys in milliseconds. Allowed values: Between 0 and 5000.</p></li>
</ul>
</section>
<section id="id35">
<h4>Example<a class="headerlink" href="#id35" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;digits&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890&quot;</span><span class="p">,</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">500</span>
    <span class="p">}</span>
<span class="p">},</span>
</pre></div>
</div>
</section>
</section>
<section id="echo">
<span id="flow-struct-action-echo"></span><h3>Echo<a class="headerlink" href="#echo" title="Link to this heading"></a></h3>
<p>Echoing the call.</p>
<section id="id36">
<h4>Parameters<a class="headerlink" href="#id36" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;echo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>duration</em>: Echo duration. ms.</p></li>
</ul>
</section>
<section id="id37">
<h4>Example<a class="headerlink" href="#id37" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;echo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">30000</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="external-media-start">
<span id="flow-struct-action-external-media-start"></span><h3>External Media Start<a class="headerlink" href="#external-media-start" title="Link to this heading"></a></h3>
<p>Start the external media.</p>
<section id="id38">
<h4>Parameters<a class="headerlink" href="#id38" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;external_media_start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;external_host&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;encapsulation&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transport&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;connection_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>external_host: external media target host address.</p></li>
<li><p>encapsulation: encapsulation. default: rtp.</p></li>
<li><p>transport: transport. default: udp.</p></li>
<li><p>connection_type: connection type. default: client</p></li>
<li><p>format: format default: ulaw</p></li>
<li><p>direction: Direction. default: both.</p></li>
<li><p>data: Data. Reserved.</p></li>
</ul>
</section>
</section>
<section id="external-media-stop">
<span id="flow-struct-action-external-media-stop"></span><h3>External Media Stop<a class="headerlink" href="#external-media-stop" title="Link to this heading"></a></h3>
<p>Stop the external media.</p>
<section id="id39">
<h4>Parameters<a class="headerlink" href="#id39" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;external_media_stop&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="fetch">
<h3>Fetch<a class="headerlink" href="#fetch" title="Link to this heading"></a></h3>
<p>Fetch the next flow from the remote.</p>
<section id="id40">
<h4>Parameters<a class="headerlink" href="#id40" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;event_url&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;event_method&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>event_url: The url for flow fetching.</p></li>
<li><p>event_method: The method for flow fetching.</p></li>
</ul>
</section>
<section id="id41">
<h4>Example<a class="headerlink" href="#id41" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;event_method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;event_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://webhook.site/e47c9b40-662c-4d20-a288-6777360fa211&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="fetch-flow">
<span id="flow-struct-action-fetch-flow"></span><h3>Fetch Flow<a class="headerlink" href="#fetch-flow" title="Link to this heading"></a></h3>
<p>Fetch the next flow from the existing flow.</p>
<section id="id42">
<h4>Parameters<a class="headerlink" href="#id42" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch_flow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>flow_id</em>: The id of flow.</p></li>
</ul>
</section>
<section id="id43">
<h4>Example<a class="headerlink" href="#id43" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch_flow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;212a32a8-9529-11ec-8bf0-8b89df407b6e&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="goto">
<span id="flow-struct-action-goto"></span><h3>Goto<a class="headerlink" href="#goto" title="Link to this heading"></a></h3>
<p>Move the action execution.</p>
<section id="id44">
<h4>Parameters<a class="headerlink" href="#id44" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;goto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loop_count&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>target_id: action id for move target.</p></li>
<li><p>loop_count: The number of loop.</p></li>
</ul>
</section>
<section id="id45">
<h4>Example<a class="headerlink" href="#id45" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;goto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ca4ddd74-9c8d-11ec-818d-d7cf1487e8df&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loop_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="hangup">
<span id="flow-struct-action-hangup"></span><h3>Hangup<a class="headerlink" href="#hangup" title="Link to this heading"></a></h3>
<p>Hangup the call.</p>
<section id="id46">
<h4>Parameters<a class="headerlink" href="#id46" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id47">
<h4>Example<a class="headerlink" href="#id47" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="hangup-relay">
<span id="flow-struct-action-hangup-relay"></span><h3>Hangup Relay<a class="headerlink" href="#hangup-relay" title="Link to this heading"></a></h3>
<p>Hangup the call and relay the hangup cause to the reference id.</p>
<section id="id48">
<h4>Parameters<a class="headerlink" href="#id48" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup_relay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;reference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id49">
<h4>Example<a class="headerlink" href="#id49" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup_relay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;reference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b8573f30-b031-11ed-ac05-3bc9a62e64c3&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="message-send">
<span id="flow-struct-action-message-send"></span><h3>Message send<a class="headerlink" href="#message-send" title="Link to this heading"></a></h3>
<p>Send a message.</p>
<section id="id50">
<h4>Parameters<a class="headerlink" href="#id50" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="o">...</span>
        <span class="p">},</span>
        <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="o">...</span>
        <span class="p">],</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>source</em>: Source address info. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-address"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>destinations</em>: Array of destination addresses. See detail <a class="reference internal" href="common_struct_address.html#common-struct-address-address"><span class="std std-ref">here</span></a>.</p></li>
<li><p>text: Message’s text.</p></li>
</ul>
</section>
</section>
<section id="play">
<span id="flow-struct-action-play"></span><h3>Play<a class="headerlink" href="#play" title="Link to this heading"></a></h3>
<p>Plays the linked file.</p>
<section id="id51">
<h4>Parameters<a class="headerlink" href="#id51" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;play&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;stream_urls&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
            <span class="o">...</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>stream_urls: Stream url array for media.</p></li>
</ul>
</section>
<section id="id52">
<h4>Example<a class="headerlink" href="#id52" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;play&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;stream_urls&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;https://github.com/pchero/asterisk-medias/raw/master/samples_codec/pcm_samples/example-mono_16bit_8khz_pcm.wav&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="queue-join">
<span id="flow-struct-action-queue-join"></span><h3>Queue Join<a class="headerlink" href="#queue-join" title="Link to this heading"></a></h3>
<p>Join to the queue.</p>
<section id="id53">
<h4>Parameters<a class="headerlink" href="#id53" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;queue_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;queue_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>queue_id: Target queue id.</p></li>
</ul>
</section>
<section id="id54">
<h4>Example<a class="headerlink" href="#id54" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;queue_join&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;queue_id&quot;</span><span class="p">:</span> <span class="s2">&quot;99bf739a-932f-433c-b1bf-103d33d7e9bb&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="recording-start">
<span id="flow-struct-action-recording-start"></span><h3>Recording Start<a class="headerlink" href="#recording-start" title="Link to this heading"></a></h3>
<p>Starts the call recording.</p>
<section id="id55">
<h4>Parameters<a class="headerlink" href="#id55" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;recording_start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end_of_silence&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;end_of_key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;beep_start&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>format: Format to encode audio in. wav, mp3, ogg.</p></li>
<li><p>end_of_silence: Maximum duration of silence, in seconds. 0 for no limit.</p></li>
<li><p>end_of_key: DTMF input to terminate recording. none, any, *, #.</p></li>
<li><p>duration: Maximum duration of the recording, in seconds. 0 for no limit.</p></li>
<li><p>beep_start: Play beep when recording begins</p></li>
</ul>
</section>
<section id="id56">
<h4>Example<a class="headerlink" href="#id56" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;recording_start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;wav&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="recording-stop">
<span id="flow-struct-action-recording-stop"></span><h3>Recording Stop<a class="headerlink" href="#recording-stop" title="Link to this heading"></a></h3>
<p>Stops the call recording.</p>
<section id="id57">
<h4>Parameters<a class="headerlink" href="#id57" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;recording_stop&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id58">
<h4>Example<a class="headerlink" href="#id58" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;recording_stop&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="sleep">
<span id="flow-struct-action-sleep"></span><h3>Sleep<a class="headerlink" href="#sleep" title="Link to this heading"></a></h3>
<p>Sleep the call.</p>
<section id="id59">
<h4>Parameters<a class="headerlink" href="#id59" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>duration: Sleep duration(ms).</p></li>
</ul>
</section>
</section>
<section id="stream-echo">
<span id="flow-struct-action-stream-echo"></span><h3>Stream Echo<a class="headerlink" href="#stream-echo" title="Link to this heading"></a></h3>
<p>Echoing the RTP stream including the digits receive.</p>
<section id="id60">
<h4>Parameters<a class="headerlink" href="#id60" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;stream_echo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>duration</em>: Echo duration. ms.</p></li>
</ul>
</section>
<section id="id61">
<h4>Example<a class="headerlink" href="#id61" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;stream_echo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">10000</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="talk">
<span id="flow-struct-action-talk"></span><h3>Talk<a class="headerlink" href="#talk" title="Link to this heading"></a></h3>
<p>Text to speech. SSML(<a class="reference external" href="https://www.w3.org/TR/speech-synthesis/">https://www.w3.org/TR/speech-synthesis/</a>) supported.</p>
<section id="id62">
<h4>Parameters<a class="headerlink" href="#id62" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;digits_handle&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>text: Text to speech. SSML(<a class="reference external" href="https://cloud.google.com/text-to-speech/docs/ssml">https://cloud.google.com/text-to-speech/docs/ssml</a>) supported.</p></li>
<li><p>gender: male/female/neutral.</p></li>
<li><p>language: Specifies the language. The value may contain a lowercase, two-letter language code (for example, en), or the language code and uppercase country/region (for example, en-US).</p></li>
<li><p>digits_handle: See detail <a class="reference internal" href="flow_struct_action.html#flow-struct-action-talk-digits-handle"><span class="std std-ref">here</span></a>.</p></li>
</ul>
</section>
<section id="digits-handle">
<span id="flow-struct-action-talk-digits-handle"></span><h4>Digits handle<a class="headerlink" href="#digits-handle" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>next</p></td>
<td><p>If digits received in talk, move the action to the next.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id63">
<h4>Example<a class="headerlink" href="#id63" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello. Welcome to voipbin. This is test message. Please enjoy the voipbin service. Thank you. Bye&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="transcribe-recording">
<span id="flow-struct-action-transcribe-recording"></span><h3>Transcribe recording<a class="headerlink" href="#transcribe-recording" title="Link to this heading"></a></h3>
<p>Transcribe the call’s recordings.</p>
<section id="id64">
<h4>Parameters<a class="headerlink" href="#id64" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_recording&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>language: Specifies the language. BCP47 format.</p></li>
</ul>
</section>
<section id="id65">
<h4>Example<a class="headerlink" href="#id65" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_recording&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="transcribe-start">
<span id="flow-struct-action-transribe-start"></span><h3>Transcribe start<a class="headerlink" href="#transcribe-start" title="Link to this heading"></a></h3>
<p>Start the STT(Speech to text) transcribe in realtime.</p>
<section id="id66">
<h4>Parameters<a class="headerlink" href="#id66" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>language</em>: Specifies the language. BCP47 format. The value may contain a lowercase, two-letter language code (for example, en), or the language code and uppercase country/region (for example, en-US).</p></li>
</ul>
</section>
<section id="id67">
<h4>Example<a class="headerlink" href="#id67" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="transcribe-stop">
<span id="flow-struct-action-transcribe-stop"></span><h3>Transcribe stop<a class="headerlink" href="#transcribe-stop" title="Link to this heading"></a></h3>
<p>Stop the transcribe talk in realtime.</p>
<section id="id68">
<h4>Parameters<a class="headerlink" href="#id68" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_stop&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id69">
<h4>Example<a class="headerlink" href="#id69" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;transcribe_stop&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="variable-set">
<span id="flow-struct-action-variable-set"></span><h3>Variable Set<a class="headerlink" href="#variable-set" title="Link to this heading"></a></h3>
<p>Set a variable value for use in the flow.</p>
<section id="id70">
<h4>Parameters<a class="headerlink" href="#id70" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;variable_set&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>key: Variable name.</p></li>
<li><p>value: Variable value.</p></li>
</ul>
</section>
<section id="id71">
<h4>Example<a class="headerlink" href="#id71" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;variable_set&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;Provider name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;voipbin&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="webhook-send">
<span id="flow-struct-action-webhook-send"></span><h3>Webhook send<a class="headerlink" href="#webhook-send" title="Link to this heading"></a></h3>
<p>Send a webhook.</p>
<section id="id72">
<h4>Parameters<a class="headerlink" href="#id72" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;webhook_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="n">boolean</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>sync: If this set to true, waits until this action done.</p></li>
<li><p>uri: Destination uri.</p></li>
<li><p>method: HTTP method. Supported values: POST, GET, PUT, DELETE.</p></li>
<li><p>data_type: Content type of the data. For example: application/json.</p></li>
<li><p>data: Data string. Variable can be used.</p></li>
</ul>
</section>
<section id="id73">
<h4>Example<a class="headerlink" href="#id73" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;webhook_send&quot;</span><span class="p">,</span>
    <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://test.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">destination_number</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{voipbin.call.destination.target}</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">source_number</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{voipbin.call.source.target}</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="tutorial-basic">
<span id="flow-tutorial-basic"></span><h2>Tutorial basic<a class="headerlink" href="#tutorial-basic" title="Link to this heading"></a></h2>
<section id="get-list-of-flows">
<h3>Get list of flows<a class="headerlink" href="#get-list-of-flows" title="Link to this heading"></a></h3>
<p>Gets the list of registered flows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request GET &#39;https://api.voipbin.net/v1.0/flows?token=&lt;YOUR_AUTH_TOKEN&gt;&#39;

{
    &quot;result&quot;: [
        {
            &quot;id&quot;: &quot;decc2634-0b2a-11eb-b38d-87a8f1051188&quot;,
            &quot;name&quot;: &quot;default flow&quot;,
            &quot;detail&quot;: &quot;default flow for voipbin incoming calls&quot;,
            &quot;actions&quot;: [
                {
                    &quot;id&quot;: &quot;b34aa8a4-0b30-11eb-8016-1f5bc75b1c04&quot;,
                    &quot;type&quot;: &quot;play&quot;,
                    &quot;option&quot;: {
                        &quot;stream_url&quot;: [
                            &quot;https://github.com/pchero/asterisk-medias/raw/master/voipbin/welcome.wav&quot;
                        ]
                    }
                },
                {
                    &quot;id&quot;: &quot;57a3dcd2-0b2b-11eb-94a6-a7129b64693c&quot;,
                    &quot;type&quot;: &quot;play&quot;,
                    &quot;option&quot;: {
                        &quot;stream_url&quot;: [
                            &quot;https://github.com/pchero/asterisk-medias/raw/master/samples_codec/pcm_samples/example-mono_16bit_8khz_pcm.wav&quot;
                        ]
                    }
                }
            ],
            &quot;tm_create&quot;: &quot;2020-10-11 01:00:00.000001&quot;,
            &quot;tm_update&quot;: &quot;&quot;,
            &quot;tm_delete&quot;: &quot;&quot;
        },
        {
            &quot;id&quot;: &quot;af9dae94-ef07-11ea-a101-8f52e568f39b&quot;,
            &quot;name&quot;: &quot;test flow&quot;,
            &quot;detail&quot;: &quot;manual flow test&quot;,
            &quot;actions&quot;: [
                {
                    &quot;id&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;,
                    &quot;type&quot;: &quot;echo&quot;
                }
            ],
            &quot;tm_create&quot;: &quot;2020-09-04 23:53:14.496918&quot;,
            &quot;tm_update&quot;: &quot;&quot;,
            &quot;tm_delete&quot;: &quot;&quot;
        }
    ],
    &quot;next_page_token&quot;: &quot;2020-09-04 23:53:14.496918&quot;
}
</pre></div>
</div>
</section>
<section id="get-detail-of-specified-flow">
<h3>Get detail of specified flow<a class="headerlink" href="#get-detail-of-specified-flow" title="Link to this heading"></a></h3>
<p>Gets the detail of registered flows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request GET &#39;https://api.voipbin.net/v1.0/flows/decc2634-0b2a-11eb-b38d-87a8f1051188?token=&lt;YOUR_AUTH_TOKEN&gt;&#39;

{
    &quot;id&quot;: &quot;decc2634-0b2a-11eb-b38d-87a8f1051188&quot;,
    &quot;name&quot;: &quot;default flow&quot;,
    &quot;detail&quot;: &quot;default flow for voipbin incoming calls&quot;,
    &quot;actions&quot;: [
        {
            &quot;id&quot;: &quot;b34aa8a4-0b30-11eb-8016-1f5bc75b1c04&quot;,
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/voipbin/welcome.wav&quot;
                ]
            }
        },
        {
            &quot;id&quot;: &quot;57a3dcd2-0b2b-11eb-94a6-a7129b64693c&quot;,
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/samples_codec/pcm_samples/example-mono_16bit_8khz_pcm.wav&quot;
                ]
            }
        }
    ],
    &quot;tm_create&quot;: &quot;2020-10-11 01:00:00.000001&quot;,
    &quot;tm_update&quot;: &quot;&quot;,
    &quot;tm_delete&quot;: &quot;&quot;
}
</pre></div>
</div>
</section>
<section id="create-a-flow">
<h3>Create a flow<a class="headerlink" href="#create-a-flow" title="Link to this heading"></a></h3>
<p>Create a new flow for incoming call requests.
When the call is incoming, this flow will answer the call first, then speak the welcome text.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request POST &#39;https://api.voipbin.net/v1.0/flows?token=&lt;YOUR_AUTH_TOKEN&gt;&#39; \
--header &#39;Content-Type: application/json&#39; \
--data-raw &#39;{
    &quot;name&quot;: &quot;test flow&quot;,
    &quot;detail&quot;: &quot;test voipbin flow example&quot;,
    &quot;actions&quot;: [
        {
            &quot;type&quot;: &quot;answer&quot;
        },
        {
            &quot;type&quot;: &quot;talk&quot;,
            &quot;option&quot;: {
                &quot;text&quot;: &quot;hello. welcome to voipbin. This is test message. Please enjoy the voipbin&#39;\&#39;&#39;s service. thank you.&quot;,
                &quot;gender&quot;: &quot;female&quot;,
                &quot;language&quot;: &quot;en-US&quot;
            }
        }
    ]
}&#39;

{
    &quot;id&quot;: &quot;24013a0e-d15b-4b5e-9a96-04221a8c6a15&quot;,
    &quot;name&quot;: &quot;test flow&quot;,
    &quot;detail&quot;: &quot;test voipbin flow example&quot;,
    &quot;actions&quot;: [
        {
            &quot;id&quot;: &quot;9461bda1-54fd-4e27-ab04-4186c6f72830&quot;,
            &quot;type&quot;: &quot;answer&quot;
        },
        {
            &quot;id&quot;: &quot;69af787e-f5fa-4a1b-9d12-f0b43b86dae6&quot;,
            &quot;type&quot;: &quot;talk&quot;,
            &quot;option&quot;: {
                &quot;text&quot;: &quot;hello. welcome to voipbin. This is test message. Please enjoy the voipbin&#39;s service. thank you.&quot;,
                &quot;gender&quot;: &quot;female&quot;,
                &quot;language&quot;: &quot;en-US&quot;
            }
        }
    ],
    &quot;tm_create&quot;: &quot;2021-02-04 06:47:01.139361&quot;,
    &quot;tm_update&quot;: &quot;&quot;,
    &quot;tm_delete&quot;: &quot;&quot;
}
</pre></div>
</div>
</section>
<section id="update-the-flow">
<h3>Update the flow<a class="headerlink" href="#update-the-flow" title="Link to this heading"></a></h3>
<p>Update an existing flow with the given information.
This doesn’t affect existing calls. Flow changes will only affect new calls.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request PUT &#39;https://api.voipbin.net/v1.0/flows/decc2634-0b2a-11eb-b38d-87a8f1051188?token=&lt;YOUR_AUTH_TOKEN&gt;&#39; \
--header &#39;Content-Type: application/json&#39; \
--data-raw &#39;{
    &quot;name&quot;: &quot;test flow update&quot;,
    &quot;detail&quot;: &quot;test voipbin flow example update&quot;,
    &quot;actions&quot;: [
        {
            &quot;type&quot;: &quot;answer&quot;
        },
        {
            &quot;type&quot;: &quot;talk&quot;,
            &quot;option&quot;: {
                &quot;text&quot;: &quot;hello. welcome to voipbin. This is test message. Please enjoy the voipbin&#39;\&#39;&#39;s service. thank you.&quot;,
                &quot;gender&quot;: &quot;female&quot;,
                &quot;language&quot;: &quot;en-US&quot;
            }
        },
        {
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/voipbin/welcome.wav&quot;
                ]
            }
        },
        {
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/samples_codec/pcm_samples/example-mono_16bit_8khz_pcm.wav&quot;
                ]
            }
        }
    ]
}&#39;

{
    &quot;id&quot;: &quot;decc2634-0b2a-11eb-b38d-87a8f1051188&quot;,
    &quot;name&quot;: &quot;test flow update&quot;,
    &quot;detail&quot;: &quot;test voipbin flow example update&quot;,
    &quot;actions&quot;: [
        {
            &quot;id&quot;: &quot;be682498-e57e-41e9-b210-a578f9c044c5&quot;,
            &quot;type&quot;: &quot;answer&quot;
        },
        {
            &quot;id&quot;: &quot;6669bfdd-a7b0-45e6-9a8d-db6bb898159f&quot;,
            &quot;type&quot;: &quot;talk&quot;,
            &quot;option&quot;: {
                &quot;text&quot;: &quot;hello. welcome to voipbin. This is test message. Please enjoy the voipbin&#39;s service. thank you.&quot;,
                &quot;gender&quot;: &quot;female&quot;,
                &quot;language&quot;: &quot;en-US&quot;
            }
        },
        {
            &quot;id&quot;: &quot;099b60c1-7b95-4d69-8cac-df11a992ee11&quot;,
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/voipbin/welcome.wav&quot;
                ]
            }
        },
        {
            &quot;id&quot;: &quot;89fa5091-a192-4758-8a29-316776ead8fe&quot;,
            &quot;type&quot;: &quot;play&quot;,
            &quot;option&quot;: {
                &quot;stream_url&quot;: [
                    &quot;https://github.com/pchero/asterisk-medias/raw/master/samples_codec/pcm_samples/example-mono_16bit_8khz_pcm.wav&quot;
                ]
            }
        }
    ],
    &quot;tm_create&quot;: &quot;2020-10-11 01:00:00.000001&quot;,
    &quot;tm_update&quot;: &quot;2021-02-05 13:08:56.113036&quot;,
    &quot;tm_delete&quot;: &quot;&quot;
}
</pre></div>
</div>
</section>
<section id="delete-the-flow">
<h3>Delete the flow<a class="headerlink" href="#delete-the-flow" title="Link to this heading"></a></h3>
<p>Delete an existing flow by its flow ID.
This doesn’t affect existing calls.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request GET &#39;https://api.voipbin.net/v1.0/flows/af9dae94-ef07-11ea-a101-8f52e568f39b?token=&lt;YOUR_AUTH_TOKEN&gt;&#39; \
</pre></div>
</div>
</section>
</section>
<section id="tutorial-scenario">
<span id="flow-tutorial-scenario"></span><h2>Tutorial scenario<a class="headerlink" href="#tutorial-scenario" title="Link to this heading"></a></h2>
<section id="simple-voicemail">
<span id="flow-tutorial-scenario-simple-voicemail"></span><h3>Simple voicemail<a class="headerlink" href="#simple-voicemail" title="Link to this heading"></a></h3>
<p>Making a outgoing call for forwarding. If call not answered, leave a voicemail.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>               <span class="n">Start</span>
                 <span class="o">|</span>
                 <span class="o">|</span>
             <span class="n">Connect</span><span class="p">(</span><span class="n">Making</span> <span class="n">an</span> <span class="n">outgoing</span> <span class="n">call</span> <span class="k">for</span> <span class="n">forwarding</span><span class="p">)</span>
                 <span class="o">|</span>
                 <span class="o">|</span>
             <span class="n">Condition</span> <span class="n">check</span><span class="p">(</span><span class="n">check</span> <span class="n">the</span> <span class="n">call</span><span class="s1">&#39;s status is Answered)</span>
                 <span class="o">|</span>
                 <span class="o">|</span>
    <span class="o">------------------------------</span>
    <span class="o">|</span>                            <span class="o">|</span>
<span class="n">condition</span> <span class="n">false</span>               <span class="n">condition</span> <span class="n">true</span>
    <span class="o">|</span>                            <span class="o">|</span>
    <span class="o">|</span>                          <span class="n">Hangup</span>
  <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">|</span>
    <span class="o">|</span>
  <span class="n">Beep</span>
    <span class="o">|</span>
    <span class="o">|</span>
 <span class="n">Recording</span> <span class="n">start</span>
    <span class="o">|</span>
    <span class="o">|</span>
  <span class="n">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="n">sec</span><span class="p">)</span>
    <span class="o">|</span>
    <span class="o">|</span>
  <span class="n">Hangup</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connect&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15559876543&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15551112222&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3746e628-8cc1-4ff4-82fe-194b16b9a10e&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;condition_call_status&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;progressing&quot;</span><span class="p">,</span>
                <span class="s2">&quot;false_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;cfe0e8ea-991c-11ec-b849-d7fc54168fd5&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;58f859e9-92d8-4b46-8073-722b9c881ae0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;cfe0e8ea-991c-11ec-b849-d7fc54168fd5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Thank you for your calling. We are busy now. Please leave a message after tone.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;0a9b6f38-ddcd-448b-80a1-ae47ac0e08aa&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;beep&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ad969315-6ac4-4339-b300-566eb6352fea&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;recording_start&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;beep_start&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;8abf3f9d-414c-4a15-aa94-02a799409f48&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">10000</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;e4fc5d9e-9fa8-4b3e-ae77-b55b04c1f2d3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="simple-branch">
<span id="flow-tutorial-scenario-simple-branch"></span><h3>Simple branch<a class="headerlink" href="#simple-branch" title="Link to this heading"></a></h3>
<p>It will get the digits from the call and will execute the branch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>              <span class="n">Start</span>
                <span class="o">|</span>
                <span class="o">|</span>
<span class="o">------------&gt;</span>  <span class="n">Talk</span><span class="p">(</span><span class="s2">&quot;Press 1 for show must go on. Press 2 for bohemian rhapsody. Press 3 for another one bites the dust&quot;</span><span class="p">)</span>
<span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>              <span class="n">Digit</span><span class="p">(</span><span class="n">DTMF</span><span class="p">)</span> <span class="n">receive</span>
<span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>       <span class="o">-----------------------------------------------</span>
<span class="o">|</span>       <span class="o">|</span>           <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
<span class="o">|</span>     <span class="n">default</span>      <span class="s2">&quot;1&quot;</span>              <span class="s2">&quot;2&quot;</span>              <span class="s2">&quot;3&quot;</span>
<span class="o">|</span>       <span class="o">|</span>           <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>           <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>          <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>        <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>        <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">|</span>       <span class="o">|</span>           <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>           <span class="o">|</span>                <span class="o">|</span>                <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>          <span class="n">Hangup</span>          <span class="n">Hangup</span>           <span class="n">Hangup</span>
<span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>      <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">|</span>       <span class="o">|</span>
<span class="o">----</span><span class="n">goto</span><span class="p">(</span><span class="n">loop</span> <span class="mi">3</span> <span class="n">times</span><span class="p">)</span>
        <span class="o">|</span>
        <span class="o">|</span>
       <span class="n">Talk</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="o">|</span>
        <span class="o">|</span>
       <span class="n">Hangup</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;b8781e56-c524-11ec-889f-d37b0dbb7eb8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello. This is branch test. Press 1 for show must go on. Press 2 for bohemian rhapsody. Press 3 for another one bites the dust&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
                <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;branch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;default_target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ed9705ca-c524-11ec-a3fb-8feb7731ad45&quot;</span><span class="p">,</span>
                <span class="s2">&quot;target_ids&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;c3eb8e62-c524-11ec-94c5-abafec8af561&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;dc87123e-c524-11ec-89c6-5fb18da14034&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;e70fb030-c524-11ec-b657-ebec72f097ef&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;c3eb8e62-c524-11ec-94c5-abafec8af561&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Empty spaces, what are we living for? Abandoned places, I guess we know the score, on and on. Does anybody know what we are looking for? Another hero, another mindless crime. Behind the curtain, in the pantomime&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;dc87123e-c524-11ec-89c6-5fb18da14034&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Mama, Just killed a man. Put a gun against his head, pulled my trigger. Now he&#39;s dead. Mama, life had just begun, But now I&#39;ve gone and thrown it all away.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;e70fb030-c524-11ec-b657-ebec72f097ef&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Steve walks warily down the street. With his brim pulled way down low. Ain&#39;t no sound but the sound of his feet. Machine guns ready to go. Are you ready hey are you ready for this?&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ed9705ca-c524-11ec-a3fb-8feb7731ad45&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;You didn&#39;t choose the correct number. Default selected.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;goto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;target_id&quot;</span><span class="p">:</span> <span class="s2">&quot;b8781e56-c524-11ec-889f-d37b0dbb7eb8&quot;</span><span class="p">,</span>
                <span class="s2">&quot;loop_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Loop over. Hangup the call. Thank you, good bye.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hangup&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="simple-message-send">
<span id="flow-tutorial-scenario-simple-message-send"></span><h3>Simple message send<a class="headerlink" href="#simple-message-send" title="Link to this heading"></a></h3>
<p>Send the message to the multiple destinations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Start</span>
  <span class="o">|</span>
  <span class="o">|</span>
<span class="n">Message</span> <span class="n">send</span>
  <span class="o">|</span>
  <span class="o">|</span>
 <span class="n">End</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message_send&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000001&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000002&quot;</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000003&quot;</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000004&quot;</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is test message.&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="simple-message-send-and-make-a-new-outbound-call">
<span id="flow-tutorial-scenario-simple-message-send-and-make-a-new-outbound-call"></span><h3>Simple message send and make a new outbound call<a class="headerlink" href="#simple-message-send-and-make-a-new-outbound-call" title="Link to this heading"></a></h3>
<p>Send the message to the destination and start a new outbound call with talk action.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Start</span>
  <span class="o">|</span>
  <span class="o">|</span>
<span class="n">Message</span> <span class="n">send</span>
  <span class="o">|</span>
  <span class="o">|</span>
<span class="n">Call</span> <span class="o">-------------------</span> <span class="n">Start</span>
  <span class="o">|</span>                        <span class="o">|</span>
  <span class="o">|</span>                        <span class="o">|</span>
 <span class="n">End</span>                      <span class="n">Talk</span>
                           <span class="o">|</span>
                           <span class="o">|</span>
                          <span class="n">End</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message_send&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000001&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000002&quot;</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is test message.&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;call&quot;</span><span class="p">,</span>
                <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000001&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+821100000003&quot;</span>
                        <span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is test message.&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="s2">&quot;female&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="activeflow">
<span id="activeflow-main"></span><h1>Activeflow<a class="headerlink" href="#activeflow" title="Link to this heading"></a></h1>
<section id="activeflow-overview">
<span id="id74"></span><h2>Overview<a class="headerlink" href="#activeflow-overview" title="Link to this heading"></a></h2>
<p>The activeflow is a dynamic entity within the VoIPBIN system that plays a vital role in representing the real-time state of a registered flow. As the flow is executed, it generates an activeflow, which contains an action cursor and relevant status information. This activeflow serves as a control interface, providing efficient management and flexibility during flow execution.</p>
<p>In essence, the activeflow concept is a powerful tool that facilitates the smooth and flexible execution of registered flows. Its dynamic nature allows for real-time updates, ensuring that users can monitor and manage the flow execution efficiently.</p>
<p>By providing real-time status updates and a flexible control interface, the activeflow becomes a valuable tool for businesses to efficiently manage complex workflows and automate their critical processes. The stop functionality adds an extra layer of control and adaptability, allowing users to make informed decisions and optimize their flow executions as required.</p>
<section id="flow-vs-activeflow">
<h3>Flow vs ActiveFlow<a class="headerlink" href="#flow-vs-activeflow" title="Link to this heading"></a></h3>
<p>Understanding the difference between a Flow and an ActiveFlow is essential for working with VoIPBIN.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------------------------------------------------------------------------+</span>
<span class="o">|</span>                        <span class="n">Flow</span> <span class="n">vs</span> <span class="n">ActiveFlow</span>                                <span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------+</span>

<span class="n">Flow</span> <span class="p">(</span><span class="n">Template</span><span class="p">)</span>                         <span class="n">ActiveFlow</span> <span class="p">(</span><span class="n">Running</span> <span class="n">Instance</span><span class="p">)</span>
<span class="o">+-------------------------+</span>            <span class="o">+---------------------------------+</span>
<span class="o">|</span> <span class="n">o</span> <span class="n">Static</span> <span class="n">definition</span>     <span class="o">|</span>            <span class="o">|</span> <span class="n">o</span> <span class="n">Dynamic</span> <span class="n">execution</span> <span class="n">state</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">o</span> <span class="n">Reusable</span> <span class="n">template</span>     <span class="o">|</span>            <span class="o">|</span> <span class="n">o</span> <span class="n">One</span><span class="o">-</span><span class="n">time</span> <span class="n">instance</span>             <span class="o">|</span>
<span class="o">|</span> <span class="n">o</span> <span class="n">Stored</span> <span class="ow">in</span> <span class="n">database</span>    <span class="o">|</span>            <span class="o">|</span> <span class="n">o</span> <span class="n">Tracks</span> <span class="n">current</span> <span class="n">position</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">o</span> <span class="n">No</span> <span class="n">execution</span> <span class="n">state</span>    <span class="o">|</span>            <span class="o">|</span> <span class="n">o</span> <span class="n">Contains</span> <span class="n">variables</span>            <span class="o">|</span>
<span class="o">|</span>                         <span class="o">|</span>            <span class="o">|</span> <span class="n">o</span> <span class="n">Linked</span> <span class="n">to</span> <span class="n">call</span><span class="o">/</span><span class="n">conversation</span>   <span class="o">|</span>
<span class="o">+-------------------------+</span>            <span class="o">+---------------------------------+</span>
           <span class="o">|</span>                                        <span class="o">^</span>
           <span class="o">|</span>     <span class="n">When</span> <span class="n">triggered</span>                     <span class="o">|</span>
           <span class="o">+----------------------------------------+</span>
                    <span class="n">Creates</span>
</pre></div>
</div>
<p><strong>Analogy</strong>: A Flow is like a recipe book. An ActiveFlow is like actually cooking that recipe - you track which step you’re on, what ingredients you’ve used, and the current state of the dish.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Flow</span> <span class="p">(</span><span class="n">Recipe</span> <span class="n">Book</span><span class="p">)</span>                    <span class="n">ActiveFlow</span> <span class="p">(</span><span class="n">Cooking</span> <span class="n">Session</span><span class="p">)</span>
<span class="o">+--------------------+</span>               <span class="o">+--------------------------------+</span>
<span class="o">|</span> <span class="n">Step</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Answer</span>     <span class="o">|</span>               <span class="o">|</span> <span class="n">Step</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Answer</span> <span class="p">(</span><span class="n">done</span><span class="p">)</span>          <span class="o">|</span>
<span class="o">|</span> <span class="n">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Talk</span>       <span class="o">|</span>   <span class="o">------&gt;</span>     <span class="o">|</span> <span class="n">Step</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Talk</span> <span class="o">&lt;--</span> <span class="n">current</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">Step</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Branch</span>     <span class="o">|</span>               <span class="o">|</span> <span class="n">Step</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Branch</span> <span class="p">(</span><span class="n">pending</span><span class="p">)</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">Step</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Hangup</span>     <span class="o">|</span>               <span class="o">|</span> <span class="n">Step</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Hangup</span> <span class="p">(</span><span class="n">pending</span><span class="p">)</span>       <span class="o">|</span>
<span class="o">+--------------------+</span>               <span class="o">|</span>                                <span class="o">|</span>
                                     <span class="o">|</span> <span class="n">Variables</span><span class="p">:</span>                     <span class="o">|</span>
                                     <span class="o">|</span>   <span class="n">caller_id</span><span class="p">:</span> <span class="s2">&quot;+1234567890&quot;</span>     <span class="o">|</span>
                                     <span class="o">|</span>   <span class="n">digits</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span>                  <span class="o">|</span>
                                     <span class="o">+--------------------------------+</span>
</pre></div>
</div>
</section>
<section id="activeflow-states">
<h3>ActiveFlow States<a class="headerlink" href="#activeflow-states" title="Link to this heading"></a></h3>
<p>An activeflow has two possible states during its lifecycle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------------+</span>                              <span class="o">+------------+</span>
<span class="o">|</span>  <span class="n">running</span>   <span class="o">|-----------------------------&gt;|</span>   <span class="n">ended</span>    <span class="o">|</span>
<span class="o">+------------+</span>                              <span class="o">+------------+</span>
      <span class="o">|</span>                                            <span class="o">|</span>
      <span class="o">|</span>                                            <span class="o">|</span>
<span class="n">Actions</span> <span class="n">executing</span>                           <span class="n">Final</span> <span class="n">state</span>
<span class="n">Cursor</span> <span class="n">moving</span>                               <span class="n">No</span> <span class="n">more</span> <span class="n">changes</span>
<span class="n">Variables</span> <span class="n">updating</span>                          <span class="n">History</span> <span class="n">preserved</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Status</p></th>
<th class="head"><p>What it means</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>running</p></td>
<td><p>The activeflow is actively executing actions. The cursor is
moving through the flow, and the state can change at any time.</p></td>
</tr>
<tr class="row-odd"><td><p>ended</p></td>
<td><p>The activeflow has completed. No further execution will occur.
The executed_actions history is preserved for review.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="execution">
<h3>Execution<a class="headerlink" href="#execution" title="Link to this heading"></a></h3>
<p>The activeflow’s significance lies in its ability to manage complex workflows and automate business processes effectively. As the flow progresses through its various stages, the activeflow dynamically represents its current state. This representation provides valuable insights into the flow’s progress and status, enabling efficient and informed management of its execution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                     <span class="n">ActiveFlow</span> <span class="n">Execution</span> <span class="n">Model</span>                         <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Incoming</span> <span class="n">Call</span>           <span class="n">ActiveFlow</span> <span class="n">Created</span>            <span class="n">Execution</span> <span class="n">Begins</span>
     <span class="o">|</span>                        <span class="o">|</span>                            <span class="o">|</span>
     <span class="n">v</span>                        <span class="n">v</span>                            <span class="n">v</span>
<span class="o">+---------+</span>              <span class="o">+---------+</span>                 <span class="o">+-------------+</span>
<span class="o">|</span>  <span class="n">CALL</span>   <span class="o">|-------------&gt;|</span>  <span class="n">NEW</span>    <span class="o">|----------------&gt;|</span>  <span class="n">RUNNING</span>    <span class="o">|</span>
<span class="o">|</span> <span class="n">arrives</span> <span class="o">|</span>              <span class="o">|</span> <span class="n">instance</span><span class="o">|</span>                 <span class="o">|</span>  <span class="n">actions</span>    <span class="o">|</span>
<span class="o">+---------+</span>              <span class="o">+---------+</span>                 <span class="o">+------+------+</span>
                              <span class="o">|</span>                            <span class="o">|</span>
                              <span class="o">|</span>                            <span class="n">v</span>
                              <span class="o">|</span>                      <span class="o">+-----------+</span>
                              <span class="o">|</span>  <span class="n">Variables</span> <span class="nb">set</span><span class="p">:</span>      <span class="o">|</span>  <span class="n">cursor</span>   <span class="o">|</span>
                              <span class="o">|</span>  <span class="n">o</span> <span class="n">reference_type</span>    <span class="o">|</span>  <span class="n">moves</span>    <span class="o">|--+</span>
                              <span class="o">|</span>  <span class="n">o</span> <span class="n">reference_id</span>      <span class="o">+-----------+</span>  <span class="o">|</span>
                              <span class="o">|</span>  <span class="n">o</span> <span class="n">customer_id</span>                      <span class="o">|</span>
                              <span class="o">|</span>  <span class="n">o</span> <span class="n">flow_id</span>                          <span class="o">|</span>
                              <span class="o">+-------------------------------------+</span>
</pre></div>
</div>
<img alt="_images/activeflow_overview_execution.png" src="_images/activeflow_overview_execution.png" />
</section>
<section id="how-the-cursor-works">
<h3>How the Cursor Works<a class="headerlink" href="#how-the-cursor-works" title="Link to this heading"></a></h3>
<p>The activeflow maintains a “cursor” that tracks the current position in the flow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Action</span> <span class="n">Array</span><span class="p">:</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
<span class="o">|</span> <span class="n">answer</span>  <span class="o">|</span>   <span class="o">|</span>  <span class="n">talk</span>   <span class="o">|</span>   <span class="o">|</span> <span class="n">digits</span>  <span class="o">|</span>   <span class="o">|</span> <span class="n">branch</span>  <span class="o">|</span>   <span class="o">|</span> <span class="n">hangup</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">index</span><span class="p">:</span><span class="mi">0</span> <span class="o">|</span>   <span class="o">|</span> <span class="n">index</span><span class="p">:</span><span class="mi">1</span> <span class="o">|</span>   <span class="o">|</span> <span class="n">index</span><span class="p">:</span><span class="mi">2</span> <span class="o">|</span>   <span class="o">|</span> <span class="n">index</span><span class="p">:</span><span class="mi">3</span> <span class="o">|</span>   <span class="o">|</span> <span class="n">index</span><span class="p">:</span><span class="mi">4</span> <span class="o">|</span>
<span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>   <span class="o">+---------+</span>
                   <span class="o">^</span>
                   <span class="o">|</span>
                <span class="n">current_action</span> <span class="p">(</span><span class="n">cursor</span> <span class="ow">is</span> <span class="n">here</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Cursor Movement Rules:</strong></p>
<ol class="arabic simple">
<li><p><strong>Sequential</strong>: By default, cursor moves to the next action in array order</p></li>
<li><p><strong>Jump</strong>: Actions like <code class="docutils literal notranslate"><span class="pre">goto</span></code> and <code class="docutils literal notranslate"><span class="pre">branch</span></code> can jump to any action by ID</p></li>
<li><p><strong>Nested</strong>: Some actions push a new stack (queue_join, ai_talk), cursor enters nested stack</p></li>
<li><p><strong>Return</strong>: When nested stack completes, cursor returns to original position</p></li>
</ol>
</section>
<section id="stack-based-execution">
<h3>Stack-Based Execution<a class="headerlink" href="#stack-based-execution" title="Link to this heading"></a></h3>
<p>ActiveFlows use a stack-based model to handle nested flows (like queue wait flows or AI conversations):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                       <span class="n">Stack</span><span class="o">-</span><span class="n">Based</span> <span class="n">Execution</span>                            <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Main</span> <span class="n">Stack</span>                          <span class="n">Nested</span> <span class="n">Stack</span> <span class="p">(</span><span class="kn">from</span><span class="w"> </span><span class="nn">queue_join</span><span class="p">)</span>
<span class="o">+---------------------+</span>            <span class="o">+---------------------------------+</span>
<span class="o">|</span> <span class="mf">1.</span> <span class="n">answer</span>           <span class="o">|</span>            <span class="o">|</span>                                 <span class="o">|</span>
<span class="o">|</span> <span class="mf">2.</span> <span class="n">queue_join</span> <span class="o">======+============&gt;</span> <span class="n">wait_flow</span> <span class="n">actions</span><span class="p">:</span>              <span class="o">|</span>
<span class="o">|</span> <span class="mf">3.</span> <span class="n">talk</span> <span class="s2">&quot;connected&quot;</span> <span class="o">|</span>            <span class="o">|</span>   <span class="n">o</span> <span class="n">talk</span> <span class="s2">&quot;Please hold...&quot;</span>       <span class="o">|</span>
<span class="o">|</span> <span class="mf">4.</span> <span class="n">hangup</span>           <span class="o">|</span>            <span class="o">|</span>   <span class="n">o</span> <span class="n">play</span> <span class="n">music</span><span class="o">.</span><span class="n">mp3</span>              <span class="o">|</span>
<span class="o">+---------------------+</span>            <span class="o">|</span>   <span class="n">o</span> <span class="p">(</span><span class="n">loops</span> <span class="n">until</span> <span class="n">agent</span> <span class="n">answers</span><span class="p">)</span> <span class="o">|</span>
       <span class="o">^</span>                           <span class="o">+---------------------------------+</span>
       <span class="o">|</span>                                         <span class="o">|</span>
       <span class="o">|</span>    <span class="n">When</span> <span class="n">agent</span> <span class="n">answers</span><span class="p">,</span>                  <span class="o">|</span>
       <span class="o">+-----------------------------------------+</span>
             <span class="k">return</span> <span class="n">to</span> <span class="n">main</span> <span class="n">stack</span>
</pre></div>
</div>
<p><strong>Stack Map Structure:</strong></p>
<p>The activeflow maintains a <code class="docutils literal notranslate"><span class="pre">stack_map</span></code> that tracks all stacks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stack_map</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;main&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="n">actions</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span>
        <span class="n">current_index</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">return_stack</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="n">return_action</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">},</span>
    <span class="s2">&quot;queue-wait-abc123&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="n">actions</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="n">wait</span> <span class="n">flow</span> <span class="n">actions</span><span class="o">...</span><span class="p">],</span>
        <span class="n">current_index</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">return_stack</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
        <span class="n">return_action</span><span class="p">:</span> <span class="s2">&quot;talk connected&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="reference-types">
<h3>Reference Types<a class="headerlink" href="#reference-types" title="Link to this heading"></a></h3>
<p>Each activeflow is linked to a reference - the entity that triggered it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">ActiveFlow</span> <span class="n">Reference</span> <span class="n">Types</span>                       <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------+</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reference Type</p></th>
<th class="head"><p>When it’s used</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>call</p></td>
<td><p>Flow was triggered by an incoming or outgoing call</p></td>
</tr>
<tr class="row-odd"><td><p>conversation</p></td>
<td><p>Flow was triggered by a message in a conversation</p></td>
</tr>
<tr class="row-even"><td><p>api</p></td>
<td><p>Flow was triggered directly via API call</p></td>
</tr>
<tr class="row-odd"><td><p>campaign</p></td>
<td><p>Flow was triggered by an outbound campaign</p></td>
</tr>
<tr class="row-even"><td><p>transcribe</p></td>
<td><p>Flow was triggered for transcription processing</p></td>
</tr>
<tr class="row-odd"><td><p>recording</p></td>
<td><p>Flow was triggered for recording processing</p></td>
</tr>
<tr class="row-even"><td><p>ai</p></td>
<td><p>Flow was triggered for AI processing</p></td>
</tr>
</tbody>
</table>
<p><strong>Reference Impact on Actions:</strong></p>
<p>The reference type determines which actions are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Reference</span><span class="p">:</span> <span class="n">call</span>                     <span class="n">Reference</span><span class="p">:</span> <span class="n">api</span>
<span class="o">+-------------------------+</span>        <span class="o">+-------------------------+</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">answer</span>          <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">answer</span> <span class="p">(</span><span class="n">no</span> <span class="n">call</span><span class="p">)</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">talk</span>            <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">talk</span> <span class="p">(</span><span class="n">no</span> <span class="n">media</span><span class="p">)</span>     <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">digits_receive</span>  <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">digits_receive</span>      <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">recording_start</span> <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">recording_start</span>     <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">message_send</span>    <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">message_send</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">email_send</span>      <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">email_send</span>      <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">webhook_send</span>    <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">webhook_send</span>    <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">variable_set</span>    <span class="o">|</span>        <span class="o">|</span> <span class="p">(</span><span class="n">check</span><span class="p">)</span> <span class="n">variable_set</span>    <span class="o">|</span>
<span class="o">+-------------------------+</span>        <span class="o">+-------------------------+</span>
</pre></div>
</div>
<p>When an action is not available for the reference type, it is skipped and execution continues to the next action.</p>
</section>
<section id="status-and-control-interface">
<h3>Status and Control interface<a class="headerlink" href="#status-and-control-interface" title="Link to this heading"></a></h3>
<p>The activeflow includes essential status information that allows users to monitor the flow’s progress closely. This information encompasses details about the activeflow’s current state, including completed and pending actions. Additionally, the activeflow offers a control interface that empowers users to manage the execution process. This interface enables actions such as stopping the activeflow at any point and modifying its configuration or parameters as needed.</p>
<p><strong>Control API Endpoints:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">ActiveFlow</span> <span class="n">Control</span> <span class="n">Interface</span>                        <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">GET</span> <span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span>
<span class="o">+--</span> <span class="n">View</span> <span class="n">current</span> <span class="n">state</span>
<span class="o">+--</span> <span class="n">See</span> <span class="n">current_action</span>
<span class="o">+--</span> <span class="n">Review</span> <span class="n">executed_actions</span>
<span class="o">+--</span> <span class="n">Check</span> <span class="n">variables</span>

<span class="n">POST</span> <span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">execute</span>
<span class="o">+--</span> <span class="n">Resume</span> <span class="n">a</span> <span class="n">blocked</span> <span class="n">flow</span>
<span class="o">+--</span> <span class="n">Push</span> <span class="n">new</span> <span class="n">actions</span>
<span class="o">+--</span> <span class="n">Continue</span> <span class="n">execution</span>

<span class="n">POST</span> <span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="o">/</span><span class="n">stop</span>
<span class="o">+--</span> <span class="n">Immediately</span> <span class="n">stop</span> <span class="n">execution</span>
<span class="o">+--</span> <span class="n">Status</span> <span class="n">changes</span> <span class="n">to</span> <span class="s2">&quot;ended&quot;</span>
<span class="o">+--</span> <span class="n">Triggers</span> <span class="n">on_complete_flow</span> <span class="k">if</span> <span class="nb">set</span>
</pre></div>
</div>
</section>
<section id="activeflow-lifecycle">
<h3>Activeflow Lifecycle<a class="headerlink" href="#activeflow-lifecycle" title="Link to this heading"></a></h3>
<p>The activeflow executes the actions until one of the following conditions is met:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                  <span class="n">ActiveFlow</span> <span class="n">Termination</span> <span class="n">Conditions</span>                     <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Condition</span> <span class="mi">1</span><span class="p">:</span> <span class="n">End</span> <span class="n">of</span> <span class="n">Actions</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---------+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="mi">3</span> <span class="o">|--&gt;|</span>  <span class="n">DONE</span>   <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">Status</span><span class="p">:</span> <span class="n">ended</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---------+</span>

<span class="n">Condition</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Stop</span> <span class="n">Action</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+------+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="n">stop</span> <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">Status</span><span class="p">:</span> <span class="n">ended</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+------+</span>

<span class="n">Condition</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Reference</span> <span class="n">Ends</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span> <span class="n">call</span> <span class="n">hangup</span><span class="p">)</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="n">X</span> <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">Call</span> <span class="n">hangup</span> <span class="o">-&gt;</span> <span class="n">Status</span><span class="p">:</span> <span class="n">ended</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>

<span class="n">Condition</span> <span class="mi">4</span><span class="p">:</span> <span class="n">API</span> <span class="n">Stop</span> <span class="n">Request</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="mi">3</span> <span class="o">|</span>  <span class="o">+</span> <span class="n">POST</span> <span class="o">/</span><span class="n">stop</span> <span class="o">-&gt;</span> <span class="n">Status</span><span class="p">:</span> <span class="n">ended</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Main Service Type Completion:</strong> The activeflow continues executing flow actions until the primary service type is completed. For instance, in the case of a call service, actions will be executed until the call is hung up.</p></li>
<li><p><strong>Stop Action Execution:</strong> Execution ceases if an action with the type “stop” is encountered in the flow.</p></li>
<li><p><strong>User-Initiated Interruption:</strong> Users can actively interrupt their activeflow by sending a POST request to the endpoint: <a class="reference external" href="https://api.voipbin.net/v1/activeflows">https://api.voipbin.net/v1/activeflows</a>/&lt;activeflow-id&gt;/stop.</p></li>
</ul>
</section>
<section id="variable-management">
<h3>Variable Management<a class="headerlink" href="#variable-management" title="Link to this heading"></a></h3>
<p>Each activeflow maintains its own set of variables that persist throughout execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">ActiveFlow</span> <span class="n">Variable</span> <span class="n">Storage</span>                         <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">ActiveFlow</span><span class="p">:</span> <span class="n">abc</span><span class="o">-</span><span class="mi">123</span><span class="o">-</span><span class="k">def</span>
<span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">Variables</span> <span class="n">Map</span>                                                          <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------------+</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">id</span>           <span class="o">|</span> <span class="s2">&quot;abc-123-def&quot;</span>                     <span class="o">|</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">activeflow</span><span class="o">.</span><span class="n">reference_id</span> <span class="o">|</span> <span class="s2">&quot;call-456&quot;</span>                        <span class="o">|</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">digits</span>             <span class="o">|</span> <span class="s2">&quot;2&quot;</span>                               <span class="o">|</span>
<span class="o">|</span> <span class="n">voipbin</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">caller_id</span>          <span class="o">|</span> <span class="s2">&quot;+14155551234&quot;</span>                    <span class="o">|</span>
<span class="o">|</span> <span class="n">customer</span><span class="o">.</span><span class="n">language</span>               <span class="o">|</span> <span class="s2">&quot;en-US&quot;</span>                           <span class="o">|</span>
<span class="o">|</span> <span class="n">customer</span><span class="o">.</span><span class="n">tier</span>                   <span class="o">|</span> <span class="s2">&quot;premium&quot;</span>                         <span class="o">|</span>
<span class="o">+---------------------------------+-------------------------------------+</span>
</pre></div>
</div>
<p><strong>Variable Lifecycle:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Created when activeflow starts (built-in variables)
      |
      v
2. Updated by actions (digits_receive, variable_set, fetch)
      |
      v
3. Read by actions (branch, condition_variable, talk with ${var})
      |
      v
4. Inherited by on_complete_flow (if configured)
      |
      v
5. Preserved in database when activeflow ends
</pre></div>
</div>
</section>
<section id="executed-actions">
<h3>Executed Actions<a class="headerlink" href="#executed-actions" title="Link to this heading"></a></h3>
<p>Within the CPaaS environment, flows can be complex, incorporating various service types such as call, SMS, chat, and more. Handling history logs for these diverse services requires a structured approach.</p>
<p>VoIPBIN simplifies the tracking of executed actions by providing a comprehensive history log within the activeflow. Unlike traditional telephony services with straightforward flows, CPaaS services demand a more flexible approach due to their diverse nature.</p>
<p>In VoIPBIN, each action in the activeflow defines a distinct step in the service’s behavior. This ensures clarity in tracking the sequence of actions performed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">Executed</span> <span class="n">Actions</span> <span class="n">History</span>                            <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Time</span> <span class="o">----------------------------------------------------------------------&gt;</span>

<span class="o">+----------+</span>   <span class="o">+----------+</span>   <span class="o">+----------+</span>   <span class="o">+----------+</span>
<span class="o">|</span> <span class="n">answer</span>   <span class="o">|--&gt;|</span> <span class="n">talk</span>     <span class="o">|--&gt;|</span> <span class="n">connect</span>  <span class="o">|--&gt;|</span> <span class="n">message</span>  <span class="o">|</span>
<span class="o">|</span> <span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span> <span class="o">|</span>   <span class="o">|</span> <span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span> <span class="o">|</span>   <span class="o">|</span> <span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">15</span> <span class="o">|</span>   <span class="o">|</span> <span class="mi">10</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">45</span> <span class="o">|</span>
<span class="o">+----------+</span>   <span class="o">+----------+</span>   <span class="o">+----------+</span>   <span class="o">+----------+</span>
     <span class="n">v</span>              <span class="n">v</span>              <span class="n">v</span>              <span class="n">v</span>
<span class="o">+---------------------------------------------------------+</span>
<span class="o">|</span>              <span class="n">executed_actions</span> <span class="n">array</span>                      <span class="o">|</span>
<span class="o">+---------------------------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;executed_actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;connect&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15559876543&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15551112222&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;605f5650-ba92-4dcd-bdac-91fcf6260939&quot;</span><span class="p">,</span>
            <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;message_send&quot;</span><span class="p">,</span>
            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;hello, this is a test message.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+15559876543&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;destinations&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;+31616818985&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the detailed information provided in the executed_actions array, customers can easily review and understand the history logs of their CPaaS services.</p>
</section>
<section id="on-complete-flow">
<h3>On Complete Flow<a class="headerlink" href="#on-complete-flow" title="Link to this heading"></a></h3>
<p>When an activeflow ends, it can trigger another flow automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">On</span> <span class="n">Complete</span> <span class="n">Flow</span> <span class="n">Chain</span>                              <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">ActiveFlow</span> <span class="n">A</span>                             <span class="n">ActiveFlow</span> <span class="n">B</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
<span class="o">|</span> <span class="n">on_complete_flow_id</span><span class="p">:</span> <span class="n">B</span>  <span class="o">|</span>             <span class="o">|</span> <span class="n">Created</span> <span class="n">automatically</span>   <span class="o">|</span>
<span class="o">|</span>                         <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span> <span class="n">status</span><span class="p">:</span> <span class="s2">&quot;ended&quot;</span>         <span class="o">|------------&gt;|</span> <span class="n">status</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span>       <span class="o">|</span>
<span class="o">|</span>                         <span class="o">|</span>             <span class="o">|</span>                         <span class="o">|</span>
<span class="o">|</span> <span class="n">Variables</span><span class="p">:</span>              <span class="o">|</span>  <span class="n">inherited</span>  <span class="o">|</span> <span class="n">Variables</span><span class="p">:</span>              <span class="o">|</span>
<span class="o">|</span>   <span class="n">call_id</span><span class="p">:</span> <span class="s2">&quot;123&quot;</span>        <span class="o">|------------&gt;|</span>   <span class="n">call_id</span><span class="p">:</span> <span class="s2">&quot;123&quot;</span>        <span class="o">|</span>
<span class="o">|</span>   <span class="n">recording_id</span><span class="p">:</span> <span class="s2">&quot;456&quot;</span>   <span class="o">|</span>             <span class="o">|</span>   <span class="n">recording_id</span><span class="p">:</span> <span class="s2">&quot;456&quot;</span>   <span class="o">|</span>
<span class="o">+-------------------------+</span>             <span class="o">+-------------------------+</span>
</pre></div>
</div>
<p><strong>Key Behaviors:</strong></p>
<ul class="simple">
<li><p>New activeflow is created with a new ID</p></li>
<li><p>Variables are copied from parent to child</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference_activeflow_id</span></code> is set to parent’s ID (tracks the chain)</p></li>
<li><p>Maximum chain depth is 5 (prevents infinite loops)</p></li>
</ul>
</section>
<section id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading"></a></h3>
<p>ActiveFlows handle errors gracefully to ensure reliable execution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------------------------------------------------------------+</span>
<span class="o">|</span>                    <span class="n">Error</span> <span class="n">Handling</span> <span class="n">Scenarios</span>                            <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------+</span>

<span class="n">Scenario</span><span class="p">:</span> <span class="n">Action</span> <span class="n">fails</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+-----+</span>   <span class="o">+---+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="n">ERR</span> <span class="o">|--&gt;|</span> <span class="mi">4</span> <span class="o">|</span>  <span class="p">(</span><span class="n">skip</span> <span class="n">failed</span> <span class="n">action</span><span class="p">,</span> <span class="k">continue</span><span class="p">)</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+-----+</span>   <span class="o">+---+</span>

<span class="n">Scenario</span><span class="p">:</span> <span class="n">Critical</span> <span class="n">failure</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+-----+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|--&gt;|</span> <span class="mi">2</span> <span class="o">|--&gt;|</span> <span class="n">ERR</span> <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">Status</span><span class="p">:</span> <span class="n">ended</span> <span class="p">(</span><span class="n">flow</span> <span class="n">stops</span><span class="p">)</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+-----+</span>

<span class="n">Scenario</span><span class="p">:</span> <span class="n">Max</span> <span class="n">iterations</span> <span class="n">exceeded</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>
<span class="o">|</span> <span class="mi">1</span> <span class="o">|&lt;-&gt;|</span> <span class="mi">2</span> <span class="o">|&lt;-&gt;|</span> <span class="mi">3</span> <span class="o">|&lt;-&gt;|</span> <span class="n">X</span> <span class="o">|</span>  <span class="o">-&gt;</span> <span class="n">Infinite</span> <span class="n">loop</span> <span class="n">detected</span><span class="p">,</span> <span class="n">stop</span>
<span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>   <span class="o">+---+</span>
</pre></div>
</div>
<p><strong>Safety Limits:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Limit</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Max iterations per cycle</p></td>
<td><p>1000</p></td>
<td><p>Prevents infinite loops in goto/branch</p></td>
</tr>
<tr class="row-odd"><td><p>Max total execute calls</p></td>
<td><p>100</p></td>
<td><p>Prevents runaway execution</p></td>
</tr>
<tr class="row-even"><td><p>Max on_complete chain depth</p></td>
<td><p>5</p></td>
<td><p>Prevents infinite flow chaining</p></td>
</tr>
</tbody>
</table>
</section>
<section id="common-use-cases">
<h3>Common Use Cases<a class="headerlink" href="#common-use-cases" title="Link to this heading"></a></h3>
<p><strong>Use Case 1: IVR Menu with History Tracking</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">executed_actions</span> <span class="n">shows</span> <span class="n">the</span> <span class="n">complete</span> <span class="n">journey</span><span class="p">:</span>                        <span class="o">|</span>
<span class="o">|</span>                                                                     <span class="o">|</span>
<span class="o">|</span> <span class="mf">1.</span> <span class="n">answer</span> <span class="o">--&gt;</span> <span class="mf">2.</span> <span class="n">talk</span> <span class="s2">&quot;Welcome&quot;</span> <span class="o">--&gt;</span> <span class="mf">3.</span> <span class="n">digits</span> <span class="s2">&quot;2&quot;</span> <span class="o">--&gt;</span> <span class="mf">4.</span> <span class="n">branch</span>    <span class="o">|</span>
<span class="o">|</span>      <span class="o">--&gt;</span> <span class="mf">5.</span> <span class="n">talk</span> <span class="s2">&quot;Support&quot;</span> <span class="o">--&gt;</span> <span class="mf">6.</span> <span class="n">queue_join</span> <span class="o">--&gt;</span> <span class="mf">7.</span> <span class="n">connect</span> <span class="n">agent</span>  <span class="o">|</span>
<span class="o">+--------------------------------------------------------------------+</span>
</pre></div>
</div>
<p><strong>Use Case 2: Post-Call Processing</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Call</span> <span class="n">Flow</span> <span class="n">ActiveFlow</span>                <span class="n">After</span> <span class="n">Call</span> <span class="n">Work</span> <span class="n">ActiveFlow</span>
<span class="o">+----------------------+</span>           <span class="o">+------------------------------+</span>
<span class="o">|</span> <span class="n">answer</span>               <span class="o">|</span>           <span class="o">|</span> <span class="n">fetch</span> <span class="n">recording</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">talk</span>                 <span class="o">|</span>           <span class="o">|</span> <span class="n">ai_summarize</span>                 <span class="o">|</span>
<span class="o">|</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">agent</span>     <span class="o">|</span>           <span class="o">|</span> <span class="n">webhook_send</span> <span class="n">summary</span>         <span class="o">|</span>
<span class="o">|</span> <span class="p">(</span><span class="n">call</span> <span class="n">ends</span><span class="p">)</span>          <span class="o">|----------&gt;|</span> <span class="n">email_send</span> <span class="n">transcript</span>        <span class="o">|</span>
<span class="o">|</span>                      <span class="o">|</span>           <span class="o">|</span>                              <span class="o">|</span>
<span class="o">|</span> <span class="n">on_complete</span><span class="p">:</span> <span class="s2">&quot;acw&quot;</span>   <span class="o">|</span>           <span class="o">|</span> <span class="n">Inherits</span><span class="p">:</span> <span class="n">recording_id</span><span class="p">,</span>      <span class="o">|</span>
<span class="o">+----------------------+</span>           <span class="o">|</span>           <span class="n">call_id</span>            <span class="o">|</span>
                                   <span class="o">+------------------------------+</span>
</pre></div>
</div>
<p><strong>Use Case 3: Debugging Flow Execution</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GET</span> <span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">activeflows</span><span class="o">/</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span>

<span class="n">Response</span> <span class="n">shows</span><span class="p">:</span>
<span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>
    <span class="s2">&quot;current_action&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">5000</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;executed_actions&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;answer&quot;</span><span class="p">,</span> <span class="o">...</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Welcome&quot;</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;voipbin.call.caller_id&quot;</span><span class="p">:</span> <span class="s2">&quot;+14155551234&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">-&gt;</span> <span class="n">You</span> <span class="n">can</span> <span class="n">see</span> <span class="n">exactly</span> <span class="n">where</span> <span class="n">the</span> <span class="n">flow</span> <span class="ow">is</span> <span class="ow">and</span> <span class="n">what</span> <span class="n">has</span> <span class="n">happened</span>
</pre></div>
</div>
</section>
</section>
<section id="activeflow-struct-activeflow">
<span id="id75"></span><h2>Activeflow<a class="headerlink" href="#activeflow-struct-activeflow" title="Link to this heading"></a></h2>
<section id="activeflow-struct-activeflow-activeflow">
<span id="id76"></span><h3>Activeflow<a class="headerlink" href="#activeflow-struct-activeflow-activeflow" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference_type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;current_action&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span>
    <span class="p">},</span>
    <span class="s2">&quot;forward_action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_create&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_update&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_delete&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>id: Activeflow’s ID.</p></li>
<li><p>customer_id: Customer’s ID.</p></li>
<li><p>flow_id: Flow’s ID.</p></li>
<li><p><em>status</em>: Activeflow’s status. See detail <a class="reference internal" href="#activeflow-struct-activeflow-status"><span class="std std-ref">here</span></a>.</p></li>
<li><p><em>reference_type</em>: Represent which resource started activeflow.</p></li>
<li><p>reference_id: Referenced type’s ID.</p></li>
<li><p>current_action: Currently running action on this activeflow. See detail <a class="reference internal" href="flow_struct_action.html#flow-struct-action-action"><span class="std std-ref">here</span></a>.</p></li>
<li><p>forward_action_id: Forward action id.</p></li>
</ul>
<section id="id77">
<h4>Example<a class="headerlink" href="#id77" title="Link to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;6f18ae1c-ddf8-413b-9572-ad30574604ef&quot;</span><span class="p">,</span>
    <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="s2">&quot;5e4a0680-804e-11ec-8477-2fea5968d85b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="s2">&quot;93993ae1-0408-4639-ad5f-1288aa8d4325&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ended&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference_type&quot;</span><span class="p">:</span> <span class="s2">&quot;call&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference_id&quot;</span><span class="p">:</span> <span class="s2">&quot;fd581a20-2606-47fd-a7e8-6bba7c294170&quot;</span><span class="p">,</span>
    <span class="s2">&quot;current_action&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;93ebcadb-ecae-4291-8d49-ca81a926b8b3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;next_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;digits_receive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">5000</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;forward_action_id&quot;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_create&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-04-06 14:53:12.569073&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_update&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-04-06 14:54:24.652558&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tm_delete&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-01-01 00:00:00.000000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="status">
<span id="activeflow-struct-activeflow-status"></span><h3>Status<a class="headerlink" href="#status" title="Link to this heading"></a></h3>
<p>Activeflow’s status.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EMPTY</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>running</p></td>
<td><p>Activeflow is running.</p></td>
</tr>
<tr class="row-even"><td><p>ended</p></td>
<td><p>Activeflow has stopped.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reference-type">
<h3>Reference type<a class="headerlink" href="#reference-type" title="Link to this heading"></a></h3>
<p>Triggered resource.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EMPTY</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>call</p></td>
<td><p>Call resource started the activeflow.</p></td>
</tr>
<tr class="row-even"><td><p>sms</p></td>
<td><p>SMS resource started the activeflow.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tutorial">
<span id="activeflow-tutorial"></span><h2>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h2>
<section id="get-activeflow-list">
<h3>Get activeflow list<a class="headerlink" href="#get-activeflow-list" title="Link to this heading"></a></h3>
<p>Getting a list of activeflows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k --location --request GET &#39;https://api.voipbin.net/v1.0/activeflows?token=&lt;YOUR_AUTH_TOKEN&gt;&#39;

{
    &quot;result&quot;: [
        {
            &quot;id&quot;: &quot;6f18ae1c-ddf8-413b-9572-ad30574604ef&quot;,
            &quot;customer_id&quot;: &quot;5e4a0680-804e-11ec-8477-2fea5968d85b&quot;,
            &quot;flow_id&quot;: &quot;93993ae1-0408-4639-ad5f-1288aa8d4325&quot;,
            &quot;status&quot;: &quot;ended&quot;,
            &quot;reference_type&quot;: &quot;call&quot;,
            &quot;reference_id&quot;: &quot;fd581a20-2606-47fd-a7e8-6bba7c294170&quot;,
            &quot;current_action&quot;: {
                &quot;id&quot;: &quot;93ebcadb-ecae-4291-8d49-ca81a926b8b3&quot;,
                &quot;next_id&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;,
                &quot;type&quot;: &quot;digits_receive&quot;,
                &quot;option&quot;: {
                    &quot;length&quot;: 1,
                    &quot;duration&quot;: 5000
                }
            },
            &quot;forward_action_id&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;,
            &quot;tm_create&quot;: &quot;2023-04-06 14:53:12.569073&quot;,
            &quot;tm_update&quot;: &quot;2023-04-06 14:54:24.652558&quot;,
            &quot;tm_delete&quot;: &quot;9999-01-01 00:00:00.000000&quot;
        },
        ...
    ],
    &quot;next_page_token&quot;: &quot;2023-04-02 13:43:30.576077&quot;
}
</pre></div>
</div>
</section>
<section id="stop-activeflow">
<h3>Stop activeflow<a class="headerlink" href="#stop-activeflow" title="Link to this heading"></a></h3>
<p>Stop the activeflow.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl --location --request POST &#39;https://api.voipbin.net/v1.0/activeflows/1cb0566c-6aa5-45fd-beb7-e71a968075ea/stop?token=&lt;YOUR_AUTH_TOKEN&gt;&#39;

{
    &quot;id&quot;: &quot;1cb0566c-6aa5-45fd-beb7-e71a968075ea&quot;,
    &quot;customer_id&quot;: &quot;5e4a0680-804e-11ec-8477-2fea5968d85b&quot;,
    &quot;flow_id&quot;: &quot;93993ae1-0408-4639-ad5f-1288aa8d4325&quot;,
    &quot;status&quot;: &quot;ended&quot;,
    &quot;reference_type&quot;: &quot;call&quot;,
    &quot;reference_id&quot;: &quot;cd40b5f5-dafc-43e6-9b70-38edc1155a0f&quot;,
    &quot;current_action&quot;: {
        &quot;id&quot;: &quot;f9720d64-a8a8-11ed-8853-3f29a447aac1&quot;,
        &quot;next_id&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;,
        &quot;type&quot;: &quot;talk&quot;,
        &quot;option&quot;: {
            &quot;text&quot;: &quot;Hello. Welcome to the VoIPBIN service. Please select a service. For simple talk, press 1. For simple transcribe, press 2. For queue join, press 3. For voicemail, press 4. For conference, press 5. For chatbot talk, press 6. To contact support, press 0.&quot;,
            &quot;gender&quot;: &quot;female&quot;,
            &quot;language&quot;: &quot;en-US&quot;,
            &quot;digits_handle&quot;: &quot;next&quot;
        }
    },
    &quot;forward_action_id&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;,
    &quot;tm_create&quot;: &quot;2023-04-07 17:23:33.665475&quot;,
    &quot;tm_update&quot;: &quot;2023-04-07 17:23:52.561527&quot;,
    &quot;tm_delete&quot;: &quot;9999-01-01 00:00:00.000000&quot;
}
</pre></div>
</div>
</section>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="restful_api.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>RESTful API(Application Programming Interface)
    </a>
    <a class="float-right" href="variable.html" title="Next">
        Variable <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Flow</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#how-the-flow-works">How the flow works</a></li>
<li><a class="reference internal" href="#understanding-flow-execution">Understanding Flow Execution</a></li>
<li><a class="reference internal" href="#action-execution-patterns">Action Execution Patterns</a></li>
<li><a class="reference internal" href="#branching-and-decision-making">Branching and Decision Making</a></li>
<li><a class="reference internal" href="#the-variable-system">The Variable System</a></li>
<li><a class="reference internal" href="#unified-flow">Unified flow</a></li>
<li><a class="reference internal" href="#non-linear-action-execution">Non-linear action execution</a></li>
<li><a class="reference internal" href="#flow-fork">Flow fork</a></li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#flow-execution">Flow execution</a><ul>
<li><a class="reference internal" href="#incoming-outgoing-calls">Incoming/Outgoing Calls</a></li>
<li><a class="reference internal" href="#received-messages">Received Messages</a></li>
<li><a class="reference internal" href="#outbound-campaigns">Outbound Campaigns</a></li>
<li><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-lifecycle">Flow Lifecycle</a></li>
<li><a class="reference internal" href="#flow-actions-and-interrupt-actions">Flow Actions and Interrupt Actions</a><ul>
<li><a class="reference internal" href="#standard-flow-actions">Standard Flow Actions</a></li>
<li><a class="reference internal" href="#interrupt-actions">Interrupt Actions</a></li>
<li><a class="reference internal" href="#how-interrupt-actions-work">How Interrupt Actions Work</a></li>
<li><a class="reference internal" href="#integration-and-best-practices">Integration and Best Practices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-on-complete-flow-id">The on complete flow id</a><ul>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
</ul>
</li>
<li><a class="reference internal" href="#execution-limits">Execution limits</a></li>
<li><a class="reference internal" href="#behavior-on-termination">Behavior on termination</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#error-handling-in-flows">Error Handling in Flows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-struct-flow">Flow</a><ul>
<li><a class="reference internal" href="#flow-struct-flow-flow">Flow</a></li>
<li><a class="reference internal" href="#type">Type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action">Action</a><ul>
<li><a class="reference internal" href="#flow-struct-action-action">Action</a></li>
<li><a class="reference internal" href="#flow-struct-action-type">Type</a></li>
<li><a class="reference internal" href="#agent-call">Agent Call</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#id5">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#amd">AMD</a><ul>
<li><a class="reference internal" href="#id6">Parameters</a></li>
<li><a class="reference internal" href="#machine-handle">Machine handle</a></li>
<li><a class="reference internal" href="#id7">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#answer">Answer</a><ul>
<li><a class="reference internal" href="#id8">Parameters</a></li>
<li><a class="reference internal" href="#id9">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#beep">Beep</a><ul>
<li><a class="reference internal" href="#id10">Parameters</a></li>
<li><a class="reference internal" href="#id11">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#branch">Branch</a><ul>
<li><a class="reference internal" href="#id12">Parameters</a></li>
<li><a class="reference internal" href="#id13">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#call">Call</a><ul>
<li><a class="reference internal" href="#id14">Parameters</a></li>
<li><a class="reference internal" href="#id15">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chatbot-talk">Chatbot Talk</a><ul>
<li><a class="reference internal" href="#id16">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#confbridge-join">Confbridge Join</a><ul>
<li><a class="reference internal" href="#id17">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#condition-call-digits">Condition Call Digits</a><ul>
<li><a class="reference internal" href="#id18">Parameters</a></li>
<li><a class="reference internal" href="#id19">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#condition-call-status">Condition Call Status</a><ul>
<li><a class="reference internal" href="#id20">Parameters</a></li>
<li><a class="reference internal" href="#id21">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#condition-datetime">Condition Datetime</a><ul>
<li><a class="reference internal" href="#id22">Parameters</a></li>
<li><a class="reference internal" href="#id23">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#condition-variable">Condition Variable</a><ul>
<li><a class="reference internal" href="#id24">Parameters</a></li>
<li><a class="reference internal" href="#id25">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conference-join">Conference Join</a><ul>
<li><a class="reference internal" href="#id26">Parameters</a></li>
<li><a class="reference internal" href="#id27">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#connect">Connect</a><ul>
<li><a class="reference internal" href="#id28">Parameters</a></li>
<li><a class="reference internal" href="#id29">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conversation-send">Conversation send</a><ul>
<li><a class="reference internal" href="#id30">Parameters</a></li>
<li><a class="reference internal" href="#id31">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#digits-receive">Digits Receive</a><ul>
<li><a class="reference internal" href="#id32">Parameters</a></li>
<li><a class="reference internal" href="#id33">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#digits-send">Digits Send</a><ul>
<li><a class="reference internal" href="#id34">Parameters</a></li>
<li><a class="reference internal" href="#id35">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#echo">Echo</a><ul>
<li><a class="reference internal" href="#id36">Parameters</a></li>
<li><a class="reference internal" href="#id37">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-media-start">External Media Start</a><ul>
<li><a class="reference internal" href="#id38">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-media-stop">External Media Stop</a><ul>
<li><a class="reference internal" href="#id39">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fetch">Fetch</a><ul>
<li><a class="reference internal" href="#id40">Parameters</a></li>
<li><a class="reference internal" href="#id41">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fetch-flow">Fetch Flow</a><ul>
<li><a class="reference internal" href="#id42">Parameters</a></li>
<li><a class="reference internal" href="#id43">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#goto">Goto</a><ul>
<li><a class="reference internal" href="#id44">Parameters</a></li>
<li><a class="reference internal" href="#id45">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hangup">Hangup</a><ul>
<li><a class="reference internal" href="#id46">Parameters</a></li>
<li><a class="reference internal" href="#id47">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hangup-relay">Hangup Relay</a><ul>
<li><a class="reference internal" href="#id48">Parameters</a></li>
<li><a class="reference internal" href="#id49">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#message-send">Message send</a><ul>
<li><a class="reference internal" href="#id50">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#play">Play</a><ul>
<li><a class="reference internal" href="#id51">Parameters</a></li>
<li><a class="reference internal" href="#id52">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#queue-join">Queue Join</a><ul>
<li><a class="reference internal" href="#id53">Parameters</a></li>
<li><a class="reference internal" href="#id54">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recording-start">Recording Start</a><ul>
<li><a class="reference internal" href="#id55">Parameters</a></li>
<li><a class="reference internal" href="#id56">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recording-stop">Recording Stop</a><ul>
<li><a class="reference internal" href="#id57">Parameters</a></li>
<li><a class="reference internal" href="#id58">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sleep">Sleep</a><ul>
<li><a class="reference internal" href="#id59">Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stream-echo">Stream Echo</a><ul>
<li><a class="reference internal" href="#id60">Parameters</a></li>
<li><a class="reference internal" href="#id61">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#talk">Talk</a><ul>
<li><a class="reference internal" href="#id62">Parameters</a></li>
<li><a class="reference internal" href="#digits-handle">Digits handle</a></li>
<li><a class="reference internal" href="#id63">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transcribe-recording">Transcribe recording</a><ul>
<li><a class="reference internal" href="#id64">Parameters</a></li>
<li><a class="reference internal" href="#id65">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transcribe-start">Transcribe start</a><ul>
<li><a class="reference internal" href="#id66">Parameters</a></li>
<li><a class="reference internal" href="#id67">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transcribe-stop">Transcribe stop</a><ul>
<li><a class="reference internal" href="#id68">Parameters</a></li>
<li><a class="reference internal" href="#id69">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#variable-set">Variable Set</a><ul>
<li><a class="reference internal" href="#id70">Parameters</a></li>
<li><a class="reference internal" href="#id71">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#webhook-send">Webhook send</a><ul>
<li><a class="reference internal" href="#id72">Parameters</a></li>
<li><a class="reference internal" href="#id73">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial-basic">Tutorial basic</a><ul>
<li><a class="reference internal" href="#get-list-of-flows">Get list of flows</a></li>
<li><a class="reference internal" href="#get-detail-of-specified-flow">Get detail of specified flow</a></li>
<li><a class="reference internal" href="#create-a-flow">Create a flow</a></li>
<li><a class="reference internal" href="#update-the-flow">Update the flow</a></li>
<li><a class="reference internal" href="#delete-the-flow">Delete the flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial-scenario">Tutorial scenario</a><ul>
<li><a class="reference internal" href="#simple-voicemail">Simple voicemail</a></li>
<li><a class="reference internal" href="#simple-branch">Simple branch</a></li>
<li><a class="reference internal" href="#simple-message-send">Simple message send</a></li>
<li><a class="reference internal" href="#simple-message-send-and-make-a-new-outbound-call">Simple message send and make a new outbound call</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#activeflow">Activeflow</a><ul>
<li><a class="reference internal" href="#activeflow-overview">Overview</a><ul>
<li><a class="reference internal" href="#flow-vs-activeflow">Flow vs ActiveFlow</a></li>
<li><a class="reference internal" href="#activeflow-states">ActiveFlow States</a></li>
<li><a class="reference internal" href="#execution">Execution</a></li>
<li><a class="reference internal" href="#how-the-cursor-works">How the Cursor Works</a></li>
<li><a class="reference internal" href="#stack-based-execution">Stack-Based Execution</a></li>
<li><a class="reference internal" href="#reference-types">Reference Types</a></li>
<li><a class="reference internal" href="#status-and-control-interface">Status and Control interface</a></li>
<li><a class="reference internal" href="#activeflow-lifecycle">Activeflow Lifecycle</a></li>
<li><a class="reference internal" href="#variable-management">Variable Management</a></li>
<li><a class="reference internal" href="#executed-actions">Executed Actions</a></li>
<li><a class="reference internal" href="#on-complete-flow">On Complete Flow</a></li>
<li><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li><a class="reference internal" href="#common-use-cases">Common Use Cases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#activeflow-struct-activeflow">Activeflow</a><ul>
<li><a class="reference internal" href="#activeflow-struct-activeflow-activeflow">Activeflow</a><ul>
<li><a class="reference internal" href="#id77">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#reference-type">Reference type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li><a class="reference internal" href="#get-activeflow-list">Get activeflow list</a></li>
<li><a class="reference internal" href="#stop-activeflow">Stop activeflow</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">About Us</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="http://voipbin.net">Contact</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2024, Sungtae Kim
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a class="text-white" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.5.0
                    </a>
                    and
                    <a class="text-white" href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 9.1.0
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=fd6eb6e6"></script>
        <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script type="text/javascript" src="_static/dist/theme.js"></script>
        <script type="text/javascript" src="_static/dist/vendor.js"></script>
        <script type="text/javascript" src="_static/searchtools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>